$estr=function(){return js.Boot.__string_rec(this,"")};"undefined"==typeof pokerpg&&(pokerpg={});pokerpg.Particle=function(a){a!==$_&&(this.started=!1)};pokerpg.Particle.__name__=["pokerpg","Particle"];pokerpg.Particle.prototype.started=null;pokerpg.Particle.prototype.destroy=function(){};pokerpg.Particle.prototype.start=function(){this.started=!0};pokerpg.Particle.prototype.end=function(){this.started=!1};pokerpg.Particle.prototype.render=function(){};pokerpg.Particle.prototype.__class__=pokerpg.Particle;
pokerpg.Transition=function(a){a!==$_&&(this.step=0)};pokerpg.Transition.__name__=["pokerpg","Transition"];pokerpg.Transition.prototype.step=null;pokerpg.Transition.prototype.onComplete=null;pokerpg.Transition.prototype.render=function(){};pokerpg.Transition.prototype.complete=function(){pokerpg.Renderer.stopTransition();if(null!=this.onComplete)this.onComplete()};pokerpg.Transition.prototype.__class__=pokerpg.Transition;List=function(a){a!==$_&&(this.length=0)};List.__name__=["List"];
List.prototype.h=null;List.prototype.q=null;List.prototype.length=null;List.prototype.add=function(a){a=[a];null==this.h?this.h=a:this.q[1]=a;this.q=a;this.length++};List.prototype.push=function(a){this.h=a=[a,this.h];null==this.q&&(this.q=a);this.length++};List.prototype.first=function(){return null==this.h?null:this.h[0]};List.prototype.last=function(){return null==this.q?null:this.q[0]};
List.prototype.pop=function(){if(null==this.h)return null;var a=this.h[0];this.h=this.h[1];null==this.h&&(this.q=null);this.length--;return a};List.prototype.isEmpty=function(){return null==this.h};List.prototype.clear=function(){this.q=this.h=null;this.length=0};List.prototype.remove=function(a){for(var b=null,c=this.h;null!=c;){if(c[0]==a)return null==b?this.h=c[1]:b[1]=c[1],this.q==c&&(this.q=b),this.length--,!0;b=c;c=c[1]}return!1};
List.prototype.iterator=function(){return{h:this.h,hasNext:function(){return null!=this.h},next:function(){if(null==this.h)return null;var a=this.h[0];this.h=this.h[1];return a}}};List.prototype.toString=function(){var a=new StringBuf,b=!0,c=this.h;for(a.b[a.b.length]="{";null!=c;)b?b=!1:a.b[a.b.length]=", ",a.add(Std.string(c[0])),c=c[1];a.b[a.b.length]="}";return a.b.join("")};
List.prototype.join=function(a){for(var b=new StringBuf,c=!0,e=this.h;null!=e;)c?c=!1:b.b[b.b.length]=null==a?"null":a,b.add(e[0]),e=e[1];return b.b.join("")};List.prototype.filter=function(a){for(var b=new List,c=this.h;null!=c;){var e=c[0],c=c[1];a(e)&&b.add(e)}return b};List.prototype.map=function(a){for(var b=new List,c=this.h;null!=c;){var e=c[0],c=c[1];b.add(a(e))}return b};List.prototype.__class__=List;
pokerpg.GameObject=function(a,b,c){a!==$_&&(null==c&&(c=0),this.x=a,this.y=b,this.direction=c,this.renderPriority=0,this.randInt=Math.floor(1E5*Math.random()),this.isTemporary=!1,pokerpg.Game.curGame.gameObjects.push(this))};pokerpg.GameObject.__name__=["pokerpg","GameObject"];pokerpg.GameObject.prototype.x=null;pokerpg.GameObject.prototype.y=null;pokerpg.GameObject.prototype.direction=null;pokerpg.GameObject.prototype.randInt=null;pokerpg.GameObject.prototype.renderPriority=null;
pokerpg.GameObject.prototype.isTemporary=null;pokerpg.GameObject.prototype.destroy=function(){pokerpg.Game.curGame.gameObjects.remove(this)};pokerpg.GameObject.prototype.tick=function(){};pokerpg.GameObject.prototype.render=function(){};pokerpg.GameObject.prototype.__class__=pokerpg.GameObject;pokerpg.entities||(pokerpg.entities={});pokerpg.entities.CGrassAnimation=function(a,b){if(a!==$_){pokerpg.GameObject.call(this,a,b);this.createdTick=pokerpg.Renderer.numRTicks;this.isTemporary=true}};
pokerpg.entities.CGrassAnimation.__name__=["pokerpg","entities","CGrassAnimation"];pokerpg.entities.CGrassAnimation.__super__=pokerpg.GameObject;for(var k in pokerpg.GameObject.prototype)pokerpg.entities.CGrassAnimation.prototype[k]=pokerpg.GameObject.prototype[k];pokerpg.entities.CGrassAnimation.prototype.createdTick=null;pokerpg.entities.CGrassAnimation.prototype.tick=function(){pokerpg.Renderer.numRTicks-this.createdTick>=16&&this.destroy()};
pokerpg.entities.CGrassAnimation.prototype.render=function(a){if(pokerpg.Renderer.numRTicks-this.createdTick>=16)this.destroy();else{var b=pokerpg.Map.getCurMap();a.drawImage(pokerpg.Game.res.miscSprites.obj,32,32*Math.floor((pokerpg.Renderer.numRTicks-this.createdTick)/4),32,32,this.x*b.tilewidth+pokerpg.Renderer.getOffsetX(),this.y*b.tileheight+pokerpg.Renderer.getOffsetY(),32,32)}};pokerpg.entities.CGrassAnimation.prototype.__class__=pokerpg.entities.CGrassAnimation;
pokerpg.transitions||(pokerpg.transitions={});pokerpg.transitions.BattleTransition001=function(a){a!==$_&&pokerpg.Transition.call(this)};pokerpg.transitions.BattleTransition001.__name__=["pokerpg","transitions","BattleTransition001"];pokerpg.transitions.BattleTransition001.__super__=pokerpg.Transition;for(k in pokerpg.Transition.prototype)pokerpg.transitions.BattleTransition001.prototype[k]=pokerpg.Transition.prototype[k];
pokerpg.transitions.BattleTransition001.prototype.render=function(a){if(!(this.step<0)){a.fillStyle="#000000";var b=a.canvas,c=pokerpg.Main.tmpCtx,e=pokerpg.Game.curGame;if(this.step>=50){a.save();a.fillStyle="rgba(0, 0, 0, 0.45)";a.fillRect(0,0,pokerpg.Main.canvas.width,pokerpg.Main.canvas.height);a.restore();e.battle.render(a)}if(!(this.step<20))if(this.step<38){c=(this.step-20)*(this.step-20);a.fillRect(0,0,b.width,c);a.fillRect(0,b.height-c,b.width,c)}else if(this.step<50){a.fillRect(0,0,b.width,
b.height);e.drawPlayerChar=false;e.drawPlayerFollower=false;a=pokerpg.Game.curGame.getPlayerChar();if(a!=null){a.x=e.battle.x;a.y=e.battle.y}}else if(this.step<70){e=(this.step-50)/20;e>1&&(e=1);e=e*e;a.fillRect(0,b.height/2-40,b.width,80);c=(b.height/2-40)*(1-e);a.fillRect(0,b.height/2-40-c,b.width,c);a.fillRect(0,b.height/2+40,b.width,c);a.save();a.translate(b.width/2,b.height/2);a.rotate(Math.PI*2*e);a.scale(e,e);a.drawImage(pokerpg.Game.res.battleIntroPokeball.obj,-60,-60);a.restore()}else if(this.step<
100){e=(this.step-80)/20;pokerpg.Main.tmpCtx.clearRect(0,0,pokerpg.Main.tmpCanvas.width,pokerpg.Main.tmpCanvas.height);c.fillStyle="rgb(0, 0, 0)";c.fillRect(0,b.height/2-40,b.width,80);c.drawImage(pokerpg.Game.res.battleIntroPokeball.obj,b.width/2-60,b.height/2-60);a.globalAlpha=pokerpg.Util.clamp(1-e,0,1);a.drawImage(pokerpg.Main.tmpCanvas,0,0);a.globalAlpha=1}else{e.battle.step=pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP;this.complete()}++this.step}};
pokerpg.transitions.BattleTransition001.prototype.__class__=pokerpg.transitions.BattleTransition001;pokerpg.ui||(pokerpg.ui={});pokerpg.ui.UIInput=function(a,b){if(a!==$_){this.x=a;this.y=b;this.disabled=false}};pokerpg.ui.UIInput.__name__=["pokerpg","ui","UIInput"];pokerpg.ui.UIInput.prototype.x=null;pokerpg.ui.UIInput.prototype.y=null;pokerpg.ui.UIInput.prototype.selected=null;pokerpg.ui.UIInput.prototype.selectedTime=null;pokerpg.ui.UIInput.prototype.disabled=null;
pokerpg.ui.UIInput.prototype.select=function(){if(!this.selected){pokerpg.UI.selectedInput!=null&&pokerpg.UI.selectedInput.blur();pokerpg.UI.selectedInput=this;this.selected=true;this.selectedTime=Date.now().getTime()}};pokerpg.ui.UIInput.prototype.blur=function(){if(this.selected){this.selected=false;pokerpg.UI.selectedInput=null}};pokerpg.ui.UIInput.prototype.tick=function(){};pokerpg.ui.UIInput.prototype.render=function(){};pokerpg.ui.UIInput.prototype.isUnderMouse=function(){return false};
pokerpg.ui.UIInput.prototype.__class__=pokerpg.ui.UIInput;pokerpg.ui.UIButton=function(a,b,c,e){if(a!==$_){pokerpg.ui.UIInput.call(this,a,b);this.width=c;this.height=e;this.instantSubmit=this.keyWasDown=this.mouseWasDown=false}};pokerpg.ui.UIButton.__name__=["pokerpg","ui","UIButton"];pokerpg.ui.UIButton.__super__=pokerpg.ui.UIInput;for(k in pokerpg.ui.UIInput.prototype)pokerpg.ui.UIButton.prototype[k]=pokerpg.ui.UIInput.prototype[k];pokerpg.ui.UIButton.prototype.drawIdle=null;
pokerpg.ui.UIButton.prototype.drawHover=null;pokerpg.ui.UIButton.prototype.drawDown=null;pokerpg.ui.UIButton.prototype.drawDisabled=null;pokerpg.ui.UIButton.prototype.onSubmit=null;pokerpg.ui.UIButton.prototype.instantSubmit=null;pokerpg.ui.UIButton.prototype.width=null;pokerpg.ui.UIButton.prototype.height=null;pokerpg.ui.UIButton.prototype.mouseWasDown=null;pokerpg.ui.UIButton.prototype.keyWasDown=null;
pokerpg.ui.UIButton.prototype.tick=function(){if(!this.disabled&&this.isUnderMouse())pokerpg.Main.onScreenCanvas.style.cursor="pointer"};pokerpg.ui.UIButton.prototype.submit=function(){if(this.onSubmit!=null)this.onSubmit();this.keyWasDown=this.mouseWasDown=false};
pokerpg.ui.UIButton.prototype.render=function(a){if(this.disabled){this.keyWasDown=this.mouseWasDown=false;this.drawDisabled(a)}else{if(this.selected)if(pokerpg.UI.mouseDown&&this.isUnderMouse()||pokerpg.UI.keysDown[13]||pokerpg.UI.keysDown[32])this.drawDown(a);else{this.drawHover(a);if(this.mouseWasDown&&this.isUnderMouse()||this.keyWasDown){this.keyWasDown||this.blur();this.submit()}}else this.isUnderMouse()?this.drawHover(a):this.drawIdle(a);this.mouseWasDown=pokerpg.UI.mouseDown;this.keyWasDown=
!!pokerpg.UI.keysDown[13]||!!pokerpg.UI.keysDown[32]}};pokerpg.ui.UIButton.prototype.isUnderMouse=function(){return pokerpg.UI.mouseX>=this.x&&pokerpg.UI.mouseY>=this.y&&pokerpg.UI.mouseX<this.x+this.width&&pokerpg.UI.mouseY<this.y+this.height};pokerpg.ui.UIButton.prototype.__class__=pokerpg.ui.UIButton;
pokerpg.Map=function(a,b){if(a!==$_){this.id=a;this.tilesets=[];this.layers=[];this.width=b.width;this.height=b.height;this.tilesets=[];this.layers=[];this.tilewidth=b.tilewidth;this.tileheight=b.tileheight;this.properties=b.properties;for(var c=0,e=b.tilesets.length;c<e;){var f=c++;this.tilesets.push(new pokerpg.Tileset(b.tilesets[f]))}c=0;for(e=b.layers.length;c<e;){f=c++;f=new pokerpg.Layer(b.layers[f]);f.properties.data_layer=="1"?this.dataLayer=f:this.layers.push(f)}}};
pokerpg.Map.__name__=["pokerpg","Map"];pokerpg.Map.cur=null;pokerpg.Map.getCurMap=function(){return pokerpg.Game.curGame.map};pokerpg.Map.prototype.id=null;pokerpg.Map.prototype.game=null;pokerpg.Map.prototype.properties=null;pokerpg.Map.prototype.tilesets=null;pokerpg.Map.prototype.layers=null;pokerpg.Map.prototype.dataLayer=null;pokerpg.Map.prototype.width=null;pokerpg.Map.prototype.height=null;pokerpg.Map.prototype.tilewidth=null;pokerpg.Map.prototype.tileheight=null;
pokerpg.Map.prototype.cacheMap=null;pokerpg.Map.prototype.cacheOffsetX=null;pokerpg.Map.prototype.cacheOffsetY=null;
pokerpg.Map.prototype.render=function(a){if(this.cacheMap!=this||this.cacheOffsetX!=pokerpg.Renderer.getOffsetX()||this.cacheOffsetY!=pokerpg.Renderer.getOffsetY()){pokerpg.Main.mapCacheCtx.fillStyle="#000000";pokerpg.Main.mapCacheCtx.fillRect(0,0,pokerpg.Main.mapCacheCanvas.width,pokerpg.Main.mapCacheCanvas.height);for(var b=0,c=this.layers;b<c.length;){var e=c[b];++b;e.properties.overchars!="1"&&e.properties.animated!="1"&&e.render(pokerpg.Main.mapCacheCtx,this)}a.drawImage(pokerpg.Main.mapCacheCanvas,
0,0);this.cacheMap=this;this.cacheOffsetX=pokerpg.Renderer.getOffsetX();this.cacheOffsetY=pokerpg.Renderer.getOffsetY()}else a.drawImage(pokerpg.Main.mapCacheCanvas,0,0)};pokerpg.Map.prototype.renderAnimated=function(a){for(var b=0,c=this.layers;b<c.length;){var e=c[b];++b;e.properties.animated=="1"&&e.render(a,this)}};pokerpg.Map.prototype.renderOver=function(a){for(var b=0,c=this.layers;b<c.length;){var e=c[b];++b;e.properties.overchars=="1"&&e.render(a,this)}};
pokerpg.Map.prototype.isTileSolid=function(a,b){return this.hasTileProp(a,b,"solid")};pokerpg.Map.prototype.isTileWater=function(a,b){return this.hasTileProp(a,b,"water")};pokerpg.Map.prototype.isTileGrass=function(a,b){return this.hasTileProp(a,b,"grass")};pokerpg.Map.prototype.isTileLedge=function(a,b){return this.hasTileProp(a,b,"ledge")};
pokerpg.Map.prototype.getLedgeDir=function(a,b){var c=this.dataLayer,c=c.data[b*c.width+a];if(c==null||c==0)return-1;var e=pokerpg.Tileset.getTilesetOfTile(this,c);if(e==null)throw"Tileset is null";return e.tileproperties[c-e.firstgid].ledge=="1"?Number(e.tileproperties[c-e.firstgid].ledge_dir)||0:-1};
pokerpg.Map.prototype.hasTileProp=function(a,b,c){var e=this.dataLayer,a=e.data[b*e.width+a];if(a==null||a==0)return false;b=pokerpg.Tileset.getTilesetOfTile(this,a);if(b==null)throw"Tileset is null";return b.tileproperties[a-b.firstgid][c]=="1"};pokerpg.Map.prototype.__class__=pokerpg.Map;
pokerpg.Battle=function(a){if(a!==$_){this.type=a.type;this.x=a.x;this.y=a.y;this.myId=a.id;this.myTeam=a.team;this.battleFinished=false;this.players=a.info.players;switch(this.type){case 0:this.setCurPokemon(a.info.players[this.myId].pokemon);this.enemyPokemon=a.info.players[this.myId==0?1:0].pokemon;break;case 2:this.setCurPokemon(a.info.players[this.myId].pokemon);this.enemyPokemon=a.info.players[this.myId==0?1:0].pokemon;this.enemyUsername=a.info.players[this.myId==0?1:0].username;break;default:throw"Invalid battle type";
}this.background=pokerpg.Game.curGame.getImage("resources/ui/battle_background.png");a="";this.enemyPokemon.id.length==1?a="00":this.enemyPokemon.id.length==2&&(a="0");this.enemyPokemon.sprite=pokerpg.Game.curGame.getImage("resources/pokemon/front/"+a+this.enemyPokemon.id+(this.enemyPokemon.shiny?"s":"")+".png");this.randInt=Math.floor(Math.random()*1E5);this.step=pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION;this.text="";this.selectedAction=0;this.canRenderPlayerPokemon=this.canRenderEnemy=true;this.shakePokemonStatus=
this.shakeEnemyStatus=this.runningQueue=this.pokemonFainted=this.enemyFainted=false;this.resultQueue=[];pokerpg.UI.dirButtonHooks.push($closure(this,"buttonHandler"))}};pokerpg.Battle.__name__=["pokerpg","Battle"];pokerpg.Battle.prototype.step=null;pokerpg.Battle.prototype.type=null;pokerpg.Battle.prototype.myId=null;pokerpg.Battle.prototype.myTeam=null;pokerpg.Battle.prototype.x=null;pokerpg.Battle.prototype.y=null;pokerpg.Battle.prototype.curPokemon=null;pokerpg.Battle.prototype.enemyPokemon=null;
pokerpg.Battle.prototype.enemyUsername=null;pokerpg.Battle.prototype.background=null;pokerpg.Battle.prototype.now=null;pokerpg.Battle.prototype.selectedAction=null;pokerpg.Battle.prototype.selectedMove=null;pokerpg.Battle.prototype.text=null;pokerpg.Battle.prototype.textTime=null;pokerpg.Battle.prototype.textCompleted=null;pokerpg.Battle.prototype.textCompletedTime=null;pokerpg.Battle.prototype.textDelay=null;pokerpg.Battle.prototype.textOnComplete=null;pokerpg.Battle.prototype.textOnYes=null;
pokerpg.Battle.prototype.textOnNo=null;pokerpg.Battle.prototype.textQuestion=null;pokerpg.Battle.prototype.textQuestionSelectedAnswer=null;pokerpg.Battle.prototype.animStep=null;pokerpg.Battle.prototype.canRenderEnemy=null;pokerpg.Battle.prototype.canRenderPlayerPokemon=null;pokerpg.Battle.prototype.enemyFainted=null;pokerpg.Battle.prototype.enemyFaintedTick=null;pokerpg.Battle.prototype.pokemonFainted=null;pokerpg.Battle.prototype.pokemonFaintedTick=null;
pokerpg.Battle.prototype.shakeEnemyStatus=null;pokerpg.Battle.prototype.shakePokemonStatus=null;pokerpg.Battle.prototype.resultQueue=null;pokerpg.Battle.prototype.curAction=null;pokerpg.Battle.prototype.moveStartTime=null;pokerpg.Battle.prototype.curMove=null;pokerpg.Battle.prototype.randInt=null;pokerpg.Battle.prototype.battleFinished=null;pokerpg.Battle.prototype.learningMove=null;pokerpg.Battle.prototype.forgetMoveSelected=null;pokerpg.Battle.prototype.runningQueue=null;
pokerpg.Battle.prototype.players=null;pokerpg.Battle.prototype.setCurPokemon=function(a){var b="";a.id.length==1?b="00":a.id.length==2&&(b="0");a.backsprite=pokerpg.Game.curGame.getImage("resources/pokemon/back/"+b+a.id+(a.shiny?"s":"")+"b.png");a.iconBig=pokerpg.Game.curGame.getImage("resources/picons/"+a.id+"_1_x2.png");this.curPokemon=a};
pokerpg.Battle.prototype.render=function(a){var b=this;this.now=Date.now().getTime();a.save();a.translate(pokerpg.Main.isPhone?0:160,pokerpg.Main.isPhone?0:140);if(this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_LEARN_MOVE)this.renderLearnMove(a);else{this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_TURN&&this.curMove!=null&&this.curMove.render(a,this);if(this.background.obj.width!=0){a.drawImage(this.background.obj,-80,-50);this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU?a.drawImage(pokerpg.Game.res.bottomBattleHUD.obj,
-80,238):a.drawImage(pokerpg.Game.res.bottomBattleHUDText.obj,-80,238)}a.lineWidth=2;a.strokeStyle="rgb(0,0,0)";a.strokeRect(-80,-50,640,384);this.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU&&this.drawBottomPanel(a);this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU&&this.drawFightMenu(a);this.canRenderEnemy&&this.renderEnemy(a);if(this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION||this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP||this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED){if(pokerpg.Game.res.playerBacksprite.obj!=
null){a.save();a.translate(0,16);a.drawImage(pokerpg.Game.res.playerBacksprite.obj,0,0,128,128,60,96,128,128);a.restore()}}else this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON?this.drawGoPokemonAnimation(a):this.canRenderPlayerPokemon&&this.drawPlayerPokemon(a);this.drawEnemyStatus(a);this.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION&&this.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP&&this.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED&&this.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON&&
this.drawPokemonStatus(a);if(this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP){this.step=pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED;this.type==2?this.setBattleText("Battle with "+this.enemyUsername+" has begun!",-1,function(){b.setBattleText("Go! "+pokerpg.Util.getPokemonDisplayName(b.curPokemon)+"!");b.step=pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON;b.animStep=0;b.selectedMove=0}):this.setBattleText(pokerpg.Util.getPokemonDisplayName(this.enemyPokemon)+" appeared!",-1,function(){b.setBattleText("Go! "+
pokerpg.Util.getPokemonDisplayName(b.curPokemon)+"!");b.step=pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON;b.animStep=0;b.selectedMove=0})}if(this.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU&&this.text!=""&&this.textCompleted&&this.textQuestion){a.drawImage(pokerpg.Game.res.battleYesNo.obj,370,130);this.textQuestionSelectedAnswer?a.drawImage(pokerpg.Game.res.battleMisc.obj,96,0,32,32,376+Math.floor(this.now%1E3/500)*2,148,32,32):a.drawImage(pokerpg.Game.res.battleMisc.obj,96,0,32,32,376+Math.floor(this.now%
1E3/500)*2,178,32,32)}}a.restore()};
pokerpg.Battle.prototype.renderLearnMove=function(a){a.drawImage(pokerpg.Game.res.battleLearnMove.obj,0,0);a.drawImage(this.curPokemon.iconBig.obj,16,32);a.drawImage(pokerpg.Game.res.types.obj,0,24*pokerpg.PokemonConst.typeNameToInt(pokerpg.Game.pokemonData[this.curPokemon.id].type1),64,24,96,70,64,24);pokerpg.Game.pokemonData[this.curPokemon.id].type2!=null&&a.drawImage(pokerpg.Game.res.types.obj,0,24*pokerpg.PokemonConst.typeNameToInt(pokerpg.Game.pokemonData[this.curPokemon.id].type2),64,24,164,
70,64,24);a.font="24px Font2";pokerpg.Renderer.drawShadowText2(a,pokerpg.Util.getPokemonDisplayName(this.curPokemon),80,56,"rgb(248,248,248)","rgb(96,96,96)");a.save();for(var b=0;b<5;){var c=b++,e=c<4?this.curPokemon.moves[c]:this.learningMove,f=c<4?this.curPokemon.movesPP[c]:pokerpg.Game.movesData[this.learningMove.toLowerCase()].maxPP,g=c<4?this.curPokemon.movesMaxPP[c]:f,c=pokerpg.Game.movesData[(c<4?this.curPokemon.moves[c]:this.learningMove).toLowerCase()].type;a.drawImage(pokerpg.Game.res.types.obj,
0,24*pokerpg.PokemonConst.typeNameToInt(c),64,24,246,42,64,24);pokerpg.Renderer.drawShadowText2(a,e.toUpperCase(),326,64,"rgb(32,32,32)","rgb(216,216,216)");pokerpg.Renderer.drawShadowText2(a,Std.string(f),412+(f<10?8:0),86,"rgb(32,32,32)","rgb(216,216,216)");pokerpg.Renderer.drawShadowText2(a,Std.string(g),448,86,"rgb(32,32,32)","rgb(216,216,216)");a.translate(0,56)}a.restore();a.drawImage(pokerpg.Game.res.battleLearnMoveSelection.obj,240,36+56*this.forgetMoveSelected)};
pokerpg.Battle.prototype.drawBottomPanel=function(a){var b=this;a.save();a.translate(-80,15);if(this.text!=""){var c=this.text.substr(0,Math.floor((this.now-this.textTime)/30));a.font="24px Font2";var e=this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU?150:420,f=c,g=null;if(a.measureText(c).width>e){f=c;g="";do{f=f.split(" ");g=f.pop()+" "+g;f=f.join(" ")}while(a.measureText(f).width>e);a.fillStyle="rgb(0,0,0)";a.fillText(f,26,266);a.fillText(g,26,294);a.fillText(f,24,268);a.fillText(g,24,296);
a.fillText(f,26,268);a.fillText(g,26,296);a.fillStyle="rgb(255,255,255)";a.fillText(f,24,266);a.fillText(g,24,294);f=g}else{a.fillStyle="rgb(0,0,0)";a.fillText(c,24,268);a.fillText(c,26,266);a.fillText(c,26,268);a.fillStyle="rgb(255,255,255)";a.fillText(c,24,266)}if(c==this.text)if(this.textCompleted){if(!this.textQuestion&&this.textDelay==-1&&this.now-this.textCompletedTime>100){c=Math.floor(this.now%1E3/250);c==3&&(c=1);c=c*2;a.drawImage(pokerpg.Game.res.battleMisc.obj,0,0,32,32,24+a.measureText(f).width,
240+c+(g!=null?28:0),32,32)}}else{this.textCompleted=true;this.textCompletedTime=this.now;if(this.textQuestion){this.textQuestionSelectedAnswer=true;pokerpg.UI.AButtonHooks.push(function(){pokerpg.UI.AButtonHooks=[];pokerpg.UI.BButtonHooks=[];b.textQuestionSelectedAnswer?b.textOnYes():b.textOnNo()});pokerpg.UI.BButtonHooks.push(function(){pokerpg.UI.AButtonHooks=[];pokerpg.UI.BButtonHooks=[];b.textOnNo()})}else this.textDelay==0?this.textOnComplete!=null&&this.textOnComplete():this.textDelay!=-1?
this.textOnComplete!=null&&setTimeout(function(){b.textOnComplete()},this.textDelay):pokerpg.UI.AButtonHooks.push(function(){setTimeout(b.textOnComplete,100)})}}a.restore();a.font="24px Font2";if(this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU){pokerpg.Util.drawRoundedRect(252,237,200,75,0,"#FFFFFF",0.25);a.fillStyle="#000000";a.fillText("FIGHT",280,268);a.fillText("FIGHT",278,270);a.fillText("FIGHT",280,270);a.fillStyle="#FFFFFF";a.fillText("FIGHT",278,268);a.fillStyle="#000000";a.fillText("POK\u00c9MON",
280,300);a.fillText("POK\u00c9MON",278,302);a.fillText("POK\u00c9MON",280,302);a.fillStyle="#FFFFFF";a.fillText("POK\u00c9MON",278,300);a.fillStyle="#000000";a.fillText("BAG",392,268);a.fillText("BAG",390,270);a.fillText("BAG",392,270);a.fillStyle="#FFFFFF";a.fillText("BAG",390,268);a.fillStyle="#000000";a.fillText("RUN",392,300);a.fillText("RUN",390,302);a.fillText("RUN",392,302);a.fillStyle="#FFFFFF";a.fillText("RUN",390,300);g=252+Math.floor(this.now%1E3/500)*2;c=g+112;switch(this.selectedAction){case 0:a.drawImage(pokerpg.Game.res.battleMisc.obj,
96,0,32,32,g,246,32,32);break;case 1:a.drawImage(pokerpg.Game.res.battleMisc.obj,96,0,32,32,c,246,32,32);break;case 2:a.drawImage(pokerpg.Game.res.battleMisc.obj,96,0,32,32,g,276,32,32);break;case 3:a.drawImage(pokerpg.Game.res.battleMisc.obj,96,0,32,32,c,276,32,32)}}};
pokerpg.Battle.prototype.drawFightMenu=function(a){a.drawImage(pokerpg.Game.res.battleMoveMenu.obj,2,228);for(var b=0;b<4;){var c=b++,e=0,f=0;switch(c){case 0:e=40;f=268;break;case 1:e=180;f=268;break;case 2:e=40;f=300;break;case 3:e=180;f=300}var g=this.curPokemon.moves[c]==null?"--":this.curPokemon.moves[c].toUpperCase();a.font="16px Font4";a.fillStyle="rgb(208,208,208)";a.fillText(g,e,f+2);a.fillText(g,e+2,f);a.fillText(g,e+2,f+2);a.fillStyle="rgb(72,72,72)";a.fillText(g,e,f);this.selectedMove==
c&&a.drawImage(pokerpg.Game.res.battleMisc.obj,96,0,32,32,e-28+Math.floor(this.now%1E3/500)*2,f-22,32,32)}a.drawImage(pokerpg.Game.res.types.obj,0,24*pokerpg.PokemonConst.typeNameToInt(pokerpg.Game.movesData[this.curPokemon.moves[this.selectedMove].toLowerCase()].type),64,24,390,284,64,24);pokerpg.Renderer.drawShadowText2(a,Std.string(this.curPokemon.movesPP[this.selectedMove]),410,270,"rgb(64,64,64)","rgb(216,208,176)");pokerpg.Renderer.drawShadowText2(a,Std.string(this.curPokemon.movesMaxPP[this.selectedMove]),
440,270,"rgb(64,64,64)","rgb(216,208,176)")};pokerpg.Battle.prototype.renderEnemy=function(a){if(this.enemyFainted){if(pokerpg.Renderer.numRTicks-this.enemyFaintedTick<=5){a.save();a.beginPath();a.moveTo(360,30);a.lineTo(498,30);a.lineTo(498,158);a.lineTo(360,158);a.lineTo(360,30);a.clip();a.drawImage(this.enemyPokemon.sprite.obj,360,30+(pokerpg.Renderer.numRTicks-this.enemyFaintedTick)*30);a.restore()}}else a.drawImage(this.enemyPokemon.sprite.obj,360,30)};
pokerpg.Battle.prototype.drawGoPokemonAnimation=function(a){if(this.animStep>=4&&this.animStep<25){var b=[[60,179,1,0],[62,175,1,0],[70,168,1,0],[75,165,1,0],[83,160,1,0],[86,160,1,0],[95,161,1,0],[97,164,1,0],[105,170,1,0],[110,175,1,0],[111,178,1,0],[113,183,1,0],[114,185,1,0],[115,190,1,0],[117,192,1,0],[120,195,1,0,0.95],[123,200,1,1,0.9],[124,205,1.05,1,0.8],[125,200,1.1,1,0.6],[126,192,1.15,1,0.3],[127,192,1.2,1,0.1]];a.save();a.translate(0,16);a.globalAlpha=b[this.animStep-4][4];a.translate(b[this.animStep-
4][0],b[this.animStep-4][1]);a.scale(b[this.animStep-4][2],b[this.animStep-4][2]);a.rotate(this.animStep/17*Math.PI*2);a.drawImage(pokerpg.Game.res.battlePokeballs.obj,64,32*b[this.animStep-4][3],32,32,-16,-16,32,32);a.restore()}if(Math.floor(this.animStep/4)<5){a.save();a.translate(0,16);a.beginPath();a.moveTo(0,0);a.lineTo(480,0);a.lineTo(480,320);a.lineTo(0,320);a.lineTo(0,0);a.clip();a.globalAlpha=pokerpg.Util.clamp(1-this.animStep/20,0,1);a.drawImage(pokerpg.Game.res.playerBacksprite.obj,128*
Math.floor(this.animStep/4),0,128,128,60-this.animStep*5,96,128,128);a.restore()}if(this.animStep>21&&this.animStep<35){b=Math.min((this.animStep-21)/10,1);pokerpg.Main.tmpCtx.clearRect(0,0,pokerpg.Main.tmpCanvas.width,pokerpg.Main.tmpCanvas.height);var c=pokerpg.Main.tmpCtx;c.save();c.fillStyle="#FFFFFF";c.fillRect(0,0,pokerpg.Main.tmpCanvas.width,pokerpg.Main.tmpCanvas.height);c.globalCompositeOperation="destination-atop";c.translate(124,192);c.scale(b,b);c.drawImage(this.curPokemon.backsprite.obj,
-64,-96);c.restore();a.save();a.translate(0,16);a.translate(124,192);a.scale(b,b);a.drawImage(this.curPokemon.backsprite.obj,-64,-96);a.restore();a.globalAlpha=pokerpg.Util.clamp(1-Math.max(0,b*b-0.5)*2,0,1);a.drawImage(pokerpg.Main.tmpCanvas,0,0);a.globalAlpha=1}else if(this.animStep>=35){this.selectedAction=0;this.openActionMenu()}++this.animStep};
pokerpg.Battle.prototype.drawPlayerPokemon=function(a){a.save();a.translate(0,16);a.beginPath();a.moveTo(60,96);a.lineTo(188,96);a.lineTo(188,224);a.lineTo(60,224);a.lineTo(60,96);a.clip();this.pokemonFainted?pokerpg.Renderer.numRTicks-this.pokemonFaintedTick<=5&&a.drawImage(this.curPokemon.backsprite.obj,60,96+(pokerpg.Renderer.numRTicks-this.pokemonFaintedTick)*30):a.drawImage(this.curPokemon.backsprite.obj,60,96+((this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU||this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU)&&
(this.now+this.randInt)%600<300?2:0));a.restore()};
pokerpg.Battle.prototype.drawEnemyStatus=function(a){a.save();a.translate(-50,-20);this.shakeEnemyStatus&&pokerpg.Renderer.numRTicks%2==0&&a.translate(0,2);a.drawImage(pokerpg.Game.res.battleEnemyBar.obj,0,0);a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,0,1,4,78,27,96,6);var b=this.enemyPokemon.hp/this.enemyPokemon.maxHp;b>0.5?a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,6,1,4,78,27,Math.floor(48*b)*2,6):b>=0.2?a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,12,1,4,78,27,Math.floor(48*
b)*2,6):a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,18,1,4,78,27,Math.ceil(48*b)*2,6);var b=pokerpg.Util.getPokemonStatusBarName(this.enemyPokemon),c=Std.string(this.enemyPokemon.level),e=145-(this.enemyPokemon.level<10?0:this.enemyPokemon.level<100?5:12);a.font="12px Font4";a.fillStyle="rgb(33,33,33)";a.fillText("Lv",e+2,18);a.fillText("Lv",e,20);a.fillText("Lv",e+2,20);a.fillStyle="rgb(255,173,0)";a.fillText("Lv",e,18);a.font="16px Font4";pokerpg.Renderer.drawShadowText2(a,c,e+16,18,"rgb(255,255,255)",
"rgb(0,0,0)");a.fillStyle="rgb(0,0,0)";a.fillText(b,17,18);a.fillText(b,15,20);a.fillText(b,17,20);a.fillStyle="rgb(255,255,255)";a.fillText(b,15,18);b=a.measureText(b).width+18;this.enemyPokemon.gender==1?a.drawImage(pokerpg.Game.res.battleMisc.obj,64,0,10,16,b,4,10,16):this.enemyPokemon.gender==2&&a.drawImage(pokerpg.Game.res.battleMisc.obj,74,0,10,16,b,4,10,16);a.restore()};
pokerpg.Battle.prototype.drawPokemonStatus=function(a){a.save();if(this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU||this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU)a.translate(0,this.now%600<300?0:2);a.translate(50,20);this.shakePokemonStatus&&pokerpg.Renderer.numRTicks%2==0&&a.translate(0,2);a.drawImage(pokerpg.Game.res.battlePokemonBar.obj,252,148);a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,0,1,4,364,177,96,6);var b=this.curPokemon.hp/this.curPokemon.maxHp;b>0.5?a.drawImage(pokerpg.Game.res.battleHealthBar.obj,
0,6,1,4,364,177,Math.floor(48*b)*2,6):b>=0.2?a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,12,1,4,364,177,Math.floor(48*b)*2,6):a.drawImage(pokerpg.Game.res.battleHealthBar.obj,0,18,1,4,364,177,Math.ceil(48*b)*2,6);a.fillStyle="rgb(64,200,248)";a.fillRect(316,206,Math.floor(this.curPokemon.experience/this.curPokemon.experienceNeeded*82)*2,2);var b=pokerpg.Util.getPokemonStatusBarName(this.curPokemon),c=Std.string(this.curPokemon.level),e=460-(this.curPokemon.level<10?0:this.curPokemon.level<
100?8:16),f=422-(this.curPokemon.maxHp>=100?8:0),g=397-(this.curPokemon.hp>=100?16:0);a.font="12px Font4";a.fillStyle="rgb(33,33,33)";a.fillText("Lv",e+2,168);a.fillText("Lv",e,170);a.fillText("Lv",e+2,170);a.fillStyle="rgb(255,173,0)";a.fillText("Lv",e,168);a.font="16px Font4";a.fillStyle="rgb(0,0,0)";a.fillText(b,322,168);a.fillText(b,320,170);a.fillText(b,322,170);a.fillStyle="rgb(255,255,255)";a.fillText(b,320,168);pokerpg.Renderer.drawShadowText2(a,c,e+16,168,"rgb(255,255,255)","rgb(0,0,0)");
pokerpg.Renderer.drawShadowText2(a,"/"+Std.string(this.curPokemon.maxHp),f,200,"rgb(255,255,255)","rgb(0,0,0)");pokerpg.Renderer.drawShadowText2(a,Std.string(this.curPokemon.hp),g,200,"rgb(255,255,255)","rgb(0,0,0)");b=a.measureText(b).width+322;this.curPokemon.gender==1?a.drawImage(pokerpg.Game.res.battleMisc.obj,64,0,10,16,b,154,10,16):this.curPokemon.gender==2&&a.drawImage(pokerpg.Game.res.battleMisc.obj,74,0,10,16,b,154,10,16);a.restore()};
pokerpg.Battle.prototype.openActionMenu=function(){var a=this;this.runningQueue=false;this.step=pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU;this.setBattleText("What will "+pokerpg.Util.getPokemonDisplayName(this.curPokemon)+" do?");pokerpg.UI.AButtonHooks.push(function(){switch(a.selectedAction){case 0:a.openFightMenu();break;case 3:a.setBattleText(null);a.step=pokerpg.BATTLE_STEP.BATTLE_STEP_TURN;pokerpg.Connection.socket.emit("battleAction",{type:"run"});break;default:a.openActionMenu()}})};
pokerpg.Battle.prototype.openFightMenu=function(){var a=this;this.step=pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU;var b,c=null;b=function(){pokerpg.UI.BButtonHooks.remove(c);a.setBattleText(null);a.step=pokerpg.BATTLE_STEP.BATTLE_STEP_TURN;pokerpg.Connection.socket.emit("battleAction",{type:"move",move:a.selectedMove});a.type==2&&a.setBattleText("Waiting for other players....")};c=function(){pokerpg.UI.AButtonHooks.remove(b);a.openActionMenu();a.textTime=0};pokerpg.UI.AButtonHooks.push(b);pokerpg.UI.BButtonHooks.push(c)};
pokerpg.Battle.prototype.setBattleText=function(a,b,c){this.textQuestion=false;this.text=a==null?"":a;this.textTime=this.now;if(b==null)b=Math.NaN;this.textDelay=b;this.textOnComplete=c;this.textCompleted=false};pokerpg.Battle.prototype.setBattleTextQuestion=function(a,b,c){this.setBattleText(a);this.textQuestion=true;this.textOnYes=b;this.textOnNo=c};
pokerpg.Battle.prototype.runQueue=function(a){a==null&&(a=false);var b=this;if(a||!this.runningQueue){this.runningQueue=true;if(this.resultQueue.length==0)this.openActionMenu();else{var c=this.resultQueue.shift();this.curAction=c;var a=c.player!=null?this.players[c.player].pokemon:null,e=c.player!=null?this.players[c.player==0?1:0].pokemon:null;switch(c.type){case "moveAttack":this.setBattleText(pokerpg.Util.getPokemonDisplayName(a)+" used "+c.value.move.toUpperCase()+"!");setTimeout(function(){b.moveStartTime=
Date.now().getTime();b.playMove(c.value.move)},1E3);break;case "moveMiss":this.setBattleText(pokerpg.Util.getPokemonDisplayName(a)+" used "+c.value.toUpperCase()+"!");setTimeout(function(){b.setBattleText("But it missed!");setTimeout(function(){b.runQueue(true)},1E3)},1E3);break;case "moveDebuff":this.setBattleText(pokerpg.Util.getPokemonDisplayName(a)+" used "+c.value.move.toUpperCase()+"!");setTimeout(function(){b.moveStartTime=Date.now().getTime();b.moveFinished()},1E3);break;case "debuff":this.runQueue(true);
break;case "applyStatus":e.status=c.value;this.setBattleText(pokerpg.PokemonConst.getStatusApplyPhrase(c.value,pokerpg.Util.or(e.nickname,pokerpg.Game.pokemonData[e.id].name).toUpperCase()),-1,function(){setTimeout(function(){b.runQueue(true)},1E3)});break;case "pokemonDefeated":var f;if((c.player<Math.floor(this.players.length/2)?0:1)!=this.myTeam){f=this.curPokemon;a=this.enemyPokemon;this.enemyFainted=true;this.enemyFaintedTick=pokerpg.Renderer.numRTicks}else{f=this.enemyPokemon;a=this.curPokemon;
this.pokemonFainted=true;this.pokemonFaintedTick=pokerpg.Renderer.numRTicks}this.setBattleText(pokerpg.Util.getPokemonDisplayName(a)+" fainted!",-1,function(){(c.player<Math.floor(b.players.length/2)?0:1)!=b.myTeam&&c.value>0?b.setBattleText(pokerpg.Util.getPokemonDisplayName(f)+" gained "+c.value+" EXP. Points!",-1,function(){b.animateExp()}):b.runQueue(true)});break;case "win":this.finish();break;case "flee":this.setBattleText("Got away safely!",-1,function(){b.battleFinished=true;b.finish()});
break;case "fleeFail":this.setBattleText(c.player==this.myId?"Your attempt to run failed!":this.enemyUsername+" attempt to run failed!",-1,function(){b.runQueue(true)});break;case "switchFainted":if(c.player!=this.myId){this.setBattleText("The opponent is selecting another pokemon");this.runningQueue=false;break}break;case "pokemonLevelup":this.runQueue(true);break;case "pokemonLearnedMove":if(c.player!=this.myId)break;this.learnedMoves(c,function(){b.runQueue(true)});break;case "pokemonLearnMoves":if(c.player!=
this.myId)break;var g=c.value,h=null,j=-1,h=function(){++j;j>=g.length?b.runQueue(true):b.learnMoveOver(g[j],h)};h();break;default:pokerpg.Main.log("Unknown battle action: "+c.type)}}}};pokerpg.Battle.prototype.getPlayerTeam=function(a){return a<Math.floor(this.players.length/2)?0:1};
pokerpg.Battle.prototype.learnedMoves=function(a,b){var c=this,e=a.value,f=0,g=null,g=function(){f>=e.length?b():c.setBattleText(pokerpg.Util.getPokemonDisplayName(c.curPokemon)+" learned "+e[f++].toUpperCase()+"!",-1,g)};g()};
pokerpg.Battle.prototype.learnMoveOver=function(a,b){var c=this;this.learningMove=a;var e=null,f=null,g=null,h=pokerpg.Main.ctx;this.setBattleText(pokerpg.Util.getPokemonDisplayName(this.curPokemon)+" is trying to learn "+a.toUpperCase()+".",-1,function(){c.setBattleText("But, "+pokerpg.Util.getPokemonDisplayName(c.curPokemon)+" can't learn more than four moves.",-1,function(){c.setBattleTextQuestion("Delete a move to make room for "+a.toUpperCase()+"?",function(){var a=null,b=0,a=function(){h.save();
h.translate(pokerpg.Main.isPhone?0:160,pokerpg.Main.isPhone?0:140);if(b<10){h.globalAlpha=b/10;h.fillStyle="#000000";h.fillRect(0,0,480,320)}else if(b<15){if(b==10){c.forgetMoveSelected=0;e=c.step;c.step=pokerpg.BATTLE_STEP.BATTLE_STEP_LEARN_MOVE}h.fillStyle="#000000";h.fillRect(0,0,480,320)}else if(b<25){h.globalAlpha=1-(b-15)/10;h.fillStyle="#000000";h.fillRect(0,0,480,320)}else{pokerpg.Renderer.unHookRender(a);pokerpg.UI.AButtonHooks.push(f);pokerpg.UI.BButtonHooks.push(g)}h.restore();++b};pokerpg.Renderer.hookRender(a)},
function(){b()})})});f=function(){pokerpg.UI.BButtonHooks=[];var f=c.curPokemon.moves[c.forgetMoveSelected];pokerpg.Connection.socket.emit("battleLearnMove",{slot:c.forgetMoveSelected,move:a});var g=null,l=0,g=function(){h.save();h.translate(pokerpg.Main.isPhone?0:160,pokerpg.Main.isPhone?0:140);if(l<10){h.globalAlpha=l/10;h.fillStyle="#000000";h.fillRect(0,0,480,320)}else if(l<15){if(l==10){c.curPokemon.moves[c.forgetMoveSelected]=c.learningMove;c.step=e;c.setBattleText("1, 2, and... ... ... Poof!",
-1,function(){c.setBattleText(pokerpg.Util.getPokemonDisplayName(c.curPokemon)+" forgot "+f.toUpperCase()+".",-1,function(){c.setBattleText("And...",-1,function(){c.setBattleText(pokerpg.Util.getPokemonDisplayName(c.curPokemon)+" learned "+a.toUpperCase()+"!",-1,function(){b()})})})})}h.fillStyle="#000000";h.fillRect(0,0,480,320)}else if(l<25){h.globalAlpha=1-(l-15)/10;h.fillStyle="#000000";h.fillRect(0,0,480,320)}else pokerpg.Renderer.unHookRender(g);h.restore();++l};pokerpg.Renderer.hookRender(g)};
g=function(){pokerpg.UI.BButtonHooks=[];var a=null,f=0,a=function(){h.save();h.translate(pokerpg.Main.isPhone?0:160,pokerpg.Main.isPhone?0:140);if(f<10){h.globalAlpha=f/10;h.fillStyle="#000000";h.fillRect(0,0,480,320)}else if(f<15){if(f==10){c.step=e;c.setBattleTextQuestion("Are you sure you want "+pokerpg.Util.getPokemonDisplayName(c.curPokemon)+" to stop learning "+c.learningMove.toUpperCase()+"?",function(){c.setBattleText(null);b()},function(){c.learnMoveOver(c.learningMove,b)})}h.fillStyle="#000000";
h.fillRect(0,0,480,320)}else if(f<25){h.globalAlpha=1-(f-15)/10;h.fillStyle="#000000";h.fillRect(0,0,480,320)}else pokerpg.Renderer.unHookRender(a);h.restore();++f};pokerpg.Renderer.hookRender(a)}};
pokerpg.Battle.prototype.animateHp=function(){var a=this,b=this.curAction,c=null,c=function(){var e=b.value.resultHp,f;f=b.player!=a.myId?a.curPokemon:a.enemyPokemon;var g=Math.ceil(f.maxHp/50);if(f.hp>e){f.hp=f.hp-g;if(f.hp<e)f.hp=e}else if(f.hp<e){f.hp=f.hp+g;if(f.hp>e)f.hp=e}if(f.hp==e){pokerpg.Renderer.unHookRender(c);b.value.effec==0?a.setBattleText("It doesn't affect "+pokerpg.Util.or(f.nickname,pokerpg.Game.pokemonData[f.id].name).toUpperCase(),-1,function(){a.runQueue(true)}):b.value.effec<
1?a.setBattleText("It's not very effective...",-1,function(){a.runQueue(true)}):b.value.effec>1?a.setBattleText("It's super effective!",-1,function(){a.runQueue(true)}):setTimeout(function(){a.runQueue(true)},200)}};pokerpg.Renderer.hookRender(c)};
pokerpg.Battle.prototype.animateExp=function(){var a=this,b=this.curAction;if((b.player<Math.floor(this.players.length/2)?0:1)==this.myTeam||this.curPokemon.level>=100)this.runQueue(true);else{this.textDelay=1/0;var c=b.value,e=Math.ceil(c/50);c<100?e=Math.ceil(c/50):c>500?e=Math.ceil(c/70):c>1E3?e=Math.ceil(c/100):c>5E3&&(e=Math.ceil(c/150));var f=null,f=function(){var g=a.curPokemon;e>c&&(e=c);g.experience=g.experience+e;c=c-e;if(g.experience>=g.experienceNeeded){c=c+(g.experience-g.experienceNeeded);
if(a.resultQueue[0].type=="pokemonLevelup"){g=a.resultQueue.shift();pokerpg.Main.log("info.type "+g.type);if(g.type!="pokemonLevelup")throw"Assertion failed";a.setCurPokemon(g.value);g=a.curPokemon;g.experience=0;if(b.player!=a.myId)return;pokerpg.Renderer.unHookRender(f);a.setBattleText(pokerpg.Util.getPokemonDisplayName(a.curPokemon)+" grew to LV. "+a.curPokemon.level+"!",-1,function(){a.resultQueue.length>0&&a.resultQueue[0].type=="pokemonLearnedMove"?a.learnedMoves(a.resultQueue.shift(),$closure(a,
"animateExp")):a.animateExp()})}}if(c<=0){pokerpg.Renderer.unHookRender(f);setTimeout(function(){a.runQueue(true)},100)}};pokerpg.Renderer.hookRender(f)}};pokerpg.Battle.prototype.playMove=function(a){this.curMove=a=pokerpg.Move.getMove(a);a.start()};pokerpg.Battle.prototype.moveFinished=function(){var a=this;this.curMove=null;this.shakePokemonStatus=this.shakeEnemyStatus=false;this.curAction.type=="moveAttack"?this.animateHp():setTimeout(function(){a.runQueue(true)},200)};
pokerpg.Battle.prototype.buttonHandler=function(a){if(pokerpg.Renderer.curTransition==null){if(this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU)switch(this.selectedAction){case 0:if(a==3)this.selectedAction=1;else if(a==0)this.selectedAction=2;break;case 1:if(a==1)this.selectedAction=0;else if(a==0)this.selectedAction=3;break;case 2:if(a==2)this.selectedAction=0;else if(a==3)this.selectedAction=3;break;case 3:if(a==2)this.selectedAction=1;else if(a==1)this.selectedAction=2}else if(this.step==
pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU)switch(this.selectedMove){case 0:if(a==3&&this.curPokemon.moves[1]!=null)this.selectedMove=1;else if(a==0&&this.curPokemon.moves[2]!=null)this.selectedMove=2;break;case 1:if(a==1&&this.curPokemon.moves[0]!=null)this.selectedMove=0;else if(a==0&&this.curPokemon.moves[3]!=null)this.selectedMove=3;break;case 2:if(a==2&&this.curPokemon.moves[0]!=null)this.selectedMove=0;else if(a==3&&this.curPokemon.moves[3]!=null)this.selectedMove=3;break;case 3:if(a==2&&this.curPokemon.moves[1]!=
null)this.selectedMove=1;else if(a==1&&this.curPokemon.moves[2]!=null)this.selectedMove=2}else this.step==pokerpg.BATTLE_STEP.BATTLE_STEP_LEARN_MOVE&&(a==2?this.forgetMoveSelected>0&&--this.forgetMoveSelected:a==0&&this.forgetMoveSelected<4&&++this.forgetMoveSelected);if(this.text!=""&&this.textCompleted&&this.textQuestion)if(this.textQuestionSelectedAnswer){if(a==0)this.textQuestionSelectedAnswer=false}else if(a==2)this.textQuestionSelectedAnswer=true}};
pokerpg.Battle.prototype.finish=function(){var a=this;pokerpg.UI.dirButtonHooks.remove($closure(this,"buttonHandler"));pokerpg.Connection.socket.emit("battleFinished");pokerpg.Connection.socket.once("battleFinish",function(b){pokerpg.Game.setPokemonParty(b.pokemon);a.battleFinished=true});var b=0,c=null,e=pokerpg.Main.ctx,f=pokerpg.Main.canvas,c=function(){e.fillStyle="#000000";if(b<15){e.globalAlpha=b/15;e.fillRect(0,0,f.width,f.height);e.globalAlpha=1}else if(b<20){e.globalAlpha=1;e.fillRect(0,
0,f.width,f.height);if(!a.battleFinished)return;if(b==15){pokerpg.Game.curGame.inBattle=false;pokerpg.Game.curGame.isBattlePVP=false;pokerpg.Game.curGame.battle=null;pokerpg.Game.curGame.drawPlayerChar=true;pokerpg.Game.curGame.drawPlayerFollower=true;var g=pokerpg.Game.curGame.getPlayerChar();if(g!=null){g.inBattle=false;g.isBattlePVP=false}}}else{e.globalAlpha=1-(b-20)/8;e.fillRect(0,0,f.width,f.height);e.globalAlpha=1;b>=28&&pokerpg.Renderer.unHookRender(c)}++b};pokerpg.Renderer.hookRender(c)};
pokerpg.Battle.prototype.__class__=pokerpg.Battle;pokerpg.BATTLE_STEP={__ename__:["pokerpg","BATTLE_STEP"],__constructs__:"BATTLE_STEP_TRANSITION,BATTLE_STEP_POKEMON_APPEARED_TMP,BATTLE_STEP_POKEMON_APPEARED,BATTLE_STEP_GO_POKEMON,BATTLE_STEP_ACTION_MENU,BATTLE_STEP_FIGHT_MENU,BATTLE_STEP_TURN,BATTLE_STEP_LEARN_MOVE".split(",")};pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION=["BATTLE_STEP_TRANSITION",0];pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION.toString=$estr;
pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION.__enum__=pokerpg.BATTLE_STEP;pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP=["BATTLE_STEP_POKEMON_APPEARED_TMP",1];pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP.toString=$estr;pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED_TMP.__enum__=pokerpg.BATTLE_STEP;pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED=["BATTLE_STEP_POKEMON_APPEARED",2];pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED.toString=$estr;
pokerpg.BATTLE_STEP.BATTLE_STEP_POKEMON_APPEARED.__enum__=pokerpg.BATTLE_STEP;pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON=["BATTLE_STEP_GO_POKEMON",3];pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON.toString=$estr;pokerpg.BATTLE_STEP.BATTLE_STEP_GO_POKEMON.__enum__=pokerpg.BATTLE_STEP;pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU=["BATTLE_STEP_ACTION_MENU",4];pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU.toString=$estr;pokerpg.BATTLE_STEP.BATTLE_STEP_ACTION_MENU.__enum__=pokerpg.BATTLE_STEP;
pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU=["BATTLE_STEP_FIGHT_MENU",5];pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU.toString=$estr;pokerpg.BATTLE_STEP.BATTLE_STEP_FIGHT_MENU.__enum__=pokerpg.BATTLE_STEP;pokerpg.BATTLE_STEP.BATTLE_STEP_TURN=["BATTLE_STEP_TURN",6];pokerpg.BATTLE_STEP.BATTLE_STEP_TURN.toString=$estr;pokerpg.BATTLE_STEP.BATTLE_STEP_TURN.__enum__=pokerpg.BATTLE_STEP;pokerpg.BATTLE_STEP.BATTLE_STEP_LEARN_MOVE=["BATTLE_STEP_LEARN_MOVE",7];
pokerpg.BATTLE_STEP.BATTLE_STEP_LEARN_MOVE.toString=$estr;pokerpg.BATTLE_STEP.BATTLE_STEP_LEARN_MOVE.__enum__=pokerpg.BATTLE_STEP;
pokerpg.CCharacter=function(a){if(a!==$_){var b=this;pokerpg.GameObject.call(this,a.x,a.y,a.direction);this.username=a.username;this.targetX=this.x;this.targetY=this.y;this.targetDirection=this.direction;this.animationStep=0;this.walking=this.loaded=false;this.walkingPerc=0;this.walkingHasMoved=false;this.inBattle=a.inBattle;this.isBattlePVP=false;this.randInt=Math.floor(Math.random()*100);this.follower=a.follower;this.lastMoveTick=0;this.canUpdate=true;this.onTarget=null;this.lastX=a.lastX;this.lastY=
a.lastY;this.lastMouseX=this.lastMouseY=0;this.transmitWalk=true;this.createdTick=pokerpg.Renderer.numRTicks;this.noclip=false;this.lockDirection=-1;this.battleHasWalkedBack=false;this.renderOffsetX=this.renderOffsetY=0;this.renderAlpha=1;this.freezeTicks=0;this.jumping=false;this.followerShiny=a.folShiny;this.image=pokerpg.Game.curGame.getImage("resources/chars/"+a.type+".png",function(){b.loaded=true});pokerpg.Game.curGame.characters.push(this);this.followerObj=new pokerpg.entities.CFollower(this);
this.canRenderUsername=true;this.speechText="";pokerpg.Main.menuContainer.innerHTML="<a href=#>"+pokerpg.Game.username+"</a>";pokerpg.Main.jq("#canvas").bind("contextmenu",function(){pokerpg.Main.menuContainer.style.top=pokerpg.UI.mouseY-10+"px";pokerpg.Main.menuContainer.style.left=pokerpg.UI.mouseX-10+"px";pokerpg.Main.jq(pokerpg.Main.menuContainer).show();return false});pokerpg.Main.jq(document).ready(function(){pokerpg.Main.jq("#menuContainer").mouseleave(function(){pokerpg.Main.jq("#menuContainer").hide()})})}};
pokerpg.CCharacter.__name__=["pokerpg","CCharacter"];pokerpg.CCharacter.__super__=pokerpg.GameObject;for(k in pokerpg.GameObject.prototype)pokerpg.CCharacter.prototype[k]=pokerpg.GameObject.prototype[k];pokerpg.CCharacter.prototype.username=null;pokerpg.CCharacter.prototype.inBattle=null;pokerpg.CCharacter.prototype.isBattlePVP=null;pokerpg.CCharacter.prototype.type=null;pokerpg.CCharacter.prototype.lastX=null;pokerpg.CCharacter.prototype.lastY=null;pokerpg.CCharacter.prototype.lastMouseX=null;
pokerpg.CCharacter.prototype.lastMouseY=null;pokerpg.CCharacter.prototype.selectedUsername=null;pokerpg.CCharacter.prototype.targetX=null;pokerpg.CCharacter.prototype.targetY=null;pokerpg.CCharacter.prototype.targetDirection=null;pokerpg.CCharacter.prototype.animationStep=null;pokerpg.CCharacter.prototype.loaded=null;pokerpg.CCharacter.prototype.follower=null;pokerpg.CCharacter.prototype.followerShiny=null;pokerpg.CCharacter.prototype.walking=null;pokerpg.CCharacter.prototype.walkingHasMoved=null;
pokerpg.CCharacter.prototype.walkingPerc=null;pokerpg.CCharacter.prototype.lastMoveTick=null;pokerpg.CCharacter.prototype.canUpdate=null;pokerpg.CCharacter.prototype.onTarget=null;pokerpg.CCharacter.prototype.battleEnemy=null;pokerpg.CCharacter.prototype.battleEnemyShiny=null;pokerpg.CCharacter.prototype.image=null;pokerpg.CCharacter.prototype.freezeTicks=null;pokerpg.CCharacter.prototype.jumping=null;pokerpg.CCharacter.prototype.followerObj=null;pokerpg.CCharacter.prototype.transmitWalk=null;
pokerpg.CCharacter.prototype.createdTick=null;pokerpg.CCharacter.prototype.noclip=null;pokerpg.CCharacter.prototype.lockDirection=null;pokerpg.CCharacter.prototype.wildPokemon=null;pokerpg.CCharacter.prototype.battleHasWalkedBack=null;pokerpg.CCharacter.prototype.battleX=null;pokerpg.CCharacter.prototype.battleY=null;pokerpg.CCharacter.prototype.battleLastX=null;pokerpg.CCharacter.prototype.battleLastY=null;pokerpg.CCharacter.prototype.battleFolX=null;pokerpg.CCharacter.prototype.battleFolY=null;
pokerpg.CCharacter.prototype.renderOffsetX=null;pokerpg.CCharacter.prototype.renderOffsetY=null;pokerpg.CCharacter.prototype.renderAlpha=null;pokerpg.CCharacter.prototype.canRenderUsername=null;pokerpg.CCharacter.prototype.speechText=null;pokerpg.CCharacter.prototype.speechTextTime=null;pokerpg.CCharacter.prototype.speechTextCompleted=null;pokerpg.CCharacter.prototype.speechTextCompletedTime=null;pokerpg.CCharacter.prototype.speechTextDelay=null;pokerpg.CCharacter.prototype.speechTextOnComplete=null;
pokerpg.CCharacter.prototype.now=null;pokerpg.CCharacter.prototype.invitedPVP=null;pokerpg.CCharacter.prototype.invitedTimeExpires=null;pokerpg.CCharacter.prototype.destroy=function(){pokerpg.GameObject.prototype.destroy.call(this);pokerpg.Game.curGame.characters.remove(this);this.inBattle=false;this.followerObj.destroy();this.wildPokemon!=null&&this.wildPokemon.destroy()};
pokerpg.CCharacter.prototype.update=function(a){if(this.canUpdate){this.follower=a.follower;this.followerShiny=a.folShiny;if(a.username==pokerpg.Game.username){if(a.type!=pokerpg.Game.playerBackspriteType){pokerpg.Game.playerBackspriteType=a.type;pokerpg.Game.res.playerBacksprite=new pokerpg.ImageResource("resources/chars_sprites/"+a.type+".png")}}else{this.inBattle=a.inBattle;this.battleEnemy=a.battleEnemy;this.battleEnemyShiny=a.battleEnemyShiny;this.targetX=a.x;this.targetY=a.y;this.targetDirection=
a.direction;this.lastX=a.lastX;this.lastY=a.lastY;if(this.x==a.x&&this.y==a.y)this.direction=a.direction;else if(!(Math.abs(this.x-a.x)<=1&&Math.abs(this.y-a.y)<=1||this.x-2==a.x&&this.y==a.y||this.x+2==a.x&&this.y==a.y||this.x==a.x&&this.y-2==a.y||this.x==a.x&&this.y+2==a.y)){this.direction=a.direction;this.x=a.x;this.y=a.y}}}};
pokerpg.CCharacter.prototype.isControllable=function(){return this.username==pokerpg.Game.username&&!pokerpg.Game.curGame.inBattle&&pokerpg.Game.curGame.playerCanMove&&!pokerpg.Chat.inChat&&this.freezeTicks==0};
pokerpg.CCharacter.prototype.getRenderPosX=function(){if(!this.walking)return Math.floor(this.x*pokerpg.Map.getCurMap().tilewidth+this.renderOffsetX);var a=this.x*pokerpg.Map.getCurMap().tilewidth,b=(this.walkingPerc-0.3)*(1/0.7);if(this.walkingPerc>=0.3)if(this.walkingHasMoved)switch(this.direction){case 1:a=a+pokerpg.Map.getCurMap().tilewidth*(1-b);break;case 3:a=a-pokerpg.Map.getCurMap().tilewidth*(1-b)}else switch(this.direction){case 1:a=a-pokerpg.Map.getCurMap().tilewidth*b;break;case 3:a=a+
pokerpg.Map.getCurMap().tilewidth*b}return Math.floor(a+this.renderOffsetX)};
pokerpg.CCharacter.prototype.getRenderPosY=function(){if(!this.walking)return Math.floor(this.y*pokerpg.Map.getCurMap().tileheight-32+this.renderOffsetY);var a=this.y*pokerpg.Map.getCurMap().tileheight-32,b=(this.walkingPerc-0.3)*(1/0.7);if(this.walkingPerc>=0.3)if(this.walkingHasMoved)switch(this.direction){case 2:a=a+pokerpg.Map.getCurMap().tileheight*(1-b);break;case 0:a=a-pokerpg.Map.getCurMap().tileheight*(1-b)}else switch(this.direction){case 2:a=a-pokerpg.Map.getCurMap().tileheight*b;break;
case 0:a=a+pokerpg.Map.getCurMap().tileheight*b}return Math.floor(a+this.renderOffsetY)};pokerpg.CCharacter.prototype.tick=function(){pokerpg.GameObject.prototype.tick.call(this);this.tickWalking();if(this.username==pokerpg.Game.username)this.tickWildBattle();else if(this.x==this.targetX&&this.y==this.targetY&&!this.walking&&this.onTarget!=null){this.onTarget();this.onTarget=null}this.freezeTicks>0&&--this.freezeTicks};
pokerpg.CCharacter.prototype.tickWalking=function(){var a=pokerpg.Game.curGame.map;if(!this.walking){this.walkingHasMoved=false;this.walkingPerc=0;if(this.username==pokerpg.Game.username){if(this.isControllable())if(pokerpg.UI.keysDown[37]){this.walking=true;if(this.direction==1)this.walkingPerc=0.3;this.direction=1}else if(pokerpg.UI.keysDown[40]){this.walking=true;if(this.direction==0)this.walkingPerc=0.3;this.direction=0}else if(pokerpg.UI.keysDown[39]){this.walking=true;if(this.direction==3)this.walkingPerc=
0.3;this.direction=3}else if(pokerpg.UI.keysDown[38]){this.walking=true;if(this.direction==2)this.walkingPerc=0.3;this.direction=2}}else this.tickBot()}if(this.walking){if(this.isControllable())switch(this.direction){case 1:if(!pokerpg.UI.keysDown[37]&&this.walkingPerc<0.3){this.walking=false;pokerpg.Connection.socket.emit("turn",{dir:this.direction});return}break;case 0:if(!pokerpg.UI.keysDown[40]&&this.walkingPerc<0.3){this.walking=false;pokerpg.Connection.socket.emit("turn",{dir:this.direction});
return}break;case 3:if(!pokerpg.UI.keysDown[39]&&this.walkingPerc<0.3){this.walking=false;pokerpg.Connection.socket.emit("turn",{dir:this.direction});return}break;case 2:if(!pokerpg.UI.keysDown[38]&&this.walkingPerc<0.3){this.walking=false;pokerpg.Connection.socket.emit("turn",{dir:this.direction});return}}this.walkingPerc=this.walkingPerc+0.1;this.animationStep=this.animationStep+0.2;if(this.animationStep>4)this.animationStep=this.animationStep-4;if(this.walkingPerc>=0.35&&!this.walkingHasMoved){var b=
this.getFrontPositionX(),c=this.getFrontPositionY();if(this.isControllable()&&!this.noclip){var e=pokerpg.entities.CWarp.getWarpAt(b,c);if(e!=null&&e.canWarp(this)){Std.is(e,pokerpg.entities.CDoor)?this.enterDoor(e):Std.is(e,pokerpg.entities.CWarpArrow)?this.enterWarpArrow(e):Std.is(e,pokerpg.entities.CStairs)&&this.enterStairs(e);return}if(pokerpg.Map.getCurMap().hasTileProp(b,c,"ledge")&&pokerpg.Map.getCurMap().getLedgeDir(b,c)==this.direction)this.useLedge();else if(this.willMoveIntoAWall()){pokerpg.Connection.socket.emit("turn",
{dir:this.direction});this.walking=false;return}}else pokerpg.Map.getCurMap().hasTileProp(b,c,"ledge")&&pokerpg.Map.getCurMap().getLedgeDir(b,c)==this.direction&&this.useLedge();if(!pokerpg.Game.curGame.inBattle||this.username!=pokerpg.Game.username){this.lastX=this.x;this.lastY=this.y}switch(this.direction){case 1:this.x=this.x-1;break;case 3:this.x=this.x+1;break;case 2:this.y=this.y-1;break;case 0:this.y=this.y+1}this.lastMoveTick=pokerpg.Renderer.numRTicks;this.walkingHasMoved=true;a.hasTileProp(this.x,
this.y,"grass")&&new pokerpg.entities.CGrassAnimation(this.x,this.y);this.username==pokerpg.Game.username&&this.transmitWalk&&pokerpg.Connection.socket.emit("walk",{ack:pokerpg.Connection.lastAckMove,x:this.x,y:this.y,dir:this.direction})}if(this.walkingPerc>=1)if(this.username==pokerpg.Game.username)if(this.isControllable()&&!this.willMoveIntoAWall()&&(this.direction==1&&pokerpg.UI.keysDown[37]||this.direction==0&&pokerpg.UI.keysDown[40]||this.direction==3&&pokerpg.UI.keysDown[39]||this.direction==
2&&pokerpg.UI.keysDown[38])){this.walkingHasMoved=false;this.walkingPerc=0.4}else{this.walkingHasMoved=this.walking=false;this.walkingPerc=0}else{this.walkingHasMoved=false;this.walkingPerc=0.4;this.walking=false;this.tickBot()}}else this.animationStep=0};
pokerpg.CCharacter.prototype.tickWildBattle=function(){var a,b;if(!pokerpg.Game.curGame.isBattlePVP)if(pokerpg.Game.curGame.inBattle){var c=pokerpg.Game.curGame.map;if(this.wildPokemon==null&&this.battleEnemy!=null&&!this.walking)if(this.battleHasWalkedBack){a=this.battleX;b=this.battleY;if(this.walking&&!this.walkingHasMoved)switch(this.direction){case 1:a=a-1;break;case 3:a=a+1;break;case 2:b=b-1;break;case 0:b=b+1}this.wildPokemon=new pokerpg.entities.CWildPokemon(this.battleEnemy,a,b,this,this.battleEnemyShiny);
pokerpg.Renderer.curTransition.step=7}else{this.battleX=this.x;this.battleY=this.y;this.lockDirection=this.direction;this.direction=(this.direction+2)%4;this.walking=true;this.walkingHasMoved=false;this.walkingPerc=0;this.battleHasWalkedBack=true;a=this.battleX;b=this.battleY;switch(this.direction){case 1:a=a-1;break;case 3:a=a+1;break;case 2:b=b-1;break;case 0:b=b+1}this.battleLastX=a;this.battleLastY=b;a=this.battleX;b=this.battleY;switch(this.direction){case 1:a=a-2;break;case 3:a=a+2;break;case 2:b=
b-2;break;case 0:b=b+2}if(c.hasTileProp(a,b,"solid")||c.hasTileProp(a,b,"water")||c.hasTileProp(a,b,"ledge")){a=this.battleX;b=this.battleY;switch(this.direction){case 1:a=a-1;break;case 3:a=a+1;break;case 2:b=b-1;break;case 0:b=b+1}}this.battleFolX=a;this.battleFolY=b}if(this.battleHasWalkedBack){this.followerObj.forceTarget=true;this.lastX=this.battleFolX;this.lastY=this.battleFolY}}else{this.followerObj.forceTarget=false;if(this.wildPokemon!=null){this.wildPokemon.destroy();this.wildPokemon=null}if(this.lockDirection!=
-1){this.direction=this.lockDirection;this.lockDirection=-1;this.lastX=this.battleLastX;this.lastY=this.battleLastY;a=this.battleX;b=this.battleY;switch(this.direction){case 1:a=a+1;break;case 3:a=a-1;break;case 2:b=b+1;break;case 0:b=b-1}this.followerObj.x=a;this.followerObj.y=b}this.battleHasWalkedBack=false}};
pokerpg.CCharacter.prototype.enterDoor=function(a){var b=this,c=this.x,e=this.y,f=pokerpg.Main.canvas,g=pokerpg.Main.ctx;a.open();this.walking=false;if(this.username==pokerpg.Game.username){pokerpg.Game.curGame.playerCanMove=false;pokerpg.Game.curGame.queueLoadMap=true}var h=0,j=null,j=function(){++h;if(!(h<15)){if(h==15){b.walking=true;b.noclip=true;b.transmitWalk=false}b.lastX=c;b.lastY=e;if(b.username==pokerpg.Game.username){if(h==23)pokerpg.Game.curGame.drawPlayerChar=false;var a=pokerpg.Util.clamp((h-
20)/10,0,1);g.fillStyle="rgba(0,0,0,"+a+")";g.fillRect(0,0,f.width,f.height);if(h==30){b.noclip=false;b.transmitWalk=true;pokerpg.Game.curGame.queueLoadMap=false;pokerpg.Game.curGame.queuedMap!=null&&pokerpg.Game.loadMap(pokerpg.Game.curGame.queuedMap,pokerpg.Game.curGame.queuedChars)}}else if(h==23){b.destroy();pokerpg.Renderer.unHookRender(j)}}};this.username==pokerpg.Game.username&&pokerpg.Connection.socket.emit("useWarp",{name:a.name,direction:this.direction});pokerpg.Renderer.hookRender(j)};
pokerpg.CCharacter.prototype.enterWarpArrow=function(a){var b=this,c=pokerpg.Main.ctx,e=pokerpg.Main.canvas;a.disable=true;this.walking=false;if(this.username==pokerpg.Game.username){pokerpg.Game.curGame.playerCanMove=false;pokerpg.Game.curGame.queueLoadMap=true}var f=0,g=null,g=function(){++f;if(b.username==pokerpg.Game.username){var a=pokerpg.Util.clamp(f/10,0,1);c.fillStyle="rgba(0,0,0,"+a+")";c.fillRect(0,0,e.width,e.height);if(f==10){pokerpg.Game.curGame.queueLoadMap=false;pokerpg.Game.curGame.queuedMap!=
null&&pokerpg.Game.loadMap(pokerpg.Game.curGame.queuedMap,pokerpg.Game.curGame.queuedChars)}}else{b.destroy();pokerpg.Renderer.unHookRender(g)}};this.username==pokerpg.Game.username&&pokerpg.Connection.socket.emit("useWarp",{name:a.name,direction:this.direction});pokerpg.Renderer.hookRender(g)};
pokerpg.CCharacter.prototype.enterStairs=function(a){var b=this,c=this.x,e=this.y,f=pokerpg.Main.canvas,g=pokerpg.Main.ctx;this.walking=true;this.canRenderUsername=false;if(this.username==pokerpg.Game.username){pokerpg.Game.curGame.playerCanMove=false;pokerpg.Game.curGame.queueLoadMap=true}var h=0,j=null,j=function(){++h;b.walking=true;b.noclip=true;b.transmitWalk=false;if(b.walkingPerc<=0.3)b.walkingPerc=b.walkingPerc+0.3;b.lastX=c;b.lastY=e;if(a.direction==0)b.renderOffsetY=b.renderOffsetY+16/9;
else if(a.direction==2)b.renderOffsetY=b.renderOffsetY-16/9;else throw"Assertion error";if(b.username==pokerpg.Game.username){var i=pokerpg.Util.clamp(h/10,0,1);g.fillStyle="rgba(0,0,0,"+i+")";g.fillRect(0,0,f.width,f.height);if(h==10){pokerpg.Game.curGame.drawPlayerChar=false;b.noclip=false;b.transmitWalk=true;pokerpg.Game.curGame.queueLoadMap=false;pokerpg.Game.curGame.queuedMap!=null&&pokerpg.Game.loadMap(pokerpg.Game.curGame.queuedMap,pokerpg.Game.curGame.queuedChars)}}else{b.renderAlpha=pokerpg.Util.clamp(1-
h/10,0,1);if(h==10){b.destroy();b.canRenderUsername=true;pokerpg.Renderer.unHookRender(j)}}};this.username==pokerpg.Game.username&&pokerpg.Connection.socket.emit("useWarp",{name:a.name,direction:this.direction});pokerpg.Renderer.hookRender(j)};
pokerpg.CCharacter.prototype.useLedge=function(){var a=this,b=this.getFrontPositionX(),c=this.getFrontPositionY(),e=this.getFrontPositionX(2),f=this.getFrontPositionY(2);this.noclip=this.walking=true;this.transmitWalk=false;this.jumping=true;if(this.username==pokerpg.Game.username)pokerpg.Game.curGame.playerCanMove=false;var g=0,h=null,h=function(){++g;if(a.x!=e||a.y!=f)a.walking=true;a.renderOffsetY=Math.min(Math.round(8/15*g*g+-8*g),0);g==18&&new pokerpg.entities.CLedgeSmoke(a.x,a.y);if(g>=20){a.renderOffsetY=
0;a.walking=false;if(a.username==pokerpg.Game.username)pokerpg.Game.curGame.playerCanMove=true;a.noclip=false;a.jumping=false;a.transmitWalk=true;a.freezeTicks=2;a.x=e;a.y=f;a.lastX=a.x;a.lastY=a.y;pokerpg.Renderer.unHookRender(h)}};this.username==pokerpg.Game.username&&pokerpg.Connection.socket.emit("useLedge",{ack:pokerpg.Connection.lastAckMove,x:b,y:c});pokerpg.Renderer.hookRender(h)};
pokerpg.CCharacter.prototype.willMoveIntoAWall=function(){var a=this.getFrontPositionX(),b=this.getFrontPositionY(),c=pokerpg.Game.curGame.map;return c.hasTileProp(a,b,"solid")||c.hasTileProp(a,b,"water")||c.hasTileProp(a,b,"ledge")};pokerpg.CCharacter.prototype.getFrontPositionX=function(a){a==null&&(a=1);switch(this.direction){case 1:return this.x-a;case 3:return this.x+a;case 2:return this.x;case 0:return this.x}return null};
pokerpg.CCharacter.prototype.getFrontPositionY=function(a){a==null&&(a=1);switch(this.direction){case 1:return this.y;case 3:return this.y;case 2:return this.y-a;case 0:return this.y+a}return null};
pokerpg.CCharacter.prototype.tickBot=function(){if(!this.walking)if(this.walking=this.x!=this.targetX||this.y!=this.targetY){var a=this.direction;this.direction=Math.abs(this.x-this.targetX)>0&&this.y==this.targetY?this.x<this.targetX?3:1:Math.abs(this.y-this.targetY)>0&&this.x==this.targetX?this.y<this.targetY?0:2:this.targetY<this.y?2:0;if(a!=this.direction)this.walkingPerc=0}};
pokerpg.CCharacter.prototype.setSpeechText=function(a,b,c){var e=this;this.speechText=a==null?"":a;this.speechTextTime=this.now;if(b==null)b=Math.NaN;this.speechTextDelay=b;c==null&&(c=function(){pokerpg.Game.curGame.playerCanMove=true;e.speechText=""});this.speechTextOnComplete=c;this.speechTextCompleted=false;pokerpg.Game.curGame.playerCanMove=false};
pokerpg.CCharacter.prototype.drawSpeechMessage=function(a){var b=this;if(this.speechText!=""){pokerpg.Util.drawRoundedRect(0,450,pokerpg.Main.canvas.width,90,0,"#000000",0.75);var c=this.speechText.substr(0,Math.floor((this.now-this.speechTextTime)/30));a.font="24px Font2";var e=c,f=null;if(a.measureText(c).width>420){e=c;f="";do{e=e.split(" ");f=e.pop()+" "+f;e=e.join(" ")}while(a.measureText(e).width>420);a.fillStyle="rgb(0,0,0)";a.fillText(e,194,488);a.fillText(f,194,516);a.fillText(e,192,490);
a.fillText(f,192,518);a.fillText(e,194,490);a.fillText(f,194,518);a.fillStyle="rgb(249,250,249)";a.fillText(e,192,488);a.fillText(f,192,516);e=f}else{a.fillStyle="rgb(0,0,0)";a.fillText(c,192,490);a.fillText(c,194,488);a.fillText(c,194,490);a.fillStyle="rgb(249,250,249)";a.fillText(c,192,488)}if(c==this.speechText)if(this.speechTextCompleted){if(this.speechTextDelay==-1&&this.now-this.speechTextCompletedTime>100){c=Math.floor(this.now%1E3/250);c==3&&(c=1);c=c*2;a.drawImage(pokerpg.Game.res.battleMisc.obj,
0,0,32,32,190+a.measureText(e).width,462+c+(f!=null?28:0),32,32)}}else{this.speechTextCompleted=true;this.speechTextCompletedTime=this.now;this.speechTextDelay==0?this.speechTextOnComplete!=null&&this.speechTextOnComplete():this.speechTextDelay!=-1?this.speechTextOnComplete!=null&&setTimeout(function(){b.speechTextOnComplete()},this.speechTextDelay):pokerpg.UI.AButtonHooks.push(function(){setTimeout(b.speechTextOnComplete,100)})}}};
pokerpg.CCharacter.prototype.render=function(a){var b=this;if(this.loaded&&(this.username!=pokerpg.Game.username||pokerpg.Game.curGame.drawPlayerChar)){a.save();a.globalAlpha=a.globalAlpha*this.renderAlpha;if(pokerpg.Renderer.numRTicks-this.createdTick<10)a.globalAlpha=a.globalAlpha*((pokerpg.Renderer.numRTicks-this.createdTick)/10);var c=pokerpg.Renderer.getOffsetX(),e=pokerpg.Renderer.getOffsetY(),f=pokerpg.Map.getCurMap(),g=this.getRenderPosX(),h=this.getRenderPosY(),j=this.direction*32;this.lockDirection!=
-1&&(j=this.lockDirection*32);pokerpg.UI.mouseX>=g+c-5&&pokerpg.UI.mouseY>=h+e-5&&pokerpg.UI.mouseX<g+32+c+10&&pokerpg.UI.mouseY<h+64+e+10&&pokerpg.Renderer.drawOverlay(a,g+c,h+e,32,64,function(a){a.drawImage(b.image.obj,j,Math.floor(b.animationStep)*64,32,64,0,0,32,64)});if(pokerpg.UI.mouseX>=g+c-5&&pokerpg.UI.mouseY>=h+e-5&&pokerpg.UI.mouseX<g+32+c+10&&pokerpg.UI.mouseY<h+64+e+10&&pokerpg.UI.mouseX!=this.lastMouseX&&pokerpg.UI.mouseY!=this.lastMouseY){this.lastMouseX=pokerpg.UI.mouseX;this.lastMouseY=
pokerpg.UI.mouseY}if(this.canRenderUsername){a.save();a.font="12px Font2";a.fillStyle="rgba(0, 0, 0, 0.5)";var i,l,o;i=g+c+16+1-Math.round(a.measureText(this.username).width/2)-6;l=h+e+5;o=a.measureText(this.username).width+10;pokerpg.Util.drawRoundedRect(Std["int"](i),Std["int"](l),Std["int"](o),Std["int"](15),5,"#000000",0.4);a.textAlign="center";a.fillStyle="#000000";a.fillText(this.username,g+c+16+1,h+e+17);a.fillStyle="#FFFFFF";a.fillText(this.username,g+c+16,h+e+16);a.restore()}if(this.jumping)a.drawImage(pokerpg.Game.res.miscSprites.obj,
0,64,32,32,g+c,h+e-this.renderOffsetY+30,32,32);else{a.save();a.globalAlpha=0.25;a.drawImage(pokerpg.Game.res.miscSprites.obj,0,64,32,32,g+c,h+e-this.renderOffsetY+30,32,32);a.restore()}a.drawImage(this.image.obj,j,Math.floor(this.animationStep)*64,32,64,g+c,h+e,32,64);f.hasTileProp(this.x,this.y,"grass")&&!this.walking&&a.drawImage(pokerpg.Game.res.miscSprites.obj,0,0,32,32,this.x*f.tilewidth+c,this.y*f.tileheight+e,32,32);if(this.inBattle&&this.username!=pokerpg.Game.username){a.save();f=0;f=(pokerpg.Renderer.numRTicks+
this.randInt)%31/30;f=f*2;f>1&&(f=1-(f-1));a.translate(g+c+16,h+e-15+Math.round(f*f*10));a.rotate((pokerpg.Renderer.numRTicks+this.randInt)%11/10*Math.PI*2);a.drawImage(pokerpg.Game.res.uiCharInBattle.obj,-10,-10);a.restore()}pokerpg.Renderer.numRTicks-this.createdTick<10&&a.restore();this.now=Date.now().getTime()}};pokerpg.CCharacter.prototype.__class__=pokerpg.CCharacter;pokerpg.entities.CWarp=function(a,b,c){if(a!==$_){pokerpg.GameObject.call(this,b,c);this.name=a;this.disable=false}};
pokerpg.entities.CWarp.__name__=["pokerpg","entities","CWarp"];pokerpg.entities.CWarp.__super__=pokerpg.GameObject;for(k in pokerpg.GameObject.prototype)pokerpg.entities.CWarp.prototype[k]=pokerpg.GameObject.prototype[k];pokerpg.entities.CWarp.getWarpAt=function(a,b){for(var c=0,e=pokerpg.Game.curGame.gameObjects;c<e.length;){var f=e[c];++c;if(f.x==a&&f.y==b&&Std.is(f,pokerpg.entities.CWarp))return f}return null};
pokerpg.entities.CWarp.getWarpByName=function(a){for(var b=0,c=pokerpg.Game.curGame.gameObjects;b<c.length;){var e=c[b];++b;if(Std.is(e,pokerpg.entities.CWarp)&&e.name==a)return e}return null};pokerpg.entities.CWarp.prototype.name=null;pokerpg.entities.CWarp.prototype.disable=null;pokerpg.entities.CWarp.prototype.canWarp=function(){return true};pokerpg.entities.CWarp.prototype.__class__=pokerpg.entities.CWarp;
pokerpg.entities.CStairs=function(a,b,c,e,f){if(a!==$_){pokerpg.entities.CWarp.call(this,a,b,c);this.direction=e;this.fromDir=f}};pokerpg.entities.CStairs.__name__=["pokerpg","entities","CStairs"];pokerpg.entities.CStairs.__super__=pokerpg.entities.CWarp;for(k in pokerpg.entities.CWarp.prototype)pokerpg.entities.CStairs.prototype[k]=pokerpg.entities.CWarp.prototype[k];pokerpg.entities.CStairs.prototype.fromDir=null;pokerpg.entities.CStairs.prototype.canWarp=function(a){return a.direction==this.fromDir};
pokerpg.entities.CStairs.prototype.__class__=pokerpg.entities.CStairs;pokerpg.Game=function(a){if(a!==$_){this.loaded=false;this.queueLoadMap=this.isBattlePVP=this.inBattle=pokerpg.Game.loadError=false;this.gameObjects=[];this.characters=[];this.cachedImages=new Hash;this.drawPlayerFollower=this.drawPlayerChar=this.playerCanMove=true;pokerpg.Renderer.resetHooks()}};pokerpg.Game.__name__=["pokerpg","Game"];pokerpg.Game.state=null;pokerpg.Game.username=null;pokerpg.Game.accountLevel=null;
pokerpg.Game.curGame=null;pokerpg.Game.pokemonParty=null;pokerpg.Game.loadError=null;pokerpg.Game.res=null;pokerpg.Game.pokemonData=null;pokerpg.Game.movesData=null;pokerpg.Game.playerBackspriteType=null;pokerpg.Game.loadedBasicUI=null;pokerpg.Game.setup=function(){pokerpg.Game.loadError=false;pokerpg.Game.loadedBasicUI=false;pokerpg.Game.state=pokerpg.GameState.ST_UNKNOWN;pokerpg.Game.res={};pokerpg.Game.accountLevel=0};
pokerpg.Game.setPokemonParty=function(a){for(var b=0,c=a.length;b<c;){var e=b++;a[e].icon=pokerpg.Game.curGame!=null?pokerpg.Game.curGame.getImage("resources/picons/"+a[e].id+"_1.png"):new pokerpg.ImageResource("resources/picons/"+a[e].id+"_1.png");var f="";a[e].id.length==1?f="00":a[e].id.length==2&&(f="0");if(pokerpg.Game.curGame!=null){pokerpg.Game.curGame.getImage("resources/pokemon/back/"+f+a[e].id+(a[e].shiny==true?"s":"")+"b.png");pokerpg.Game.curGame.getImage("resources/followers/"+f+a[e].id+
(a[e].shiny==true?"s":"")+"_0.png")}else{(new Image).src="resources/pokemon/back/"+f+a[e].id+(a[e].shiny==true?"s":"")+"b.png";(new Image).src="resources/followers/"+f+a[e].id+(a[e].shiny==true?"s":"")+"_0.png"}}pokerpg.Game.pokemonParty=a};
pokerpg.Game.loadMap=function(a,b){pokerpg.Game.curGame=new pokerpg.Game;pokerpg.Game.state=pokerpg.GameState.ST_LOADING;if(!pokerpg.Game.loadedBasicUI){pokerpg.Game.loadedBasicUI=true;pokerpg.Game.loadImageResource("miscSprites","resources/tilesets/misc.png");pokerpg.Game.loadImageResource("doorSprites","resources/tilesets/doors.png");pokerpg.Game.loadImageResource("uiChat","resources/ui/chat.png");pokerpg.Game.loadImageResource("uiCharInBattle","resources/ui/char_in_battle.png");pokerpg.Game.loadImageResource("battleMoveMenu",
"resources/ui/battle_move_menu.png");pokerpg.Game.loadImageResource("battleTrainerStatus","resources/ui/battle_trainer_status.png");pokerpg.Game.loadImageResource("battleMisc","resources/ui/battle_misc.png");pokerpg.Game.loadImageResource("battlePokeballs","resources/ui/battle_pokeballs.png");pokerpg.Game.loadImageResource("battleActionMenu","resources/ui/battle_action_menu.png");pokerpg.Game.loadImageResource("types","resources/ui/types.png");pokerpg.Game.loadImageResource("bottomBattleHUD","resources/ui/bottomBattleHUD.png");
pokerpg.Game.loadImageResource("bottomBattleHUDText","resources/ui/bottomBattleHUDText.png");pokerpg.Game.loadImageResource("battlePokemonBar","resources/ui/battle_pokemon_bar2.png");pokerpg.Game.loadImageResource("battleHealthBar","resources/ui/battle_healthbar.png");pokerpg.Game.loadImageResource("battleEnemyBar","resources/ui/battle_enemy_bar2.png");pokerpg.Game.loadImageResource("battleIntroPokeball","resources/ui/battle_intro_pokeball.png");pokerpg.Game.loadImageResource("animatedTileset","resources/tilesets/animated.png");
pokerpg.Game.loadImageResource("battleYesNo","resources/ui/battle_yesno.png");pokerpg.Game.loadImageResource("battleLearnMove","resources/ui/battle_learnmove.png");pokerpg.Game.loadImageResource("battleLearnMoveSelection","resources/ui/battle_learnmove_selection.png");pokerpg.Game.loadJSON("data/pokemon.json",function(a){pokerpg.Game.pokemonData=a});pokerpg.Game.loadJSON("data/moves.json",function(a){pokerpg.Game.movesData=a})}pokerpg.Game.loadJSON("resources/maps/"+a+".json",function(c){for(var e=
new pokerpg.Map(a,c),c=0,f=e.tilesets;c<f.length;){var g=f[c];++c;if(!g.loaded){if(g.error){pokerpg.Game.loadError=true;throw"loadError";}++pokerpg.Game.pendingLoad;g.onload=function(){--pokerpg.Game.pendingLoad};g.onerror=function(){--pokerpg.Game.pendingLoad;pokerpg.Game.loadError=true;throw"loadError";}}}if(e.properties.preload_pokemon!=null){f=e.properties.preload_pokemon.split(",");for(c=0;c<f.length;){g=f[c];++c;var h="";g.length==1?h="00":g.length==2&&(h="0");pokerpg.Game.curGame.getImage("resources/followers/"+
h+g+"_0.png");pokerpg.Game.curGame.getImage("resources/pokemon/front/"+h+g+".png")}}pokerpg.Main.jq("#controls").show();pokerpg.Game.curGame.loaded=true;pokerpg.Game.curGame.map=e;pokerpg.Game.curGame.parseMapObjects();f=b;for(c=0;c<f.length;){e=f[c];++c;e=new pokerpg.CCharacter(e);if(e.username==pokerpg.Game.username)e.freezeTicks=10}})};
pokerpg.Game.loadImageResource=function(a,b){++pokerpg.Game.pendingLoad;return pokerpg.Game.res[a]=new pokerpg.ImageResource(b,function(){--pokerpg.Game.pendingLoad},function(){--pokerpg.Game.pendingLoad;pokerpg.Game.loadError=true;throw"loadError";})};
pokerpg.Game.loadJSON=function(a,b){++pokerpg.Game.pendingLoad;pokerpg.Main.jq.ajax(a,{cache:true,dataType:"text",success:function(a){--pokerpg.Game.pendingLoad;b(JSON.parse(a))},error:function(){--pokerpg.Game.pendingLoad;pokerpg.Game.loadError=true;throw"loadError";}})};pokerpg.Game.getRes=function(a){return pokerpg.Game.res[a]};pokerpg.Game.setRes=function(a,b){pokerpg.Game.res[a]=b};pokerpg.Game.getPokemonData=function(a){return pokerpg.Game.pokemonData[a]};pokerpg.Game.getMoveData=function(a){return pokerpg.Game.movesData[a.toLowerCase()]};
pokerpg.Game.prototype.gameObjects=null;pokerpg.Game.prototype.characters=null;pokerpg.Game.prototype.cachedImages=null;pokerpg.Game.prototype.queueLoadMap=null;pokerpg.Game.prototype.queuedMap=null;pokerpg.Game.prototype.queuedChars=null;pokerpg.Game.prototype.loaded=null;pokerpg.Game.prototype.inBattle=null;pokerpg.Game.prototype.isBattlePVP=null;pokerpg.Game.prototype.battle=null;pokerpg.Game.prototype.map=null;pokerpg.Game.prototype.playerCanMove=null;pokerpg.Game.prototype.drawPlayerChar=null;
pokerpg.Game.prototype.drawPlayerFollower=null;pokerpg.Game.prototype.initBattle=function(a){this.inBattle=true;if(a.type==2)this.isBattlePVP=true;return this.battle=a};pokerpg.Game.prototype.tick=function(){if(pokerpg.Game.state==pokerpg.GameState.ST_MAP){for(var a=this.gameObjects.copy(),b=0,c=a.length;b<c;){var e=b++;a[e].tick()}if(pokerpg.Renderer.numRTicks%30*600==0)this.cachedImages=new Hash}};
pokerpg.Game.prototype.renderObjects=function(a){for(var b=[],c=Math.floor(pokerpg.Renderer.cameraX),e=Math.floor(pokerpg.Renderer.cameraY),f=c+pokerpg.Main.screenWidth/this.map.tilewidth,g=e+pokerpg.Main.screenHeight/this.map.tileheight,h=0,j=this.gameObjects.length;h<j;){var i=h++;this.gameObjects[i].x+2>c&&this.gameObjects[i].y+2>e&&this.gameObjects[i].x-2<f&&this.gameObjects[i].y-2<g&&b.push(this.gameObjects[i])}b.sort(function(a,b){if(a.y<b.y)return-1;if(a.y>b.y)return 1;if(a.y==b.y){if(Std.is(a,
pokerpg.CCharacter)&&a.username==pokerpg.Game.username&&Std.is(b,pokerpg.CCharacter))return 1;if(Std.is(b,pokerpg.CCharacter)&&b.username==pokerpg.Game.username&&Std.is(a,pokerpg.CCharacter)||a.renderPriority>b.renderPriority)return-1;if(b.renderPriority>a.renderPriority||Std.is(a,pokerpg.entities.CGrassAnimation))return 1;if(Std.is(b,pokerpg.entities.CGrassAnimation))return-1;if(Std.is(a,pokerpg.CCharacter)&&Std.is(b,pokerpg.entities.CFollower))return 1;if(Std.is(b,pokerpg.CCharacter)&&Std.is(a,
pokerpg.entities.CFollower))return-1;if(a.randInt>b.randInt)return 1;if(a.randInt<b.randInt)return-1}return 0});h=0;for(j=b.length;h<j;){i=h++;b[i].render(a)}};pokerpg.Game.prototype.getPlayerChar=function(){return this.getCharByUsername(pokerpg.Game.username)};pokerpg.Game.prototype.getCharByUsername=function(a){for(var b=0,c=this.characters.length;b<c;){var e=b++;if(this.characters[e].username==a)return this.characters[e]}return null};
pokerpg.Game.prototype.getImage=function(a,b,c){var e;if(this.cachedImages.exists(a)){e=this.cachedImages.get(a);e.addLoadHook(b);e.addErrorHook(c);return e}e=new pokerpg.ImageResource(a,b,c);this.cachedImages.set(a,e);return e};
pokerpg.Game.prototype.parseMapObjects=function(){for(var a=0,b=this.map.layers;a<b.length;){var c=b[a];++a;if(c.type=="objectgroup")for(var e=0,c=c.objects;e<c.length;){var f=c[e];++e;switch(f.type){case "warp":f.properties.type=="door"||f.properties.type=="labdoor"||f.properties.type=="slidedoor"||f.properties.type=="housedoor01"?new pokerpg.entities.CDoor(f.name,f.properties.type,Math.floor(f.x/this.map.tilewidth),Math.floor(f.y/this.map.tileheight)):f.properties.type=="arrow"?new pokerpg.entities.CWarpArrow(f.name,
Math.floor(f.x/this.map.tilewidth),Math.floor(f.y/this.map.tileheight)):f.properties.type=="stairs_up"?new pokerpg.entities.CStairs(f.name,Math.floor(f.x/this.map.tilewidth),Math.floor(f.y/this.map.tileheight),2,Std.parseInt(f.properties.from_dir)):f.properties.type=="stairs_down"&&new pokerpg.entities.CStairs(f.name,Math.floor(f.x/this.map.tilewidth),Math.floor(f.y/this.map.tileheight),0,Std.parseInt(f.properties.from_dir))}}}};pokerpg.Game.prototype.__class__=pokerpg.Game;
pokerpg.GameState={__ename__:["pokerpg","GameState"],__constructs__:"ST_UNKNOWN,ST_LOADING,ST_MAP,ST_DISCONNECTED,ST_TITLE,ST_NEWGAME,ST_REGISTER".split(",")};pokerpg.GameState.ST_UNKNOWN=["ST_UNKNOWN",0];pokerpg.GameState.ST_UNKNOWN.toString=$estr;pokerpg.GameState.ST_UNKNOWN.__enum__=pokerpg.GameState;pokerpg.GameState.ST_LOADING=["ST_LOADING",1];pokerpg.GameState.ST_LOADING.toString=$estr;pokerpg.GameState.ST_LOADING.__enum__=pokerpg.GameState;pokerpg.GameState.ST_MAP=["ST_MAP",2];
pokerpg.GameState.ST_MAP.toString=$estr;pokerpg.GameState.ST_MAP.__enum__=pokerpg.GameState;pokerpg.GameState.ST_DISCONNECTED=["ST_DISCONNECTED",3];pokerpg.GameState.ST_DISCONNECTED.toString=$estr;pokerpg.GameState.ST_DISCONNECTED.__enum__=pokerpg.GameState;pokerpg.GameState.ST_TITLE=["ST_TITLE",4];pokerpg.GameState.ST_TITLE.toString=$estr;pokerpg.GameState.ST_TITLE.__enum__=pokerpg.GameState;pokerpg.GameState.ST_NEWGAME=["ST_NEWGAME",5];pokerpg.GameState.ST_NEWGAME.toString=$estr;
pokerpg.GameState.ST_NEWGAME.__enum__=pokerpg.GameState;pokerpg.GameState.ST_REGISTER=["ST_REGISTER",6];pokerpg.GameState.ST_REGISTER.toString=$estr;pokerpg.GameState.ST_REGISTER.__enum__=pokerpg.GameState;pokerpg.Move=function(){};pokerpg.Move.__name__=["pokerpg","Move"];pokerpg.Move.list=null;pokerpg.Move.createList=function(){pokerpg.Move.list=new Hash;pokerpg.Move.list.set("def",new pokerpg.moves.MDefault)};
pokerpg.Move.getMove=function(a){pokerpg.Move.list==null&&pokerpg.Move.createList();return!pokerpg.Move.list.exists(a)?pokerpg.Move.list.get("def"):pokerpg.Move.list.get(a)};pokerpg.Move.prototype.start=function(){};pokerpg.Move.prototype.render=function(){};pokerpg.Move.prototype.__class__=pokerpg.Move;pokerpg.moves||(pokerpg.moves={});pokerpg.moves.MDefault=function(a){a!==$_&&pokerpg.Move.call(this)};pokerpg.moves.MDefault.__name__=["pokerpg","moves","MDefault"];
pokerpg.moves.MDefault.__super__=pokerpg.Move;for(k in pokerpg.Move.prototype)pokerpg.moves.MDefault.prototype[k]=pokerpg.Move.prototype[k];
pokerpg.moves.MDefault.prototype.render=function(a,b){var c=b.now;if(b.myId==0)if(b.curAction.player==0){b.canRenderEnemy=Math.floor((c-b.moveStartTime)/100)%2==1;b.shakeEnemyStatus=true}else{b.canRenderPlayerPokemon=Math.floor((c-b.moveStartTime)/100)%2==1;b.shakePokemonStatus=true}else if(b.curAction.player==1){b.canRenderEnemy=Math.floor((c-b.moveStartTime)/100)%2==1;b.shakeEnemyStatus=true}else{b.canRenderPlayerPokemon=Math.floor((c-b.moveStartTime)/100)%2==1;b.shakePokemonStatus=true}if(c-b.moveStartTime>
500){b.canRenderEnemy=true;b.canRenderPlayerPokemon=true;b.moveFinished()}};pokerpg.moves.MDefault.prototype.__class__=pokerpg.moves.MDefault;pokerpg.entities.CDoor=function(a,b,c,e){if(a!==$_){pokerpg.entities.CWarp.call(this,a,c,e);this.renderPriority=100;this.openStep=0;this.typeDoor=b}};pokerpg.entities.CDoor.__name__=["pokerpg","entities","CDoor"];pokerpg.entities.CDoor.__super__=pokerpg.entities.CWarp;for(k in pokerpg.entities.CWarp.prototype)pokerpg.entities.CDoor.prototype[k]=pokerpg.entities.CWarp.prototype[k];
pokerpg.entities.CDoor.prototype.openStep=null;pokerpg.entities.CDoor.prototype.typeDoor=null;pokerpg.entities.CDoor.prototype.open=function(){this.openStep=1};pokerpg.entities.CDoor.prototype.canWarp=function(a){return pokerpg.entities.CWarp.prototype.canWarp.call(this,a)};
pokerpg.entities.CDoor.prototype.render=function(a){if(this.disable)this.openStep=0;if(this.openStep>30)this.openStep=0;var b=pokerpg.Map.getCurMap(),c=2;switch(this.typeDoor){case "door":c=17;break;case "labdoor":c=9;break;case "slidedoor":c=11;break;case "housedoor01":c=5}a.drawImage(pokerpg.Game.res.doorSprites.obj,32*(c-1),32*Math.min(Math.floor(this.openStep/4),3),32,32,this.x*b.tilewidth+pokerpg.Renderer.getOffsetX(),this.y*b.tileheight+pokerpg.Renderer.getOffsetY(),32,32);this.openStep>0&&
++this.openStep};pokerpg.entities.CDoor.prototype.__class__=pokerpg.entities.CDoor;Reflect=function(){};Reflect.__name__=["Reflect"];Reflect.hasField=function(a,b){if(a.hasOwnProperty!=null)return a.hasOwnProperty(b);for(var c=Reflect.fields(a).iterator();c.hasNext();)if(c.next()==b)return true;return false};Reflect.field=function(a,b){var c=null;try{c=a[b]}catch(e){}return c};Reflect.setField=function(a,b,c){a[b]=c};Reflect.callMethod=function(a,b,c){return b.apply(a,c)};
Reflect.fields=function(a){if(a==null)return[];var b=[];if(a.hasOwnProperty)for(var c in a)a.hasOwnProperty(c)&&b.push(c);else{var e;try{e=a.__proto__}catch(f){e=null}if(e!=null)a.__proto__=null;for(c in a)c!="__proto__"&&b.push(c);if(e!=null)a.__proto__=e}return b};Reflect.isFunction=function(a){return typeof a=="function"&&a.__name__==null};Reflect.compare=function(a,b){return a==b?0:a>b?1:-1};
Reflect.compareMethods=function(a,b){return a==b?true:!Reflect.isFunction(a)||!Reflect.isFunction(b)?false:a.scope==b.scope&&a.method==b.method&&a.method!=null};Reflect.isObject=function(a){if(a==null)return false;var b=typeof a;return b=="string"||b=="object"&&!a.__enum__||b=="function"&&a.__name__!=null};Reflect.deleteField=function(a,b){if(!Reflect.hasField(a,b))return false;delete a[b];return true};
Reflect.copy=function(a){for(var b={},c=0,e=Reflect.fields(a);c<e.length;){var f=e[c];++c;b[f]=Reflect.field(a,f)}return b};Reflect.makeVarArgs=function(a){return function(){for(var b=[],c=0,e=arguments.length;c<e;){var f=c++;b.push(arguments[f])}return a(b)}};Reflect.prototype.__class__=Reflect;
pokerpg.Tileset=function(a){if(a!==$_){var b=this;this.error=this.loaded=false;this.tileproperties=[];this.imagewidth=a.imagewidth;this.imageheight=a.imageheight;this.tilewidth=a.tilewidth;this.tileheight=a.tileheight;this.firstgid=a.firstgid;if(a.image=="../tilesets/data.png")this.loaded=true;else{this.image=new Image;this.image.onload=function(){if(b.onload!=null)b.onload()};this.image.onerror=function(){if(b.onerror!=null)b.onerror()};this.image.src="resources/"+a.image.slice(3)}for(var c=0,e=
Reflect.fields(a.tileproperties);c<e.length;){var f=e[c];++c;a.tileproperties.hasOwnProperty(f)&&(this.tileproperties[f]=a.tileproperties[f])}e=0;for(c=Math.floor(this.imagewidth/this.tilewidth*(this.imageheight/this.tileheight));e<c;){f=e++;this.tileproperties[f]||(this.tileproperties[f]={})}}};pokerpg.Tileset.__name__=["pokerpg","Tileset"];pokerpg.Tileset.getTilesetOfTile=function(a,b){for(var c=a.tilesets,e=c.length,f=null;e-- >0;)if(b>=c[e].firstgid){f=c[e];break}return f};
pokerpg.Tileset.prototype.loaded=null;pokerpg.Tileset.prototype.error=null;pokerpg.Tileset.prototype.onload=null;pokerpg.Tileset.prototype.onerror=null;pokerpg.Tileset.prototype.image=null;pokerpg.Tileset.prototype.firstgid=null;pokerpg.Tileset.prototype.imagewidth=null;pokerpg.Tileset.prototype.imageheight=null;pokerpg.Tileset.prototype.tilewidth=null;pokerpg.Tileset.prototype.tileheight=null;pokerpg.Tileset.prototype.tileproperties=null;pokerpg.Tileset.prototype.__class__=pokerpg.Tileset;
pokerpg.ImageResource=function(a,b,c){if(a!==$_){this.error=this.loaded=false;this.loadHooks=[];this.errorHooks=[];b!=null&&this.loadHooks.push(b);c!=null&&this.errorHooks.push(c);this.obj=new Image;this.obj.onload=$closure(this,"onLoad");this.obj.src=a}};pokerpg.ImageResource.__name__=["pokerpg","ImageResource"];pokerpg.ImageResource.prototype.obj=null;pokerpg.ImageResource.prototype.loaded=null;pokerpg.ImageResource.prototype.error=null;pokerpg.ImageResource.prototype.loadHooks=null;
pokerpg.ImageResource.prototype.errorHooks=null;pokerpg.ImageResource.prototype.addLoadHook=function(a){a!=null&&(this.loaded?setTimeout(a,0):this.loadHooks.push(a))};pokerpg.ImageResource.prototype.addErrorHook=function(a){a!=null&&(this.error?setTimeout(a,0):this.errorHooks.push(a))};pokerpg.ImageResource.prototype.onLoad=function(){this.loaded=true;for(var a=0,b=this.loadHooks.length;a<b;)this.loadHooks[a++]();this.loadHooks=null};
pokerpg.ImageResource.prototype.onError=function(){this.error=true;for(var a=0,b=this.errorHooks.length;a<b;)this.errorHooks[a++]();this.errorHooks=null};pokerpg.ImageResource.prototype.__class__=pokerpg.ImageResource;pokerpg.Connection=function(){};pokerpg.Connection.__name__=["pokerpg","Connection"];pokerpg.Connection.socket=null;
pokerpg.Connection.setup=function(){pokerpg.Connection.socket=io.connect("http://pkpadv.zapto.org:2828");pokerpg.Connection.socket.on("connect",pokerpg.Connection.onConnect);pokerpg.Connection.socket.on("disconnect",pokerpg.Connection.onDisconnect);pokerpg.Connection.socket.on("setInfo",pokerpg.Connection.onSetInfo);pokerpg.Connection.socket.on("loadMap",pokerpg.Connection.onLoadMap);pokerpg.Connection.socket.on("invalidMove",pokerpg.Connection.onInvalidMove);pokerpg.Connection.socket.on("update",
pokerpg.Connection.onUpdate);pokerpg.Connection.socket.on("battleInit",pokerpg.Connection.onBattleInit);pokerpg.Connection.socket.on("battleWild",pokerpg.Connection.onBattleWild);pokerpg.Connection.socket.on("battleTurn",pokerpg.Connection.onBattleTurn);pokerpg.Connection.socket.on("loginFail",pokerpg.Connection.onLoginFail);pokerpg.Connection.socket.on("newGame",pokerpg.Connection.onNewGame);pokerpg.Connection.socket.on("startGame",pokerpg.Connection.onStartGame);pokerpg.Connection.socket.on("requestPvpBattle",
pokerpg.Connection.requestPvpBattle);pokerpg.Connection.socket.on("requestPvpBattleConfirm",pokerpg.Connection.requestPvpBattleConfirm)};pokerpg.Connection.onConnect=function(){};pokerpg.Connection.onDisconnect=function(){pokerpg.Game.state=pokerpg.GameState.ST_DISCONNECTED;for(pokerpg.Game.curGame=null;pokerpg.UI.inputs.length>0;)pokerpg.UI.removeInput(pokerpg.UI.inputs[0]);pokerpg.Connection.socket.disconnect()};
pokerpg.Connection.onSetInfo=function(a){pokerpg.Game.setPokemonParty(a.pokemon);pokerpg.Game.accountLevel=a.accountLevel};pokerpg.Connection.onLoadMap=function(a){if(pokerpg.Game.curGame!=null&&pokerpg.Game.curGame.queueLoadMap){pokerpg.Game.curGame.queuedMap=a.mapid;pokerpg.Game.curGame.queuedChars=a.chars}else pokerpg.Game.loadMap(a.mapid,a.chars)};
pokerpg.Connection.onInvalidMove=function(a){pokerpg.Connection.lastAckMove=a.ack;var b=pokerpg.Game.curGame.getPlayerChar();b.x=a.x;b.y=a.y;b.walking=false;b.walkingPerc=0;b.tick();pokerpg.Main.log("Invalid move!");if(b.freezeTicks<5)b.freezeTicks=5};
pokerpg.Connection.onUpdate=function(a){Std.is(a,String)&&(a=JSON.parse(a));if(pokerpg.Game.curGame!=null&&pokerpg.Game.curGame.loaded&&a.map==pokerpg.Game.curGame.map.id){if(a.chars==null)a.chars=[];if(a.messages==null)a.messages=[];if(a.cremoved==null)a.cremoved=[];if(a.warpsUsed==null)a.warpsUsed=[];for(var b=a.cremoved,c=0,e=a.warpsUsed;c<e.length;){var f=e[c];++c;b.remove(f.username);f.username!=pokerpg.Game.username&&function(a){var b=pokerpg.Game.curGame.getCharByUsername(a.username),c=pokerpg.entities.CWarp.getWarpByName(a.warpName);
b.canUpdate=false;var e=function(){b.direction=a.direction;Std.is(c,pokerpg.entities.CDoor)?b.enterDoor(c):Std.is(c,pokerpg.entities.CWarpArrow)?b.enterWarpArrow(c):Std.is(c,pokerpg.entities.CStairs)&&b.enterStairs(c)};if(b.x!=a.x||b.y!=a.y||b.walking){b.targetX=a.x;b.targetY=a.y;b.onTarget=e}else e()}(f)}f=a.chars;e=0;for(c=f.length;e<c;){var g=e++,g=f[g],h=pokerpg.Game.curGame.getCharByUsername(g.username);h!=null?h.update(g):h=new pokerpg.CCharacter(g)}e=0;for(c=b.length;e<c;){g=e++;h=pokerpg.Game.curGame.getCharByUsername(b[g]);
h!=null&&h.destroy()}c=0;for(e=a.messages;c<e.length;){a=e[c];++c;a.timestamp=Date.now().getTime();pokerpg.Chat.pushMessage(a)}}};
pokerpg.Connection.onBattleInit=function(a){pokerpg.Main.log("Received battleInit");var b=pokerpg.Game.curGame.initBattle(new pokerpg.Battle(a)),c=pokerpg.Game.curGame.getPlayerChar();if(c!=null){c.inBattle=true;if(a.type==2)c.isBattlePVP=true;c.battleEnemy=b.enemyPokemon.id;c.battleEnemyShiny=b.enemyPokemon.shiny}a.type==2?pokerpg.Renderer.startTransition(new pokerpg.transitions.BattleTransition001).step=21:pokerpg.Renderer.startTransition(new pokerpg.transitions.BattleTransition001).step=-1};
pokerpg.Connection.onBattleWild=function(){};pokerpg.Connection.onBattleTurn=function(a){pokerpg.Game.curGame.battle.resultQueue=pokerpg.Game.curGame.battle.resultQueue.concat(a.results);pokerpg.Game.curGame.battle.runQueue()};pokerpg.Connection.onLoginFail=function(){pokerpg.TitleScreen.loginFailed()};
pokerpg.Connection.onNewGame=function(a){pokerpg.Game.username=a.username;pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=function(){pokerpg.TitleScreen.destroy();pokerpg.Game.state=pokerpg.GameState.ST_NEWGAME;pokerpg.NewGameScreen.init(a.starters,a.characters)}};
pokerpg.Connection.onStartGame=function(a){pokerpg.Game.username=a.username;pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=function(){pokerpg.TitleScreen.destroy();pokerpg.Game.state=pokerpg.GameState.ST_UNKNOWN;pokerpg.Connection.socket.emit("startGame",{})}};pokerpg.Connection.requestPvpBattle=function(a){pokerpg.Game.curGame.getPlayerChar().setSpeechText("New request PvP Battle from "+a.requestUsername+". Type /accpvp in chat to accept.",200)};
pokerpg.Connection.requestPvpBattleConfirm=function(){pokerpg.Game.curGame.getPlayerChar().setSpeechText("Request PvP Battle has sent.",200)};pokerpg.Connection.prototype.__class__=pokerpg.Connection;pokerpg.Main=function(){};pokerpg.Main.__name__=["pokerpg","Main"];pokerpg.Main.isPhone=null;pokerpg.Main.screenWidth=null;pokerpg.Main.screenHeight=null;pokerpg.Main.onScreenCanvas=null;pokerpg.Main.onScreenCtx=null;pokerpg.Main.tmpCanvas=null;pokerpg.Main.tmpCtx=null;pokerpg.Main.mapCacheCanvas=null;
pokerpg.Main.mapCacheCtx=null;pokerpg.Main.canvas=null;pokerpg.Main.ctx=null;pokerpg.Main.container=null;pokerpg.Main.menuContainer=null;
pokerpg.Main.main=function(){Array.prototype.remove=function(a){var b=0;if((b=this.indexOf(a))!=-1){this.splice(b,1);return true}return false};Array.prototype.removeLast=function(a){var b=0;if((b=this.lastIndexOf(a))!=-1){this.splice(b,1);return true}return false};pokerpg.Main.isPhone=(new EReg("(iPhone|iPod)","i")).match(js.Lib.window.navigator.userAgent);pokerpg.Main.screenWidth=pokerpg.Main.isPhone?480:800;pokerpg.Main.screenHeight=pokerpg.Main.isPhone?320:600;js.Lib.window.initGame=pokerpg.Main.initGame};
pokerpg.Main.tick=function(){pokerpg.UI.tick();pokerpg.Game.state==pokerpg.GameState.ST_MAP&&pokerpg.Game.curGame!=null&&pokerpg.Game.curGame.tick();pokerpg.Renderer.render()};pokerpg.Main.log=function(a){console.log(a)};
pokerpg.Main.initGame=function(a,b){pokerpg.Main.container=b;pokerpg.Main.onScreenCanvas=a;pokerpg.Main.onScreenCtx=pokerpg.Main.onScreenCanvas.getContext("2d");pokerpg.Main.canvas=js.Lib.document.createElement("canvas");pokerpg.Main.ctx=pokerpg.Main.canvas.getContext("2d");pokerpg.Main.tmpCanvas=js.Lib.document.createElement("canvas");pokerpg.Main.tmpCtx=pokerpg.Main.tmpCanvas.getContext("2d");pokerpg.Main.mapCacheCanvas=js.Lib.document.createElement("canvas");pokerpg.Main.mapCacheCtx=pokerpg.Main.mapCacheCanvas.getContext("2d");
pokerpg.Main.menuContainer=js.Lib.document.getElementById("menuContainer");pokerpg.Main.menuContainer.style.display="none";pokerpg.Main.menuContainer.style.position="absolute";pokerpg.Main.menuContainer.style.padding="10px";pokerpg.Main.menuContainer.style.backgroundColor="#ddd";pokerpg.Main.menuContainer.style.border="1px solid #000";pokerpg.Main.jq(window).mousemove(function(a){var b=pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).offset();pokerpg.UI.mouseX=a.pageX-b.left;pokerpg.UI.mouseY=a.pageY-
b.top});pokerpg.Main.jq(window).resize(function(){if(pokerpg.Main.isPhone){pokerpg.Main.canvas.width=pokerpg.Main.jq(window).width();pokerpg.Main.canvas.height=pokerpg.Main.jq(window).height()}else{pokerpg.Main.canvas.width=800;pokerpg.Main.canvas.height=600;pokerpg.Main.container.style.top="50%";pokerpg.Main.container.style.left="50%";pokerpg.Main.container.style.position="fixed";pokerpg.Main.container.style.marginTop="-300px";pokerpg.Main.container.style.marginLeft="-400px"}pokerpg.Main.container.width=
pokerpg.Main.mapCacheCanvas.width=pokerpg.Main.tmpCanvas.width=pokerpg.Main.onScreenCanvas.width=pokerpg.Main.canvas.width;pokerpg.Main.container.height=pokerpg.Main.mapCacheCanvas.height=pokerpg.Main.tmpCanvas.height=pokerpg.Main.onScreenCanvas.height=pokerpg.Main.canvas.height;if(pokerpg.Game.curGame!=null&&pokerpg.Map.getCurMap()!=null)pokerpg.Map.getCurMap().cacheMap=null;pokerpg.Renderer.render()}).resize();pokerpg.Main.jq(window).bind("orientationchange",function(){window.scrollTo(0,0)});pokerpg.Main.jq("#controls").hide();
pokerpg.UI.setup();pokerpg.Game.setup();pokerpg.Connection.setup();pokerpg.Renderer.setup();pokerpg.Chat.setup();pokerpg.Game.state=pokerpg.GameState.ST_TITLE;pokerpg.TitleScreen.setup();pokerpg.TitleScreen.init();setInterval(pokerpg.Main.tick,1E3/30)};pokerpg.Main.printDebug=function(){var a=js.Lib.window.open("","Debug Info");a.document.body.innerHTML="";a.document.write(JSON.stringify({version:{major:0,minor:1,build:1}}))};
pokerpg.Main.resolveObject=function(a,b){for(var c=b.split(".");c.length>0;)a=a[c.shift()];return a};pokerpg.Main.setTimeout=function(a,b){setTimeout(a,b)};pokerpg.Main.setInterval=function(a,b){setInterval(a,b)};pokerpg.Main.clearTmpCanvas=function(){pokerpg.Main.tmpCtx.clearRect(0,0,pokerpg.Main.tmpCanvas.width,pokerpg.Main.tmpCanvas.height)};pokerpg.Main.prototype.supportsCanvas=function(){return!!document.createElement("canvas").getContext};pokerpg.Main.prototype.__class__=pokerpg.Main;
pokerpg.entities.CWarpArrow=function(a,b,c){a!==$_&&pokerpg.entities.CWarp.call(this,a,b,c)};pokerpg.entities.CWarpArrow.__name__=["pokerpg","entities","CWarpArrow"];pokerpg.entities.CWarpArrow.__super__=pokerpg.entities.CWarp;for(k in pokerpg.entities.CWarp.prototype)pokerpg.entities.CWarpArrow.prototype[k]=pokerpg.entities.CWarp.prototype[k];
pokerpg.entities.CWarpArrow.prototype.render=function(a){if(!this.disable){var b=pokerpg.Game.curGame.getPlayerChar();if(b!=null&&!(Math.abs(b.x-this.x)+Math.abs(b.y-this.y)>1)){var c;c=b.x<this.x?3:b.x>this.x?1:b.y<this.y?0:2;if(c==b.direction){b=pokerpg.Map.getCurMap();a.save();a.translate(this.x*b.tilewidth+pokerpg.Renderer.getOffsetX()+16,this.y*b.tileheight+pokerpg.Renderer.getOffsetY()+16);a.rotate(Math.PI/2*c);pokerpg.Renderer.numRTicks%30<15&&a.translate(0,4);a.drawImage(pokerpg.Game.res.miscSprites.obj,
0,32,32,32,-16,-16,32,32);a.restore()}}}};pokerpg.entities.CWarpArrow.prototype.__class__=pokerpg.entities.CWarpArrow;IntIter=function(a,b){if(a!==$_){this.min=a;this.max=b}};IntIter.__name__=["IntIter"];IntIter.prototype.min=null;IntIter.prototype.max=null;IntIter.prototype.hasNext=function(){return this.min<this.max};IntIter.prototype.next=function(){return this.min++};IntIter.prototype.__class__=IntIter;
pokerpg.entities.CPokemon=function(a,b,c,e,f){if(a!==$_){f==null&&(f=false);e==null&&(e=0);pokerpg.GameObject.call(this,b,c,e);e="";a.length==1?e="00":a.length==2&&(e="0");this.image=a==null?null:pokerpg.Game.curGame.getImage("resources/followers/"+e+a+(f==true?"s":"")+"_0.png");this.idPokemon=a;if(this.idPokemon=="644")this.renderPriority=10;this.canDrawGrass=true;this.walking=false;this.walkingPerc=0;this.canIdleJump=this.jumping=this.walkingHasMoved=false;this.renderOffsetY=this.renderOffsetX=
0;this.shiny=f;this.targetX=b;this.targetY=c}};pokerpg.entities.CPokemon.__name__=["pokerpg","entities","CPokemon"];pokerpg.entities.CPokemon.__super__=pokerpg.GameObject;for(k in pokerpg.GameObject.prototype)pokerpg.entities.CPokemon.prototype[k]=pokerpg.GameObject.prototype[k];pokerpg.entities.CPokemon.prototype.image=null;pokerpg.entities.CPokemon.prototype.shiny=null;pokerpg.entities.CPokemon.prototype.idPokemon=null;pokerpg.entities.CPokemon.prototype.canDrawGrass=null;
pokerpg.entities.CPokemon.prototype.canIdleJump=null;pokerpg.entities.CPokemon.prototype.walking=null;pokerpg.entities.CPokemon.prototype.walkingPerc=null;pokerpg.entities.CPokemon.prototype.walkingHasMoved=null;pokerpg.entities.CPokemon.prototype.jumping=null;pokerpg.entities.CPokemon.prototype.targetX=null;pokerpg.entities.CPokemon.prototype.targetY=null;pokerpg.entities.CPokemon.prototype.renderOffsetX=null;pokerpg.entities.CPokemon.prototype.renderOffsetY=null;
pokerpg.entities.CPokemon.prototype.destroy=function(){pokerpg.GameObject.prototype.destroy.call(this)};
pokerpg.entities.CPokemon.prototype.render=function(a){var b=pokerpg.Renderer.getOffsetX(),c=pokerpg.Renderer.getOffsetY(),e=this.getRenderPosX(),f=this.getRenderPosY(),g=pokerpg.Map.getCurMap();if(this.image!=null&&this.image.loaded){if(this.jumping)a.drawImage(pokerpg.Game.res.miscSprites.obj,0,64,32,32,e+b+16,f+c-this.renderOffsetY+30,32,32);else{a.save();a.globalAlpha=0.25;a.drawImage(pokerpg.Game.res.miscSprites.obj,0,64,32,32,e+b+16,f+c-this.renderOffsetY+30,32,32);a.restore()}var h=0;switch(this.direction){case 0:h=
0;break;case 1:h=1;break;case 2:h=3;break;case 3:h=2;break;default:h=0}if(this.idPokemon=="644"){e=e+b;f=f+c+(this.canIdleJump&&(pokerpg.Renderer.numRTicks+this.randInt)%10<5?-2:0);if(h==2){e=e-80;f=f-48}else if(h==1){e=e+16;f=f-48}else if(h==0){e=e-32;f=f-32}else if(h==3){e=e-32;f=f-16}a.drawImage(this.image.obj,Math.floor((pokerpg.Renderer.numRTicks+this.randInt)%20/5)*128,128*h,128,128,e,f,128,128)}else a.drawImage(this.image.obj,Math.floor((pokerpg.Renderer.numRTicks+this.randInt)%20/5)*64,64*
h,64,64,e+b,f+c+(this.canIdleJump&&(pokerpg.Renderer.numRTicks+this.randInt)%10<5?-2:0),64,64);this.canDrawGrass&&g.hasTileProp(this.x,this.y,"grass")&&!this.walking&&a.drawImage(pokerpg.Game.res.miscSprites.obj,0,0,32,32,this.x*g.tilewidth+b,this.y*g.tileheight+c,32,32)}};
pokerpg.entities.CPokemon.prototype.tick=function(){if(this.walking){this.walkingPerc=this.walkingPerc+0.1;if(this.walkingPerc>=0.35&&!this.walkingHasMoved){var a=this.getFrontPositionX(),b=this.getFrontPositionY();pokerpg.Map.getCurMap().hasTileProp(a,b,"ledge")&&pokerpg.Map.getCurMap().getLedgeDir(a,b)==this.direction&&this.useLedge();switch(this.direction){case 1:this.x=this.x-1;break;case 3:this.x=this.x+1;break;case 2:this.y=this.y-1;break;case 0:this.y=this.y+1}this.walkingHasMoved=true;pokerpg.Map.getCurMap().hasTileProp(this.x,
this.y,"grass")&&new pokerpg.entities.CGrassAnimation(this.x,this.y)}if(this.walkingPerc>=1){this.walkingHasMoved=false;this.walkingPerc=0.4;this.walking=false;this.tickBot()}}else{this.walkingHasMoved=false;this.walkingPerc=0;this.tickBot()}};
pokerpg.entities.CPokemon.prototype.getRenderPosX=function(){var a=pokerpg.Map.getCurMap();if(!this.walking)return Math.floor(this.x*a.tilewidth-16+this.renderOffsetX);var b=this.x*a.tilewidth-16,c=(this.walkingPerc-0.3)/0.7;if(this.walkingPerc>0.3)if(this.walkingHasMoved)switch(this.direction){case 1:b=b+a.tilewidth*(1-c);break;case 3:b=b-a.tilewidth*(1-c)}else switch(this.direction){case 1:b=b-a.tilewidth*c;break;case 3:b=b+a.tilewidth*c}return Math.floor(b+this.renderOffsetX)};
pokerpg.entities.CPokemon.prototype.getRenderPosY=function(){var a=pokerpg.Map.getCurMap();if(!this.walking)return Math.floor(this.y*a.tileheight-32+this.renderOffsetY);var b=this.y*a.tileheight-32,c=(this.walkingPerc-0.3)/0.7;if(this.walkingPerc>0.3)if(this.walkingHasMoved)switch(this.direction){case 2:b=b+a.tileheight*(1-c);break;case 0:b=b-a.tileheight*(1-c)}else switch(this.direction){case 2:b=b-a.tileheight*c;break;case 0:b=b+a.tileheight*c}return Math.floor(b+this.renderOffsetY)};
pokerpg.entities.CPokemon.prototype.useLedge=function(){var a=this;this.getFrontPositionX();this.getFrontPositionY();var b=this.getFrontPositionX(2),c=this.getFrontPositionY(2),e=this.direction;this.jumping=this.walking=true;var f=0,g=null,g=function(){++f;if(a.x!=b||a.y!=c)a.walking=true;a.direction=e;a.renderOffsetY=Math.min(Math.round(8/15*f*f+-8*f),0);f==18&&new pokerpg.entities.CLedgeSmoke(a.x,a.y);if(f>=20){a.renderOffsetY=0;a.walking=false;a.walkingPerc=0;a.walkingHasMoved=false;a.jumping=
false;a.x=b;a.y=c;pokerpg.Renderer.unHookRender(g)}};pokerpg.Renderer.hookRender(g)};pokerpg.entities.CPokemon.prototype.getFrontPositionX=function(a){a==null&&(a=1);switch(this.direction){case 1:return this.x-a;case 3:return this.x+a;case 2:return this.x;case 0:return this.x}return null};pokerpg.entities.CPokemon.prototype.getFrontPositionY=function(a){a==null&&(a=1);switch(this.direction){case 1:return this.y;case 3:return this.y;case 2:return this.y-a;case 0:return this.y+a}return null};
pokerpg.entities.CPokemon.prototype.tickBot=function(){if(!this.jumping&&!this.walking)if(Math.abs(this.x-this.targetX)+Math.abs(this.y-this.targetY)>3){this.x=this.targetX;this.y=this.targetY}else if(this.walking=this.x!=this.targetX||this.y!=this.targetY){var a=this.direction;this.direction=Math.abs(this.x-this.targetX)>0&&this.y==this.targetY?this.x<this.targetX?3:1:Math.abs(this.y-this.targetY)>0&&this.x==this.targetX?this.y<this.targetY?0:2:this.targetY<this.y?2:0;if(a!=this.direction)this.walkingPerc=
0.2}};pokerpg.entities.CPokemon.prototype.__class__=pokerpg.entities.CPokemon;pokerpg.entities.CFollower=function(a){if(a!==$_){pokerpg.entities.CPokemon.call(this,a.follower,a.lastX,a.lastY,0,a.followerShiny);this.chr=a;this.forceTarget=false;this.createdTick=pokerpg.Renderer.numRTicks;this.renderPriority=10;this.canIdleJump=true}};pokerpg.entities.CFollower.__name__=["pokerpg","entities","CFollower"];pokerpg.entities.CFollower.__super__=pokerpg.entities.CPokemon;
for(k in pokerpg.entities.CPokemon.prototype)pokerpg.entities.CFollower.prototype[k]=pokerpg.entities.CPokemon.prototype[k];pokerpg.entities.CFollower.prototype.chr=null;pokerpg.entities.CFollower.prototype.forceTarget=null;pokerpg.entities.CFollower.prototype.createdTick=null;pokerpg.entities.CFollower.prototype.lastFollower=null;
pokerpg.entities.CFollower.prototype.render=function(a){if(this.chr.follower!=null){if(this.lastFollower!=this.chr.follower){var b="";this.chr.follower.length==1?b="00":this.chr.follower.length==2&&(b="0");this.image=pokerpg.Game.curGame.getImage("resources/followers/"+b+this.chr.follower+(this.chr.followerShiny?"s":"")+"_0.png")}}else if(this.image!=null)this.image=null;this.shiny=this.chr.followerShiny;this.lastFollower=this.chr.follower;if((this.chr.username!=pokerpg.Game.username||pokerpg.Game.curGame.drawPlayerFollower)&&
!(this.x==this.chr.x&&this.y==this.chr.y&&!this.walking&&!this.chr.walking)){a.save();if(pokerpg.Renderer.numRTicks-this.createdTick<10)a.globalAlpha=(pokerpg.Renderer.numRTicks-this.createdTick)/10;pokerpg.entities.CPokemon.prototype.render.call(this,a);a.restore()}};
pokerpg.entities.CFollower.prototype.tick=function(){this.targetX=this.chr.lastX;this.targetY=this.chr.lastY;if(!this.forceTarget&&this.chr.walking&&!this.chr.walkingHasMoved&&this.chr.walkingPerc>=0.3&&!this.chr.willMoveIntoAWall()){this.targetX=this.chr.x;this.targetY=this.chr.y}pokerpg.entities.CPokemon.prototype.tick.call(this);if(!this.walking)this.direction=this.x<this.chr.x?3:this.x>this.chr.x?1:this.y>this.chr.y?2:0};pokerpg.entities.CFollower.prototype.__class__=pokerpg.entities.CFollower;
pokerpg.entities.CLedgeSmoke=function(a,b){if(a!==$_){pokerpg.GameObject.call(this,a,b);this.step=0;this.renderPriority=-100}};pokerpg.entities.CLedgeSmoke.__name__=["pokerpg","entities","CLedgeSmoke"];pokerpg.entities.CLedgeSmoke.__super__=pokerpg.GameObject;for(k in pokerpg.GameObject.prototype)pokerpg.entities.CLedgeSmoke.prototype[k]=pokerpg.GameObject.prototype[k];pokerpg.entities.CLedgeSmoke.prototype.step=null;
pokerpg.entities.CLedgeSmoke.prototype.render=function(a){var b=pokerpg.Map.getCurMap();a.drawImage(pokerpg.Game.res.miscSprites.obj,96,Math.floor(this.step/3)*32,32,32,this.x*b.tilewidth+pokerpg.Renderer.getOffsetX(),this.y*b.tileheight+pokerpg.Renderer.getOffsetY(),32,32);++this.step;this.step>=9&&this.destroy()};pokerpg.entities.CLedgeSmoke.prototype.__class__=pokerpg.entities.CLedgeSmoke;"undefined"==typeof js&&(js={});js.Boot=function(){};js.Boot.__name__=["js","Boot"];js.Boot.__unhtml=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")};
js.Boot.__trace=function(a,b){var c=b!=null?b.fileName+":"+b.lineNumber+": ":"",c=c+(js.Boot.__unhtml(js.Boot.__string_rec(a,""))+"<br/>"),e=document.getElementById("haxe:trace");e==null?alert("No haxe:trace element defined\n"+c):e.innerHTML=e.innerHTML+c};js.Boot.__clear_trace=function(){var a=document.getElementById("haxe:trace");if(a!=null)a.innerHTML=""};js.Boot.__closure=function(a,b){var c=a[b];if(c==null)return null;var e=function(){return c.apply(a,arguments)};e.scope=a;e.method=c;return e};
js.Boot.__string_rec=function(a,b){if(a==null)return"null";if(b.length>=5)return"<...>";var c=typeof a;if(c=="function"&&(a.__name__!=null||a.__ename__!=null))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__!=null){if(a.length==2)return a[0];for(var c=a[0]+"(",b=b+"\t",e=2,f=a.length;e<f;)var g=e++,c=g!=2?c+(","+js.Boot.__string_rec(a[g],b)):c+js.Boot.__string_rec(a[g],b);return c+")"}e=a.length;c="[";b=b+"\t";for(f=0;f<e;){g=f++;c=c+((g>0?",":"")+js.Boot.__string_rec(a[g],
b))}return c+"]"}try{f=a.toString}catch(h){return"???"}if(f!=null&&f!=Object.toString){c=a.toString();if(c!="[object Object]")return c}f=null;c="{\n";b=b+"\t";e=a.hasOwnProperty!=null;for(f in a)if(!e||a.hasOwnProperty(f))if(!(f=="prototype"||f=="__class__"||f=="__super__"||f=="__interfaces__")){c.length!=2&&(c=c+", \n");c=c+(b+f+" : "+js.Boot.__string_rec(a[f],b))}b=b.substring(1);return c+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};
js.Boot.__interfLoop=function(a,b){if(a==null)return false;if(a==b)return true;var c=a.__interfaces__;if(c!=null)for(var e=0,f=c.length;e<f;){var g=e++,g=c[g];if(g==b||js.Boot.__interfLoop(g,b))return true}return js.Boot.__interfLoop(a.__super__,b)};
js.Boot.__instanceof=function(a,b){try{if(a instanceof b)return b==Array?a.__enum__==null:true;if(js.Boot.__interfLoop(a.__class__,b))return true}catch(c){if(b==null)return false}switch(b){case Int:return Math.ceil(a%2147483648)===a;case Float:return typeof a=="number";case Bool:return a===true||a===false;case String:return typeof a=="string";case Dynamic:return true;default:return a==null?false:a.__enum__==b||b==Class&&a.__name__!=null||b==Enum&&a.__ename__!=null}};
js.Boot.__init=function(){js.Lib.isIE=typeof document!="undefined"&&document.all!=null&&typeof window!="undefined"&&window.opera==null;js.Lib.isOpera=typeof window!="undefined"&&window.opera!=null;Array.prototype.copy=Array.prototype.slice;Array.prototype.insert=function(a,c){this.splice(a,0,c)};Array.prototype.remove=Array.prototype.indexOf?function(a){a=this.indexOf(a);if(a==-1)return false;this.splice(a,1);return true}:function(a){for(var c=0,e=this.length;c<e;){if(this[c]==a){this.splice(c,1);
return true}c++}return false};Array.prototype.iterator=function(){return{cur:0,arr:this,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};if(String.prototype.cca==null)String.prototype.cca=String.prototype.charCodeAt;String.prototype.charCodeAt=function(a){a=this.cca(a);return a!=a?null:a};var a=String.prototype.substr;String.prototype.substr=function(b,c){if(b!=null&&b!=0&&c!=null&&c<0)return"";if(c==null)c=this.length;if(b<0){b=this.length+b;b<0&&
(b=0)}else c<0&&(c=this.length+c-b);return a.apply(this,[b,c])};$closure=js.Boot.__closure};js.Boot.prototype.__class__=js.Boot;pokerpg.Chat=function(){};pokerpg.Chat.__name__=["pokerpg","Chat"];pokerpg.Chat.chatBox=null;
pokerpg.Chat.setup=function(){pokerpg.Chat.chatBox=document.createElement("input");pokerpg.Chat.chatBox.type="text";pokerpg.Chat.chatBox.style.opacity="0";pokerpg.Chat.chatBox.style.position="fixed";pokerpg.Chat.chatBox.maxLength=128;pokerpg.Chat.chatLog=[];pokerpg.Chat.chatBox.onblur=function(){pokerpg.Chat.inChat=false;for(var a=Date.now().getTime(),b=Math.max(pokerpg.Chat.chatLog.length-12,0),c=pokerpg.Chat.chatLog.length;b<c;){var e=b++;pokerpg.Chat.chatLog[e].timestamp2=Math.max(a-6E3,pokerpg.Chat.chatLog[e].timestamp2)}};
pokerpg.Chat.chatBox.onkeydown=function(a){a=window.event||a;a.keyCode==13&&pokerpg.Chat.sendMessage()};document.body.appendChild(pokerpg.Chat.chatBox)};pokerpg.Chat.resetChat=function(){pokerpg.Chat.chatBox.value="";pokerpg.Chat.inChat=false;pokerpg.Chat.justSentMessage=true;pokerpg.Main.jq(pokerpg.Chat.chatBox).blur()};
pokerpg.Chat.pushMessage=function(a){var b=pokerpg.Game.curGame.getPlayerChar();a.timestamp2=a.timestamp;if(!(b!=null&&(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.x-b.y)>2025)){pokerpg.Chat.chatLog.length>64&&pokerpg.Chat.chatLog.shift();a.bubbleLines=[];var c=pokerpg.Main.ctx;c.font="12px Font2";b=Math.round(c.measureText(a.str).width+10);a.bubbleLines=pokerpg.Util.reduceTextSize(a.str,140,c);if(a.bubbleLines.length>1){for(var e=b=0,f=a.bubbleLines;e<f.length;){var g=f[e];++e;b=Math.ceil(Math.max(b,c.measureText(g).width))}b=
b+10}c=a.bubbleLines.length*14+2;a.bubbleWidth=b;a.bubbleHeight=c;pokerpg.Chat.chatLog.push(a)}};
pokerpg.Chat.sendMessage=function(){var a=pokerpg.Chat.chatBox.value;if(a.indexOf("/kick ")==0&&pokerpg.Game.accountLevel>=30){pokerpg.Connection.socket.emit("kickPlayer",{username:a.substr(6)});pokerpg.Chat.resetChat();pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus()}else if(a.indexOf("/setpokemon ")==0&&pokerpg.Game.accountLevel>=70){pokerpg.Connection.socket.emit("adminSetPokemon",{id:a.substr(12)});pokerpg.Chat.resetChat();pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus()}else if(a.indexOf("/setlevel ")==
0&&pokerpg.Game.accountLevel>=70){pokerpg.Connection.socket.emit("adminSetLevel",{level:a.substr(10)});pokerpg.Chat.resetChat();pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus()}else if(a.indexOf("/addpokemon ")==0&&pokerpg.Game.accountLevel>=70){pokerpg.Connection.socket.emit("adminAddPokemon",{id:a.substr(12)});pokerpg.Chat.resetChat();pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus()}else if(a.indexOf("/unstuck")==0&&!pokerpg.Game.curGame.inBattle)pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=
function(){pokerpg.Connection.socket.emit("unstuck",{username:pokerpg.Game.username});pokerpg.Chat.resetChat();pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus();pokerpg.Renderer.startTransition(new pokerpg.transitions.BlackScreen(5)).onComplete=function(){pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeIn(10))}};else{if(a.indexOf("/pvp ")==0&&!pokerpg.Game.curGame.inBattle){pokerpg.Connection.socket.emit("requestPvpBattle",{username:a.substr(5)});pokerpg.Chat.resetChat()}else if(a.indexOf("/accpvp")==
0&&!pokerpg.Game.curGame.inBattle){pokerpg.Connection.socket.emit("requestPvpBattleAccept",{});pokerpg.Chat.resetChat()}else{pokerpg.Chat.resetChat();pokerpg.Chat.filterChatText();pokerpg.Connection.socket.emit("sendMessage",{str:a})}pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus()}};
pokerpg.Chat.render=function(a){pokerpg.Chat.inChat&&pokerpg.Chat.chatBox.value.length>0&&pokerpg.Chat.filterChatText();a.font="12px Font2";if(pokerpg.Chat.inChat){a.globalAlpha=0.5;a.drawImage(pokerpg.Game.res.uiChat.obj,20,380)}a.globalAlpha=1;a.fillStyle="rgb(0, 0, 0)";for(var b=pokerpg.Chat.chatBox.value;;){var c=a.measureText(b).width;if(c<440){a.fillText(b,28,573);pokerpg.Chat.inChat&&Date.now().getTime()%1E3<500&&a.fillRect(30+c,564,1,10);break}else b=b.substr(1)}for(var b=Date.now().getTime(),
c=Math.max(pokerpg.Chat.chatLog.length-12,0),e=pokerpg.Chat.chatLog.length;c<e;){var f=c++;if(!pokerpg.Chat.inChat)a.globalAlpha=pokerpg.Util.clamp(5-(b-pokerpg.Chat.chatLog[f].timestamp2)/1E3+2,0,1);var g;if(!pokerpg.Chat.inChat){a.fillStyle="rgba(0, 0, 0, 0.5)";a.fillRect(26,549-14*(pokerpg.Chat.chatLog.length-f),a.measureText(pokerpg.Chat.chatLog[f].username+": "+pokerpg.Chat.chatLog[f].str).width+6,14)}g=pokerpg.Chat.chatLog[f].username+": ";a.fillStyle="rgb(0, 0, 0)";a.fillText(g,31,561-14*(pokerpg.Chat.chatLog.length-
f));a.fillStyle="rgb(255, 255, 0)";a.fillText(g,30,560-14*(pokerpg.Chat.chatLog.length-f));var h=a.measureText(g).width;g=pokerpg.Chat.chatLog[f].str;a.fillStyle="rgb(0, 0, 0)";a.fillText(g,31+h,561-14*(pokerpg.Chat.chatLog.length-f));a.fillStyle="rgb(255, 255, 255)";a.fillText(g,30+h,560-14*(pokerpg.Chat.chatLog.length-f))}a.globalAlpha=1};
pokerpg.Chat.renderBubbles=function(a){for(var b=Date.now().getTime(),c=pokerpg.Renderer.getOffsetX(),e=pokerpg.Renderer.getOffsetY(),f=pokerpg.Main.tmpCanvas,g=pokerpg.Main.tmpCtx,h=0,j=pokerpg.Chat.chatLog;h<j.length;){var i=j[h];++h;var l=2500*(i.str.length/70+1);if(!(b-i.timestamp>=l)){if(i.chr==null)i.chr=pokerpg.Game.curGame.getCharByUsername(i.username);if(i.chr!=null){var o=pokerpg.Util.clamp((l-(b-i.timestamp))/1E3,0,0.7),p,q=i.bubbleWidth,m=i.bubbleHeight,l=i.chr.getRenderPosX()+c+Math.floor(16);
p=i.chr.getRenderPosY()+e;l=l-Math.floor(q/2);p=p-m;p=p-Math.floor((b-i.timestamp)/300);pokerpg.Util.drawRoundedRect(l,p,q,m,10,"#FFFFFF",o);g.clearRect(0,0,q,m);g.save();g.lineJoin="round";g.lineWidth=10;g.fillStyle=g.strokeStyle="#FFFFFF";g.strokeRect(5,5,q-10,m-10);g.fillRect(5,5,q-10,m-10);g.restore();a.save();a.globalAlpha=o;a.drawImage(f,0,0,q,m,l,p,q,m);a.fillStyle="#000000";o=0;for(q=i.bubbleLines.length;o<q;){m=o++;a.fillText(i.bubbleLines[m],l+5,p+12+14*m)}a.restore()}}}};
pokerpg.Chat.chatFilterRegex=null;pokerpg.Chat.filterChatText=function(){if(pokerpg.Chat.chatFilterRegex==null)pokerpg.Chat.chatFilterRegex=new EReg("[^\\u0020-\\u007F\\u0080-\\u00FF]","");pokerpg.Chat.chatBox.value=pokerpg.Chat.chatFilterRegex.replace(pokerpg.Chat.chatBox.value,"")};pokerpg.Chat.prototype.__class__=pokerpg.Chat;
pokerpg.Layer=function(a){if(a!==$_){this.data=a.data;this.width=a.width;this.height=a.height;this.x=a.x;this.y=a.y;this.type=a.type;this.properties=a.properties;this.objects=a.objects;if(this.properties==null)this.properties={solid:"1",overchars:"0",animated:"0",data_layer:"0"}}};pokerpg.Layer.__name__=["pokerpg","Layer"];pokerpg.Layer.prototype.data=null;pokerpg.Layer.prototype.width=null;pokerpg.Layer.prototype.height=null;pokerpg.Layer.prototype.x=null;pokerpg.Layer.prototype.y=null;
pokerpg.Layer.prototype.type=null;pokerpg.Layer.prototype.properties=null;pokerpg.Layer.prototype.objects=null;
pokerpg.Layer.prototype.render=function(a){if(this.type=="tilelayer"){var b=0;if(this.x!=0||this.y!=0)throw"Assertion failed";for(var c=pokerpg.Game.curGame.map,e=Math.floor(Math.max(Math.floor(pokerpg.Renderer.cameraX),this.x)),f=Math.floor(Math.max(Math.floor(pokerpg.Renderer.cameraY),this.y)),g=pokerpg.Renderer.getOffsetX(),h=pokerpg.Renderer.getOffsetY(),j=Math.floor(Math.min(e+Math.ceil(pokerpg.Main.screenWidth/c.tilewidth)+1,this.width)),i=Math.floor(Math.min(f+Math.ceil(pokerpg.Main.screenHeight/
c.tileheight)+1,this.height)),b=b+f*this.width;f<i;)for(var l=f++,b=b+e,o=e,p=this.width;o<p;){var q=o++;if(q>=j){b=b+(this.width-j);break}var m=this.data[b];if(!(m==0||m==null)){var n=pokerpg.Tileset.getTilesetOfTile(c,m);if(n==null)throw"Tileset is null";m=m-n.firstgid;if(n.tileproperties[m]!=null&&n.tileproperties[m].animated!=null){var r=Number(n.tileproperties[m].animated),s=Number(n.tileproperties[m].numFrames),m=Number(n.tileproperties[m].animDelay);Math.isNaN(m)&&(m=0);a.drawImage(pokerpg.Game.res.animatedTileset.obj,
n.tilewidth*Math.floor((pokerpg.Renderer.numRTicks+m)/8%s),r*n.tileheight,n.tilewidth,n.tileheight,(q+this.x)*n.tilewidth+g,(l+this.y)*n.tileheight+h,n.tilewidth,n.tileheight)}else{r=Math.floor(n.imagewidth/n.tilewidth);a.drawImage(n.image,m%r*n.tilewidth,Math.floor(m/r)*n.tileheight,n.tilewidth,n.tileheight,(q+this.x)*n.tilewidth+g,(l+this.y)*n.tileheight+h,n.tilewidth,n.tileheight)}}++b}}};pokerpg.Layer.prototype.__class__=pokerpg.Layer;
pokerpg.ui.TextInput=function(a,b,c){if(a!==$_){pokerpg.ui.UIInput.call(this,a,b);this.width=c;this.height=18;this.isPassword=this.selected=false;this.value="";this.maxLength=0}};pokerpg.ui.TextInput.__name__=["pokerpg","ui","TextInput"];pokerpg.ui.TextInput.__super__=pokerpg.ui.UIInput;for(k in pokerpg.ui.UIInput.prototype)pokerpg.ui.TextInput.prototype[k]=pokerpg.ui.UIInput.prototype[k];pokerpg.ui.TextInput.prototype.width=null;pokerpg.ui.TextInput.prototype.height=null;
pokerpg.ui.TextInput.prototype.value=null;pokerpg.ui.TextInput.prototype.isPassword=null;pokerpg.ui.TextInput.prototype.maxLength=null;pokerpg.ui.TextInput.prototype.select=function(){if(!this.selected){pokerpg.ui.UIInput.prototype.select.call(this);pokerpg.UI.hiddenInput.value=this.value;pokerpg.Main.jq(pokerpg.UI.hiddenInput).focus()}};
pokerpg.ui.TextInput.prototype.blur=function(){if(this.selected){pokerpg.ui.UIInput.prototype.blur.call(this);pokerpg.UI.hiddenInput.value="";pokerpg.Main.jq(pokerpg.UI.hiddenInput).blur();pokerpg.Main.jq(pokerpg.Main.onScreenCanvas).focus()}};pokerpg.ui.TextInput.prototype.tick=function(){if(this.disabled)pokerpg.UI.hiddenInput.value=this.value;else if(this.selected)this.value=pokerpg.UI.hiddenInput.value};
pokerpg.ui.TextInput.prototype.isUnderMouse=function(){return pokerpg.UI.mouseX>=this.x&&pokerpg.UI.mouseY>=this.y&&pokerpg.UI.mouseX<this.x+this.width&&pokerpg.UI.mouseY<this.y+this.height};
pokerpg.ui.TextInput.prototype.render=function(a){var b=Date.now().getTime();if(this.isUnderMouse())pokerpg.Main.onScreenCanvas.style.cursor="text";if(this.maxLength>0&&this.value.length>this.maxLength){this.value=this.value.substr(0,this.maxLength);pokerpg.UI.hiddenInput.value=this.value}a.font="12px Dosis";a.fillStyle="#000000";var c=this.value;this.isPassword&&(c=(new EReg(".","g")).replace(c,"*"));var e=0;if(c.length>0){for(;;){e=Math.ceil(a.measureText(c).width);if(e<this.width-8)break;else c=
c.substr(1)}a.fillText(c,this.x+5,this.y+14)}this.selected&&(b-this.selectedTime)%1E3<500&&a.fillRect(this.x+6+e,this.y+2,1,14)};pokerpg.ui.TextInput.prototype.__class__=pokerpg.ui.TextInput;StringBuf=function(a){if(a!==$_)this.b=[]};StringBuf.__name__=["StringBuf"];StringBuf.prototype.add=function(a){this.b[this.b.length]=a==null?"null":a};StringBuf.prototype.addSub=function(a,b,c){this.b[this.b.length]=a.substr(b,c)};StringBuf.prototype.addChar=function(a){this.b[this.b.length]=String.fromCharCode(a)};
StringBuf.prototype.toString=function(){return this.b.join("")};StringBuf.prototype.b=null;StringBuf.prototype.__class__=StringBuf;Lambda=function(){};Lambda.__name__=["Lambda"];Lambda.array=function(a){for(var b=[],a=a.iterator();a.hasNext();){var c=a.next();b.push(c)}return b};Lambda.list=function(a){for(var b=new List,a=a.iterator();a.hasNext();){var c=a.next();b.add(c)}return b};Lambda.map=function(a,b){for(var c=new List,e=a.iterator();e.hasNext();){var f=e.next();c.add(b(f))}return c};
Lambda.mapi=function(a,b){for(var c=new List,e=0,f=a.iterator();f.hasNext();){var g=f.next();c.add(b(e++,g))}return c};Lambda.has=function(a,b,c){if(c==null)for(c=a.iterator();c.hasNext();){a=c.next();if(a==b)return true}else for(var e=a.iterator();e.hasNext();){a=e.next();if(c(a,b))return true}return false};Lambda.exists=function(a,b){for(var c=a.iterator();c.hasNext();){var e=c.next();if(b(e))return true}return false};
Lambda.foreach=function(a,b){for(var c=a.iterator();c.hasNext();){var e=c.next();if(!b(e))return false}return true};Lambda.iter=function(a,b){for(var c=a.iterator();c.hasNext();){var e=c.next();b(e)}};Lambda.filter=function(a,b){for(var c=new List,e=a.iterator();e.hasNext();){var f=e.next();b(f)&&c.add(f)}return c};Lambda.fold=function(a,b,c){for(a=a.iterator();a.hasNext();)var e=a.next(),c=b(e,c);return c};
Lambda.count=function(a,b){var c=0;if(b==null)for(var e=a.iterator();e.hasNext();){e.next();c++}else for(e=a.iterator();e.hasNext();){var f=e.next();b(f)&&c++}return c};Lambda.empty=function(a){return!a.iterator().hasNext()};Lambda.indexOf=function(a,b){for(var c=0,e=a.iterator();e.hasNext();){var f=e.next();if(b==f)return c;c++}return-1};Lambda.concat=function(a,b){for(var c=new List,e=a.iterator();e.hasNext();){var f=e.next();c.add(f)}for(e=b.iterator();e.hasNext();){f=e.next();c.add(f)}return c};
Lambda.prototype.__class__=Lambda;pokerpg.transitions.FadeIn=function(a){if(a!==$_){pokerpg.Transition.call(this);this.fadeTime=a}};pokerpg.transitions.FadeIn.__name__=["pokerpg","transitions","FadeIn"];pokerpg.transitions.FadeIn.__super__=pokerpg.Transition;for(k in pokerpg.Transition.prototype)pokerpg.transitions.FadeIn.prototype[k]=pokerpg.Transition.prototype[k];pokerpg.transitions.FadeIn.prototype.fadeTime=null;
pokerpg.transitions.FadeIn.prototype.render=function(a){a.fillStyle="rgba(0,0,0,"+pokerpg.Util.clamp(1-this.step/this.fadeTime,0,1)+")";a.fillRect(0,0,a.canvas.width,a.canvas.height);++this.step;this.step>=this.fadeTime&&this.complete()};pokerpg.transitions.FadeIn.prototype.__class__=pokerpg.transitions.FadeIn;pokerpg.Util=function(){};pokerpg.Util.__name__=["pokerpg","Util"];pokerpg.Util.randInt=function(a,b){return a+Math.floor((b-a+1)*Math.random())};
pokerpg.Util.clamp=function(a,b,c){return a<b?b:a>c?c:a};pokerpg.Util.or=function(a,b){return a?a:b};pokerpg.Util.reduceTextSize=function(a,b,c){for(var a=a.split(" "),e=[];a.length>0;){var f=pokerpg.Util.findMaximumTextSize(a,b,c,0,a.length);e.push(a.slice(0,f).join(" "));a=a.slice(f)}return e};
pokerpg.Util.findMaximumTextSize=function(a,b,c,e,f){if(f<e)return-1;if(f-e<=1)return e+1;var g=Math.floor((e+f)/2);return c.measureText(a.slice(0,g).join(" ")).width>b?pokerpg.Util.findMaximumTextSize(a,b,c,e,g-1):c.measureText(a.slice(0,g+1).join(" ")).width>b?g:pokerpg.Util.findMaximumTextSize(a,b,c,g+1,f)};pokerpg.Util.getPokemonStatusBarName=function(a){return pokerpg.Util.or(a.nickname,pokerpg.Game.pokemonData[a.id].name).toUpperCase()};
pokerpg.Util.getPokemonDisplayName=function(a){var b=a!=null?pokerpg.Util.or(a.nickname,pokerpg.Game.pokemonData[a.id].name!=null?pokerpg.Game.pokemonData[a.id].name:"Pokemon").toUpperCase():"POKEMON";if(pokerpg.Game.curGame!=null&&pokerpg.Game.curGame.inBattle&&pokerpg.Game.curGame.battle.enemyPokemon==a){pokerpg.Game.curGame.battle.type==0&&(b="Wild "+b);pokerpg.Game.curGame.battle.type==2&&(b="Trainer "+b)}return b};
pokerpg.Util.drawRoundedRect=function(a,b,c,e,f,g,h){h==null&&(h=1);var j=pokerpg.Main.tmpCtx,i=pokerpg.Main.tmpCanvas,l=pokerpg.Main.ctx;j.clearRect(0,0,c,e);j.save();j.lineJoin="round";j.lineWidth=f;j.fillStyle=j.strokeStyle=g;j.strokeRect(f/2,f/2,c-f,e-f);j.fillRect(f/2,f/2,c-f,e-f);j.restore();l.save();l.globalAlpha=h;l.drawImage(i,0,0,c,e,a,b,c,e);l.restore()};pokerpg.Util.prototype.__class__=pokerpg.Util;
pokerpg.transitions.FadeOut=function(a){if(a!==$_){pokerpg.Transition.call(this);this.fadeTime=a}};pokerpg.transitions.FadeOut.__name__=["pokerpg","transitions","FadeOut"];pokerpg.transitions.FadeOut.__super__=pokerpg.Transition;for(k in pokerpg.Transition.prototype)pokerpg.transitions.FadeOut.prototype[k]=pokerpg.Transition.prototype[k];pokerpg.transitions.FadeOut.prototype.fadeTime=null;
pokerpg.transitions.FadeOut.prototype.render=function(a){a.fillStyle="rgba(0,0,0,"+pokerpg.Util.clamp(this.step/this.fadeTime,0,1)+")";a.fillRect(0,0,a.canvas.width,a.canvas.height);++this.step;this.step>=this.fadeTime&&this.complete()};pokerpg.transitions.FadeOut.prototype.__class__=pokerpg.transitions.FadeOut;pokerpg.UI=function(){};pokerpg.UI.__name__=["pokerpg","UI"];pokerpg.UI.AButtonHooks=null;pokerpg.UI.BButtonHooks=null;pokerpg.UI.enterButtonHooks=null;pokerpg.UI.dirButtonHooks=null;
pokerpg.UI.mouseX=null;pokerpg.UI.mouseY=null;pokerpg.UI.inputs=null;pokerpg.UI.selectedInput=null;pokerpg.UI.lastSelectedInput=null;pokerpg.UI.hiddenInput=null;
pokerpg.UI.setup=function(){pokerpg.UI.AButtonHooks=[];pokerpg.UI.BButtonHooks=[];pokerpg.UI.dirButtonHooks=[];pokerpg.UI.enterButtonHooks=[];pokerpg.UI.inputs=[];pokerpg.UI.mouseX=pokerpg.UI.mouseY=0;var a=window;pokerpg.UI.hiddenInput=document.createElement("input");pokerpg.UI.hiddenInput.type="text";pokerpg.UI.hiddenInput.style.opacity="0";pokerpg.UI.hiddenInput.style.position="fixed";document.body.appendChild(pokerpg.UI.hiddenInput);pokerpg.Main.jq(a).keydown(function(a){if(!pokerpg.Chat.inChat&&
a.keyCode==68&&a.shiftKey&&pokerpg.UI.selectedInput==null){pokerpg.Main.printDebug();a.preventDefault()}else{if(a.keyCode==13){if(pokerpg.Game.state==pokerpg.GameState.ST_MAP){if(!pokerpg.Chat.inChat&&!pokerpg.Chat.justSentMessage){pokerpg.Chat.inChat=true;pokerpg.Main.jq(pokerpg.Chat.chatBox).focus()}}else pokerpg.UI.fireEnterHooks=true;a.preventDefault()}else if(a.keyCode==9){pokerpg.UI.selectNextInput();a.preventDefault()}if(!pokerpg.Chat.inChat&&!pokerpg.UI.keysDown[a.keyCode]){pokerpg.UI.keysDown[a.keyCode]=
true;if(a.keyCode==90){pokerpg.UI.uiAButtonDown=true;pokerpg.UI.fireAHooks=true;pokerpg.Main.jq("#controls #z").addClass("active")}else if(a.keyCode==88){pokerpg.UI.uiBButtonDown=true;pokerpg.UI.fireBHooks=true;pokerpg.Main.jq("#controls #x").addClass("active")}else if(a.keyCode!=67)if(a.keyCode==37){pokerpg.UI.arrowKeysPressed.push(1);pokerpg.Main.jq("#controls #left").addClass("active")}else if(a.keyCode==40){pokerpg.UI.arrowKeysPressed.push(0);pokerpg.Main.jq("#controls #down").addClass("active")}else if(a.keyCode==
39){pokerpg.UI.arrowKeysPressed.push(3);pokerpg.Main.jq("#controls #right").addClass("active")}else if(a.keyCode==38){pokerpg.UI.arrowKeysPressed.push(2);pokerpg.Main.jq("#controls #up").addClass("active")}}}});pokerpg.Main.jq(a).keyup(function(a){pokerpg.UI.keysDown[a.keyCode]=false;if(a.keyCode==13)pokerpg.Chat.justSentMessage=false;else if(a.keyCode==90){pokerpg.UI.uiAButtonDown=false;pokerpg.Main.jq("#controls #z").removeClass("active")}else if(a.keyCode==88){pokerpg.UI.uiBButtonDown=false;pokerpg.Main.jq("#controls #x").removeClass("active")}else a.keyCode==
37?pokerpg.Main.jq("#controls #left").removeClass("active"):a.keyCode==40?pokerpg.Main.jq("#controls #down").removeClass("active"):a.keyCode==39?pokerpg.Main.jq("#controls #right").removeClass("active"):a.keyCode==38&&pokerpg.Main.jq("#controls #up").removeClass("active");if((a.keyCode==13||a.keyCode==32)&&pokerpg.UI.selectedInput!=null&&Std.is(pokerpg.UI.selectedInput,pokerpg.ui.UIButton)){a=pokerpg.UI.selectedInput;a.instantSubmit&&a.submit()}});pokerpg.Main.jq(a).blur(function(){for(var a=0,c=
pokerpg.UI.keysDown.length;a<c;){var e=a++;pokerpg.UI.keysDown[e]=false}pokerpg.UI.mouseDown=false});pokerpg.Main.jq(a).mousedown(function(a){pokerpg.UI.mouseDownFuture=true;for(var c=false,e=0,f=pokerpg.UI.inputs.length;e<f;){var g=e++;if(pokerpg.UI.inputs[g].isUnderMouse()){pokerpg.UI.inputs[g].select();c=true}}if(!c&&pokerpg.UI.selectedInput!=null){pokerpg.UI.lastSelectedInput=pokerpg.UI.selectedInput;pokerpg.UI.selectedInput.blur()}a.preventDefault()});pokerpg.Main.jq(a).mouseup(function(){pokerpg.UI.mouseDownFuture=
false;if(pokerpg.UI.selectedInput!=null&&pokerpg.UI.selectedInput.isUnderMouse()&&Std.is(pokerpg.UI.selectedInput,pokerpg.ui.UIButton)){var a=pokerpg.UI.selectedInput;a.instantSubmit&&a.submit()}})};
pokerpg.UI.selectNextInput=function(){if(!(pokerpg.UI.inputs.length<=1)){pokerpg.UI.selectedInput!=null?pokerpg.UI.inputs[(Lambda.indexOf(pokerpg.UI.inputs,pokerpg.UI.selectedInput)+1)%pokerpg.UI.inputs.length].select():pokerpg.UI.lastSelectedInput!=null?pokerpg.UI.inputs[(Lambda.indexOf(pokerpg.UI.inputs,pokerpg.UI.lastSelectedInput)+1)%pokerpg.UI.inputs.length].select():pokerpg.UI.inputs.length>0&&pokerpg.UI.inputs[0].select();if(pokerpg.UI.selectedInput!=null&&pokerpg.UI.selectedInput.disabled){for(var a=
Lambda.indexOf(pokerpg.UI.inputs,pokerpg.UI.selectedInput),b=a,c=pokerpg.UI.inputs.length;b<c;){var e=b++;if(!pokerpg.UI.inputs[e].disabled){pokerpg.UI.inputs[e].select();return}}for(c=0;c<a;){e=c++;if(!pokerpg.UI.inputs[e].disabled){pokerpg.UI.inputs[e].select();break}}}}};
pokerpg.UI.tick=function(){pokerpg.Main.onScreenCanvas.style.cursor="auto";pokerpg.UI.mouseWasDown=pokerpg.UI.mouseDown;pokerpg.UI.mouseDown=pokerpg.UI.mouseDownFuture;if(pokerpg.UI.hiddenInput.selected){pokerpg.UI.hiddenInput.selectionStart=pokerpg.UI.hiddenInput.value.length;pokerpg.UI.hiddenInput.selectionEnd=pokerpg.UI.hiddenInput.value.length}for(var a=0,b=pokerpg.UI.inputs.length;a<b;){var c=a++;pokerpg.UI.inputs[c].tick()}if(pokerpg.UI.fireAHooks){pokerpg.UI.fireAHooks=false;a=pokerpg.UI.AButtonHooks.copy();
pokerpg.UI.AButtonHooks=[];if(pokerpg.Renderer.curTransition==null)for(b=0;b<a.length;){c=a[b];++b;c()}}if(pokerpg.UI.fireBHooks){pokerpg.UI.fireBHooks=false;a=pokerpg.UI.BButtonHooks.copy();pokerpg.UI.BButtonHooks=[];if(pokerpg.Renderer.curTransition==null)for(b=0;b<a.length;){c=a[b];++b;c()}}if(pokerpg.UI.fireEnterHooks){pokerpg.UI.fireEnterHooks=false;a=pokerpg.UI.enterButtonHooks.copy();pokerpg.UI.enterButtonHooks=[];if(pokerpg.Renderer.curTransition==null)for(b=0;b<a.length;){c=a[b];++b;c()}}if(pokerpg.Renderer.curTransition==
null){a=0;for(b=pokerpg.UI.arrowKeysPressed.length;a<b;)for(var c=a++,e=0,f=pokerpg.UI.dirButtonHooks.length;e<f;){var g=e++;pokerpg.UI.dirButtonHooks[g](pokerpg.UI.arrowKeysPressed[c])}}pokerpg.UI.arrowKeysPressed=[]};pokerpg.UI.render=function(a){for(var b=0,c=pokerpg.UI.inputs.length;b<c;){var e=b++;pokerpg.UI.inputs[e].render(a)}};pokerpg.UI.hookAButton=function(a){pokerpg.UI.AButtonHooks.push(a)};pokerpg.UI.hookBButton=function(a){pokerpg.UI.BButtonHooks.push(a)};pokerpg.UI.hookEnterButton=function(a){pokerpg.UI.enterButtonHooks.push(a)};
pokerpg.UI.unHookAButton=function(a){pokerpg.UI.AButtonHooks.remove(a)};pokerpg.UI.unHookBButton=function(a){pokerpg.UI.BButtonHooks.remove(a)};pokerpg.UI.unHookABButtons=function(){pokerpg.UI.AButtonHooks=[];pokerpg.UI.BButtonHooks=[]};pokerpg.UI.unHookAllAButton=function(){pokerpg.UI.BButtonHooks=[]};pokerpg.UI.unHookAllBButton=function(){pokerpg.UI.BButtonHooks=[]};pokerpg.UI.unHookEnterButton=function(a){pokerpg.UI.AButtonHooks.remove(a)};pokerpg.UI.hookDirButtons=function(a){pokerpg.UI.dirButtonHooks.push(a)};
pokerpg.UI.unHookDirButtons=function(a){pokerpg.UI.dirButtonHooks.remove(a)};pokerpg.UI.isKeyDown=function(a){return!!pokerpg.UI.keysDown[a]};pokerpg.UI.isMouseInRect=function(a,b,c,e){return pokerpg.UI.mouseX>=a&&pokerpg.UI.mouseY>=b&&pokerpg.UI.mouseX<c&&pokerpg.UI.mouseY<e};
pokerpg.UI.renderPokemonParty=function(a){if(!pokerpg.Main.isPhone){pokerpg.Main.tmpCtx.clearRect(0,0,pokerpg.Main.tmpCanvas.width,pokerpg.Main.tmpCanvas.height);var b=10,c=pokerpg.Game.pokemonParty,e=pokerpg.Main.tmpCtx,f=pokerpg.Main.tmpCanvas;if(c!=null){for(var g=function(a,c,f){e.fillStyle="rgb(0, 0, 0)";e.fillText(a,10+c+2,b+f+2);e.fillStyle="rgb(255, 255, 255)";e.fillText(a,10+c,b+f)},h=0,j=c.length;h<j;){var i=h++;e.save();e.shadowOffsetX=4;e.shadowOffsetY=4;e.shadowBlur=0;e.shadowColor="rgba(0, 0, 0, 0.5)";
e.fillStyle=e.strokeStyle="#000000";e.fillRect(10,b,296,40);e.restore();c[i].icon.loaded&&e.drawImage(c[i].icon.obj,18,b+6);e.font="12pt Font1";e.fillStyle="rgb(255, 255, 255)";g(pokerpg.Util.getPokemonDisplayName(c[i]),45,21);var l=e.measureText("Lv "+c[i].level).width;g("Lv "+c[i].level,45,35);e.font="12pt Font1";var o=c[i].hp+"/"+c[i].maxHp,p=Math.ceil(e.measureText(o).width);g(o,280-p,35);o=70+l;e.save();e.translate(-0.5,-0.5);e.lineWidth=2;e.save();e.beginPath();e.moveTo(0,b+32);e.lineTo(f.width,
b+32);e.lineTo(f.width,b+45);e.lineTo(0,b+45);e.lineTo(0,b+32);e.clip();e.strokeStyle="rgb(0, 0, 0)";e.fillStyle="rgb(0, 0, 0)";e.fillRect(o+5,b+30,190-p-l,5);e.fillStyle="rgb(64,200,248)";e.fillRect(o+5,b+30,Math.ceil((190-p-l)*(c[i].experience/c[i].experienceNeeded)),5);e.strokeRect(o+5,b+30,190-p-l,5);e.restore();e.fillStyle="rgb(0, 200, 0)";e.strokeStyle="rgb(0, 0, 0)";e.fillRect(o,b+27,Math.ceil((200-p-l)*(c[i].hp/c[i].maxHp)),5);e.strokeRect(o,b+27,200-p-l,5);e.restore();b=b+48}a.globalAlpha=
0.8;a.drawImage(f,480,0);a.globalAlpha=1}}};pokerpg.UI.createTextInput=function(a,b,c){a=new pokerpg.ui.TextInput(a,b,c);pokerpg.UI.inputs.push(a);return a};pokerpg.UI.pushInput=function(a){pokerpg.UI.inputs.push(a)};pokerpg.UI.removeInput=function(a){pokerpg.UI.selectedInput==a&&a.blur();pokerpg.UI.inputs.remove(a)};pokerpg.UI.removeAllInputs=function(){for(;pokerpg.UI.inputs.length>0;)pokerpg.UI.removeInput(pokerpg.UI.inputs[0])};
pokerpg.UI.setCursor=function(a){pokerpg.Main.onScreenCanvas.style.cursor=a};pokerpg.UI.prototype.__class__=pokerpg.UI;Hash=function(a){if(a!==$_){this.h={};if(this.h.__proto__!=null){this.h.__proto__=null;delete this.h.__proto__}}};Hash.__name__=["Hash"];Hash.prototype.h=null;Hash.prototype.set=function(a,b){this.h["$"+a]=b};Hash.prototype.get=function(a){return this.h["$"+a]};
Hash.prototype.exists=function(a){try{a="$"+a;return this.hasOwnProperty.call(this.h,a)}catch(b){for(var c in this.h)if(c==a)return true;return false}};Hash.prototype.remove=function(a){if(!this.exists(a))return false;delete this.h["$"+a];return true};Hash.prototype.keys=function(){var a=[],b;for(b in this.h)a.push(b.substr(1));return a.iterator()};Hash.prototype.iterator=function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref["$"+this.it.next()]}}};
Hash.prototype.toString=function(){var a=new StringBuf;a.b[a.b.length]="{";for(var b=this.keys();b.hasNext();){var c=b.next();a.b[a.b.length]=c==null?"null":c;a.b[a.b.length]=" => ";a.add(Std.string(this.get(c)));b.hasNext()&&(a.b[a.b.length]=", ")}a.b[a.b.length]="}";return a.b.join("")};Hash.prototype.__class__=Hash;pokerpg.transitions.BlackScreen=function(a){if(a!==$_){pokerpg.Transition.call(this);this.duration=a}};pokerpg.transitions.BlackScreen.__name__=["pokerpg","transitions","BlackScreen"];
pokerpg.transitions.BlackScreen.__super__=pokerpg.Transition;for(k in pokerpg.Transition.prototype)pokerpg.transitions.BlackScreen.prototype[k]=pokerpg.Transition.prototype[k];pokerpg.transitions.BlackScreen.prototype.duration=null;pokerpg.transitions.BlackScreen.prototype.render=function(a){a.fillStyle="#000000";a.fillRect(0,0,a.canvas.width,a.canvas.height);this.step>=0&&++this.step;this.step>=this.duration&&this.complete()};pokerpg.transitions.BlackScreen.prototype.__class__=pokerpg.transitions.BlackScreen;
Std=function(){};Std.__name__=["Std"];Std.is=function(a,b){return js.Boot.__instanceof(a,b)};Std.string=function(a){return js.Boot.__string_rec(a,"")};Std["int"]=function(a){return a<0?Math.ceil(a):Math.floor(a)};Std.parseInt=function(a){var b=parseInt(a,10);b==0&&a.charCodeAt(1)==120&&(b=parseInt(a));return isNaN(b)?null:b};Std.parseFloat=function(a){return parseFloat(a)};Std.random=function(a){return Math.floor(Math.random()*a)};Std.prototype.__class__=Std;
pokerpg.particles||(pokerpg.particles={});pokerpg.particles.ShinyOverworld=function(a){if(a!==$_){pokerpg.Particle.call(this);this.obj=a;this.particles=new Float32Array(500)}};pokerpg.particles.ShinyOverworld.__name__=["pokerpg","particles","ShinyOverworld"];pokerpg.particles.ShinyOverworld.__super__=pokerpg.Particle;for(k in pokerpg.Particle.prototype)pokerpg.particles.ShinyOverworld.prototype[k]=pokerpg.Particle.prototype[k];pokerpg.particles.ShinyOverworld.prototype.particles=null;
pokerpg.particles.ShinyOverworld.prototype.obj=null;pokerpg.particles.ShinyOverworld.prototype.destroy=function(){pokerpg.Particle.prototype.destroy.call(this);this.particles=null};
pokerpg.particles.ShinyOverworld.prototype.render=function(a){a.fillStyle="#FFFF00";a.globalCompositeOperation="lighter";for(var b=pokerpg.Map.getCurMap(),c=100;c-- >0;){var e=this.particles[c*5],f=this.particles[c*5+1],g=this.particles[c*5+2];if(g<=0.03){if(!this.started)continue;if(Math.random()<0.05){g=1;e=Math.random()*16-8;f=Math.random()*16-8;this.particles[c*5+3]=e/8*2;this.particles[c*5+4]=f/8*2;e=e+(this.obj.x*b.tilewidth+b.tilewidth/2);f=f+(this.obj.y*b.tileheight+b.tileheight/2)}}else{g=
g*0.9;e=e+(this.particles[c*5+3]=this.particles[c*5+3]*0.9);f=f+(this.particles[c*5+4]=this.particles[c*5+4]*0.9)}a.globalAlpha=g;a.fillRect(Math.round(e),Math.round(f),1,1);this.particles[c*5]=e;this.particles[c*5+1]=f;this.particles[c*5+2]=g}};pokerpg.particles.ShinyOverworld.prototype.__class__=pokerpg.particles.ShinyOverworld;pokerpg.entities.CWildPokemon=function(a,b,c,e,f){if(a!==$_){pokerpg.entities.CPokemon.call(this,a,b,c,0,f);this.chr=e;this.createdTick=pokerpg.Renderer.numRTicks}};
pokerpg.entities.CWildPokemon.__name__=["pokerpg","entities","CWildPokemon"];pokerpg.entities.CWildPokemon.__super__=pokerpg.entities.CPokemon;for(k in pokerpg.entities.CPokemon.prototype)pokerpg.entities.CWildPokemon.prototype[k]=pokerpg.entities.CPokemon.prototype[k];pokerpg.entities.CWildPokemon.prototype.createdTick=null;pokerpg.entities.CWildPokemon.prototype.chr=null;
pokerpg.entities.CWildPokemon.prototype.tick=function(){if(this.chr.inBattle){pokerpg.entities.CPokemon.prototype.tick.call(this);if(!this.walking)this.direction=this.x<this.chr.x?3:this.x>this.chr.x?1:this.y>this.chr.y?2:0}else this.destroy()};
pokerpg.entities.CWildPokemon.prototype.render=function(a){if(this.chr.username!=pokerpg.Game.username||pokerpg.Game.curGame.drawPlayerChar){a.save();this.canDrawGrass=pokerpg.Renderer.numRTicks-this.createdTick<5;pokerpg.Renderer.numRTicks-this.createdTick<10&&a.translate(0,-(Math.floor(-0.14*(pokerpg.Renderer.numRTicks-this.createdTick)*(pokerpg.Renderer.numRTicks-this.createdTick)+1.4*(pokerpg.Renderer.numRTicks-this.createdTick))*8));pokerpg.entities.CPokemon.prototype.render.call(this,a);a.restore()}};
pokerpg.entities.CWildPokemon.prototype.__class__=pokerpg.entities.CWildPokemon;EReg=function(a,b){if(a!==$_){b=b.split("u").join("");this.r=RegExp(a,b)}};EReg.__name__=["EReg"];EReg.prototype.r=null;EReg.prototype.match=function(a){this.r.m=this.r.exec(a);this.r.s=a;this.r.l=RegExp.leftContext;this.r.r=RegExp.rightContext;return this.r.m!=null};EReg.prototype.matched=function(a){if(this.r.m!=null&&a>=0&&a<this.r.m.length)a=this.r.m[a];else throw"EReg::matched";return a};
EReg.prototype.matchedLeft=function(){if(this.r.m==null)throw"No string matched";return this.r.l==null?this.r.s.substr(0,this.r.m.index):this.r.l};EReg.prototype.matchedRight=function(){if(this.r.m==null)throw"No string matched";if(this.r.r==null){var a=this.r.m.index+this.r.m[0].length;return this.r.s.substr(a,this.r.s.length-a)}return this.r.r};EReg.prototype.matchedPos=function(){if(this.r.m==null)throw"No string matched";return{pos:this.r.m.index,len:this.r.m[0].length}};
EReg.prototype.split=function(a){return a.replace(this.r,"#__delim__#").split("#__delim__#")};EReg.prototype.replace=function(a,b){return a.replace(this.r,b)};EReg.prototype.customReplace=function(a,b){for(var c=new StringBuf;;){if(!this.match(a))break;c.add(this.matchedLeft());c.add(b(this));a=this.matchedRight()}c.b[c.b.length]=a==null?"null":a;return c.b.join("")};EReg.prototype.__class__=EReg;pokerpg.Renderer=function(){};pokerpg.Renderer.__name__=["pokerpg","Renderer"];
pokerpg.Renderer.willRender=null;pokerpg.Renderer.cameraX=null;pokerpg.Renderer.cameraY=null;pokerpg.Renderer.renderHooks=null;pokerpg.Renderer.gameRenderHooks=null;pokerpg.Renderer.curTransition=null;pokerpg.Renderer.clouds=null;pokerpg.Renderer.setup=function(){pokerpg.Renderer.resetHooks()};
pokerpg.Renderer.render=function(){if(!pokerpg.Renderer.willRender){pokerpg.Renderer.willRender=true;var a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame;a==null&&(a=function(){setTimeout(pokerpg.Renderer.realRender,1)});a(pokerpg.Renderer.realRender)}};pokerpg.Renderer.getOffsetX=function(){return Math.floor(pokerpg.Game.curGame.map.tilewidth*-pokerpg.Renderer.cameraX)};
pokerpg.Renderer.getOffsetY=function(){return Math.floor(pokerpg.Game.curGame.map.tileheight*-pokerpg.Renderer.cameraY)};pokerpg.Renderer.hookRender=function(a){Lambda.indexOf(pokerpg.Renderer.renderHooks,a)==-1&&pokerpg.Renderer.renderHooks.push(a)};pokerpg.Renderer.unHookRender=function(a){a=Lambda.indexOf(pokerpg.Renderer.renderHooks,a);a!=-1&&pokerpg.Renderer.renderHooks.splice(a,1)};pokerpg.Renderer.resetHooks=function(){pokerpg.Renderer.renderHooks=[];pokerpg.Renderer.gameRenderHooks=[]};
pokerpg.Renderer.realRender=function(){pokerpg.Renderer.willRender=false;var a=pokerpg.Main.ctx,b=pokerpg.Main.canvas,c=pokerpg.Main.onScreenCtx,e=pokerpg.Main.onScreenCanvas;a.clearRect(0,0,b.width,b.height);var f=pokerpg.Game.curGame;switch(pokerpg.Game.state[1]){case 0:a.fillStyle="#000000";a.fillRect(0,0,b.width,b.height);break;case 2:if(f==null)return;var g=f.map;if(g==null)throw"No map in memory";var h=f.getPlayerChar();if(h!=null){pokerpg.Renderer.cameraX=h.getRenderPosX()/g.tilewidth+1-pokerpg.Main.screenWidth/
g.tilewidth/2;pokerpg.Renderer.cameraY=h.getRenderPosY()/g.tileheight-pokerpg.Main.screenHeight/g.tileheight/2}g.render(a);g.renderAnimated(a);pokerpg.Game.curGame.renderObjects(a);g.renderOver(a);for(var g=0,j=pokerpg.Renderer.gameRenderHooks;g<j.length;){var i=j[g];++g;i()}pokerpg.Chat.renderBubbles(a);if(f.inBattle&&f.battle.step!=pokerpg.BATTLE_STEP.BATTLE_STEP_TRANSITION){a.save();a.fillStyle="rgba(0, 0, 0, 0.45)";a.fillRect(0,0,pokerpg.Main.canvas.width,pokerpg.Main.canvas.height);a.restore();
f.battle.render(a)}pokerpg.Chat.render(a);f.inBattle||pokerpg.UI.renderPokemonParty(a);if(h.speechText!=""){a.save();h.drawSpeechMessage(a);a.restore()}if(pokerpg.Renderer.renderHooks.length>0){f=pokerpg.Renderer.renderHooks.copy();j=0;for(g=f.length;j<g;){h=j++;f[h]()}}break;case 1:a.fillStyle="#000000";a.fillRect(0,0,b.width,b.height);a.fillStyle="#FFFFFF";a.font="12pt Dosis";if(pokerpg.Game.loadError)a.fillText("Failed loading files",10,30);else if(pokerpg.Game.pendingLoad==0){pokerpg.Game.state=
pokerpg.GameState.ST_MAP;var l=0,o=null,o=function(){a.fillStyle="#000000";a.globalAlpha=1-l/8;a.fillRect(0,0,b.width,b.height);a.globalAlpha=1;++l;l>=8&&pokerpg.Renderer.unHookRender(o)};pokerpg.Renderer.hookRender(o);pokerpg.Renderer.render()}else a.fillText("Loading... "+pokerpg.Game.pendingLoad,10,30);break;case 3:a.fillStyle="#000000";a.fillRect(0,0,b.width,b.height);a.fillStyle="#FFFFFF";a.font="12pt Dosis";a.fillText("Disconnected from the PokeRPG Server",10,30);break;case 4:pokerpg.TitleScreen.render(a);
break;case 6:pokerpg.RegisterScreen.render(a);break;case 5:pokerpg.NewGameScreen.render(a)}pokerpg.UI.render(a);pokerpg.Renderer.curTransition!=null&&pokerpg.Renderer.curTransition.render(a);c.clearRect(0,0,e.width,e.height);c.drawImage(b,0,0);++pokerpg.Renderer.numRTicks};
pokerpg.Renderer.drawOverlay=function(a,b,c,e,f,g){var h=pokerpg.Main.tmpCtx,j=e+6,i=f+6;h.clearRect(0,0,j,i);h.save();h.fillStyle="#000000";h.fillRect(0,0,j,i);h.globalAlpha=0.25;h.shadowBlur=10;h.globalCompositeOperation="destination-atop";g(h);h.restore();a.drawImage(pokerpg.Main.tmpCanvas,0,0,e,f,b-2,c,e,f);a.drawImage(pokerpg.Main.tmpCanvas,0,0,e,f,b,c-2,e,f);a.drawImage(pokerpg.Main.tmpCanvas,0,0,e,f,b,c+2,e,f);a.drawImage(pokerpg.Main.tmpCanvas,0,0,e,f,b+2,c,e,f)};
pokerpg.Renderer.drawShadowText2=function(a,b,c,e,f,g){a.fillStyle=g;a.fillText(b,c+2,e);a.fillText(b,c,e+2);a.fillText(b,c+2,e+2);a.fillStyle=f;a.fillText(b,c,e)};pokerpg.Renderer.startTransition=function(a){return pokerpg.Renderer.curTransition=a};pokerpg.Renderer.stopTransition=function(){pokerpg.Renderer.curTransition=null};pokerpg.Renderer.isInTransition=function(){return pokerpg.Renderer.curTransition!=null};pokerpg.Renderer.prototype.__class__=pokerpg.Renderer;pokerpg.NewGameScreen=function(){};
pokerpg.NewGameScreen.__name__=["pokerpg","NewGameScreen"];pokerpg.NewGameScreen.starters=null;pokerpg.NewGameScreen.chars=null;pokerpg.NewGameScreen.charsImage=null;pokerpg.NewGameScreen.startersFollowerImage=null;pokerpg.NewGameScreen.startersSpriteImage=null;pokerpg.NewGameScreen.border128=null;pokerpg.NewGameScreen.arrows=null;pokerpg.NewGameScreen.curChar=null;pokerpg.NewGameScreen.curStarter=null;pokerpg.NewGameScreen.confirmBtn=null;pokerpg.NewGameScreen.cancelBtn=null;
pokerpg.NewGameScreen.arrowPokLeft=null;pokerpg.NewGameScreen.arrowPokRight=null;pokerpg.NewGameScreen.arrowCharLeft=null;pokerpg.NewGameScreen.arrowCharRight=null;
pokerpg.NewGameScreen.init=function(a,b){pokerpg.NewGameScreen.starters=a;pokerpg.NewGameScreen.chars=b;pokerpg.NewGameScreen.pendingLoad=a.length*2+b.length;pokerpg.NewGameScreen.startersFollowerImage=[];pokerpg.NewGameScreen.startersSpriteImage=[];pokerpg.NewGameScreen.charsImage=[];pokerpg.NewGameScreen.curChar=Math.floor(Math.random()*b.length);pokerpg.NewGameScreen.curStarter=Math.floor(Math.random()*a.length);++pokerpg.NewGameScreen.pendingLoad;pokerpg.NewGameScreen.border128=new pokerpg.ImageResource("resources/ui/border_128.png",
pokerpg.NewGameScreen.onImageLoad,pokerpg.NewGameScreen.onImageError);++pokerpg.NewGameScreen.pendingLoad;pokerpg.NewGameScreen.arrows=new pokerpg.ImageResource("resources/ui/arrows.png",pokerpg.NewGameScreen.onImageLoad,pokerpg.NewGameScreen.onImageError);for(var c=0;c<a.length;){var e=a[c];++c;var f="";e.length==1?f="00":e.length==2&&(f="0");pokerpg.NewGameScreen.startersFollowerImage.push(new pokerpg.ImageResource("resources/followers/"+f+e+"_0.png",pokerpg.NewGameScreen.onImageLoad,pokerpg.NewGameScreen.onImageError));
pokerpg.NewGameScreen.startersSpriteImage.push(new pokerpg.ImageResource("resources/sprites/"+e+".png",pokerpg.NewGameScreen.onImageLoad,pokerpg.NewGameScreen.onImageError))}for(c=0;c<b.length;){e=b[c];++c;pokerpg.NewGameScreen.charsImage.push(new pokerpg.ImageResource("resources/chars/"+e+".png",pokerpg.NewGameScreen.onImageLoad,pokerpg.NewGameScreen.onImageError))}pokerpg.NewGameScreen.confirmBtn=new pokerpg.ui.UIButton(340,490,130,30);pokerpg.NewGameScreen.confirmBtn.drawIdle=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,
200,0,150,50,pokerpg.NewGameScreen.confirmBtn.x-15,pokerpg.NewGameScreen.confirmBtn.y-15,150,50)};pokerpg.NewGameScreen.confirmBtn.drawHover=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,200,50,150,50,pokerpg.NewGameScreen.confirmBtn.x-15,pokerpg.NewGameScreen.confirmBtn.y-15,150,50)};pokerpg.NewGameScreen.confirmBtn.drawDown=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,200,100,150,50,pokerpg.NewGameScreen.confirmBtn.x-15,pokerpg.NewGameScreen.confirmBtn.y-15,150,50)};
pokerpg.NewGameScreen.confirmBtn.drawDisabled=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,200,150,150,50,pokerpg.NewGameScreen.confirmBtn.x-15,pokerpg.NewGameScreen.confirmBtn.y-15,150,50)};pokerpg.NewGameScreen.confirmBtn.onSubmit=pokerpg.NewGameScreen.onConfirm;pokerpg.UI.inputs.push(pokerpg.NewGameScreen.confirmBtn);c=function(a,b,c,e){var f=new pokerpg.ui.UIButton(a,b,32,32);f.drawIdle=function(a){a.drawImage(pokerpg.NewGameScreen.arrows.obj,c*32,0,32,32,f.x,f.y,32,32)};f.drawHover=
function(a){a.drawImage(pokerpg.NewGameScreen.arrows.obj,c*32,32,32,32,f.x,f.y,32,32)};f.drawDown=function(a){a.drawImage(pokerpg.NewGameScreen.arrows.obj,c*32,64,32,32,f.x,f.y,32,32)};f.onSubmit=e;pokerpg.UI.inputs.push(f);return f};pokerpg.NewGameScreen.arrowPokLeft=c(260,430,1,function(){if(--pokerpg.NewGameScreen.curStarter<0)pokerpg.NewGameScreen.curStarter=pokerpg.NewGameScreen.curStarter+a.length});pokerpg.NewGameScreen.arrowPokRight=c(305,430,3,function(){if(++pokerpg.NewGameScreen.curStarter>=
a.length)pokerpg.NewGameScreen.curStarter=pokerpg.NewGameScreen.curStarter-a.length});pokerpg.NewGameScreen.arrowCharLeft=c(468,430,1,function(){if(--pokerpg.NewGameScreen.curChar<0)pokerpg.NewGameScreen.curChar=pokerpg.NewGameScreen.curChar+b.length});pokerpg.NewGameScreen.arrowCharRight=c(513,430,3,function(){if(++pokerpg.NewGameScreen.curChar>=b.length)pokerpg.NewGameScreen.curChar=pokerpg.NewGameScreen.curChar-b.length})};
pokerpg.NewGameScreen.onImageLoad=function(){--pokerpg.NewGameScreen.pendingLoad;pokerpg.NewGameScreen.pendingLoad==0&&pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeIn(10))};pokerpg.NewGameScreen.onImageError=function(){};
pokerpg.NewGameScreen.onConfirm=function(){pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=function(){pokerpg.NewGameScreen.destroy();pokerpg.Game.state=pokerpg.GameState.ST_LOADING;pokerpg.Connection.socket.emit("newGame",{starter:pokerpg.NewGameScreen.starters[pokerpg.NewGameScreen.curStarter],character:pokerpg.NewGameScreen.chars[pokerpg.NewGameScreen.curChar]})}};
pokerpg.NewGameScreen.destroy=function(){pokerpg.UI.removeInput(pokerpg.NewGameScreen.confirmBtn);pokerpg.UI.removeInput(pokerpg.NewGameScreen.arrowPokLeft);pokerpg.UI.removeInput(pokerpg.NewGameScreen.arrowPokRight);pokerpg.UI.removeInput(pokerpg.NewGameScreen.arrowCharLeft);pokerpg.UI.removeInput(pokerpg.NewGameScreen.arrowCharRight)};
pokerpg.NewGameScreen.render=function(a){if(pokerpg.NewGameScreen.pendingLoad>0){a.fillStyle="#000000";a.fillRect(0,0,a.canvas.width,a.canvas.height);a.fillStyle="#FFFFFF";a.font="12pt Dosis";a.fillText("Loading... "+pokerpg.NewGameScreen.pendingLoad,10,30)}else{a.save();a.drawImage(pokerpg.TitleScreen.titleLogo.obj,117,80);a.fillStyle="#000000";a.font="21px Font3";a.textAlign="center";a.fillText("Choose your character and starter Pok\u00e9mon",400,250);a.drawImage(pokerpg.NewGameScreen.border128.obj,
200,250);a.drawImage(pokerpg.NewGameScreen.border128.obj,408,250);a.drawImage(pokerpg.NewGameScreen.startersSpriteImage[pokerpg.NewGameScreen.curStarter].obj,232,282);a.drawImage(pokerpg.NewGameScreen.startersFollowerImage[pokerpg.NewGameScreen.curStarter].obj,192,Math.floor(pokerpg.Renderer.numRTicks%10/5)*64,64,64,449,302,64,64);a.drawImage(pokerpg.NewGameScreen.charsImage[pokerpg.NewGameScreen.curChar].obj,96,Math.floor((pokerpg.Renderer.numRTicks+3)%20/5)*64,32,64,508,302,32,64);a.restore()}};
pokerpg.NewGameScreen.prototype.__class__=pokerpg.NewGameScreen;Version=function(){};Version.__name__=["Version"];Version.prototype.__class__=Version;pokerpg.RegisterScreen=function(){};pokerpg.RegisterScreen.__name__=["pokerpg","RegisterScreen"];pokerpg.RegisterScreen.regsocket=null;pokerpg.RegisterScreen.confirmBtn=null;pokerpg.RegisterScreen.cancelBtn=null;pokerpg.RegisterScreen.captchaImage=null;pokerpg.RegisterScreen.oldCaptchaImage=null;pokerpg.RegisterScreen.requestInitTime=null;
pokerpg.RegisterScreen.usernameTxt=null;pokerpg.RegisterScreen.passwordTxt=null;pokerpg.RegisterScreen.password2Txt=null;pokerpg.RegisterScreen.emailTxt=null;pokerpg.RegisterScreen.captchaTxt=null;pokerpg.RegisterScreen.sentRequest=null;pokerpg.RegisterScreen.requestError=null;pokerpg.RegisterScreen.captchaChallenge=null;pokerpg.RegisterScreen.ignoreDisconnect=null;
pokerpg.RegisterScreen.init=function(){pokerpg.RegisterScreen.regsocket=io.connect("http://pkpadv.zapto.org:2827");pokerpg.RegisterScreen.ignoreDisconnect=false;pokerpg.RegisterScreen.confirmBtn=new pokerpg.ui.UIButton(410,490,130,30);pokerpg.RegisterScreen.confirmBtn.drawIdle=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,200,0,150,50,pokerpg.RegisterScreen.confirmBtn.x-15,pokerpg.RegisterScreen.confirmBtn.y-15,150,50)};pokerpg.RegisterScreen.confirmBtn.drawHover=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,
200,50,150,50,pokerpg.RegisterScreen.confirmBtn.x-15,pokerpg.RegisterScreen.confirmBtn.y-15,150,50)};pokerpg.RegisterScreen.confirmBtn.drawDown=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,200,100,150,50,pokerpg.RegisterScreen.confirmBtn.x-15,pokerpg.RegisterScreen.confirmBtn.y-15,150,50)};pokerpg.RegisterScreen.confirmBtn.drawDisabled=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,200,150,150,50,pokerpg.RegisterScreen.confirmBtn.x-15,pokerpg.RegisterScreen.confirmBtn.y-
15,150,50)};pokerpg.RegisterScreen.confirmBtn.onSubmit=pokerpg.RegisterScreen.onConfirm;pokerpg.RegisterScreen.cancelBtn=new pokerpg.ui.UIButton(270,490,130,30);pokerpg.RegisterScreen.cancelBtn.drawIdle=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,350,0,150,50,pokerpg.RegisterScreen.cancelBtn.x-15,pokerpg.RegisterScreen.cancelBtn.y-15,150,50)};pokerpg.RegisterScreen.cancelBtn.drawHover=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,350,50,150,50,pokerpg.RegisterScreen.cancelBtn.x-
15,pokerpg.RegisterScreen.cancelBtn.y-15,150,50)};pokerpg.RegisterScreen.cancelBtn.drawDown=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,350,100,150,50,pokerpg.RegisterScreen.cancelBtn.x-15,pokerpg.RegisterScreen.cancelBtn.y-15,150,50)};pokerpg.RegisterScreen.cancelBtn.drawDisabled=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,350,150,150,50,pokerpg.RegisterScreen.cancelBtn.x-15,pokerpg.RegisterScreen.cancelBtn.y-15,150,50)};pokerpg.RegisterScreen.cancelBtn.onSubmit=
pokerpg.RegisterScreen.onCancel;pokerpg.RegisterScreen.usernameTxt=pokerpg.UI.createTextInput(245,321,130);pokerpg.RegisterScreen.usernameTxt.maxLength=10;pokerpg.RegisterScreen.passwordTxt=pokerpg.UI.createTextInput(245,346,130);pokerpg.RegisterScreen.passwordTxt.maxLength=64;pokerpg.RegisterScreen.passwordTxt.isPassword=true;pokerpg.RegisterScreen.password2Txt=pokerpg.UI.createTextInput(245,371,130);pokerpg.RegisterScreen.password2Txt.maxLength=64;pokerpg.RegisterScreen.password2Txt.isPassword=
true;pokerpg.RegisterScreen.emailTxt=pokerpg.UI.createTextInput(245,396,130);pokerpg.RegisterScreen.emailTxt.maxLength=100;pokerpg.RegisterScreen.captchaTxt=pokerpg.UI.createTextInput(423,360,220);pokerpg.RegisterScreen.captchaTxt.maxLength=100;pokerpg.UI.inputs.push(pokerpg.RegisterScreen.confirmBtn);pokerpg.UI.inputs.push(pokerpg.RegisterScreen.cancelBtn);pokerpg.RegisterScreen.regsocket.on("registration",function(a){pokerpg.RegisterScreen.requestError=a.result;if(pokerpg.RegisterScreen.requestError==
"success"){pokerpg.RegisterScreen.ignoreDisconnect=true;pokerpg.RegisterScreen.destroy();pokerpg.Connection.socket.emit("login",{username:pokerpg.RegisterScreen.usernameTxt.value,password:pokerpg.RegisterScreen.passwordTxt.value})}else{pokerpg.RegisterScreen.requestInitTime=Date.now().getTime();pokerpg.RegisterScreen.captchaTxt.value="";pokerpg.RegisterScreen.sentRequest=false;if(pokerpg.RegisterScreen.requestError=="short_password"||pokerpg.RegisterScreen.requestError=="long_password"||pokerpg.RegisterScreen.requestError==
"invalid_password")pokerpg.RegisterScreen.password2Txt.value=""}});pokerpg.RegisterScreen.regsocket.on("disconnect",function(){if(!pokerpg.RegisterScreen.ignoreDisconnect){pokerpg.RegisterScreen.ignoreDisconnect=true;pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=function(){pokerpg.RegisterScreen.destroy();pokerpg.Game.state=pokerpg.GameState.ST_TITLE;pokerpg.TitleScreen.init();pokerpg.Renderer.startTransition(new pokerpg.transitions.BlackScreen(10)).onComplete=function(){pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeIn(10))}}}});
pokerpg.RegisterScreen.sentRequest=false;pokerpg.RegisterScreen.loadCaptcha()};
pokerpg.RegisterScreen.destroy=function(){pokerpg.RegisterScreen.regsocket.disconnect();pokerpg.UI.removeInput(pokerpg.RegisterScreen.confirmBtn);pokerpg.UI.removeInput(pokerpg.RegisterScreen.cancelBtn);pokerpg.UI.removeInput(pokerpg.RegisterScreen.usernameTxt);pokerpg.UI.removeInput(pokerpg.RegisterScreen.passwordTxt);pokerpg.UI.removeInput(pokerpg.RegisterScreen.password2Txt);pokerpg.UI.removeInput(pokerpg.RegisterScreen.emailTxt);pokerpg.UI.removeInput(pokerpg.RegisterScreen.captchaTxt)};
pokerpg.RegisterScreen.onConfirm=function(){if(!pokerpg.RegisterScreen.sentRequest){pokerpg.RegisterScreen.requestError=null;pokerpg.RegisterScreen.requestInitTime=Date.now().getTime();if(pokerpg.RegisterScreen.usernameTxt.value.length<4)pokerpg.RegisterScreen.requestError="short_username";else if(pokerpg.RegisterScreen.usernameTxt.value.length>10)pokerpg.RegisterScreen.requestError="long_username";else if(pokerpg.RegisterScreen.passwordTxt.value.length<8)pokerpg.RegisterScreen.requestError="short_password";
else if(pokerpg.RegisterScreen.passwordTxt.value.length>32)pokerpg.RegisterScreen.requestError="long_password";else if(pokerpg.RegisterScreen.passwordTxt.value!=pokerpg.RegisterScreen.password2Txt.value){pokerpg.RegisterScreen.requestError="mismatch_password";pokerpg.RegisterScreen.passwordTxt.value="";pokerpg.RegisterScreen.password2Txt.value=""}if(pokerpg.RegisterScreen.requestError==null){pokerpg.RegisterScreen.sentRequest=true;pokerpg.RegisterScreen.oldCaptchaImage=pokerpg.RegisterScreen.captchaImage;
pokerpg.RegisterScreen.loadCaptcha();pokerpg.RegisterScreen.regsocket.emit("register",{username:pokerpg.RegisterScreen.usernameTxt.value,password:pokerpg.RegisterScreen.passwordTxt.value,challenge:pokerpg.RegisterScreen.captchaChallenge,response:pokerpg.RegisterScreen.captchaTxt.value,email:pokerpg.RegisterScreen.emailTxt.value})}}};
pokerpg.RegisterScreen.loadCaptcha=function(){var a=document.createElement("script");a.type="text/javascript";a.src="http://www.google.com/recaptcha/api/challenge?k=6LcwzuASAAAAADNthnFxGF00_Q7Z4pFb90fZ0jSo&ajax=1";document.body.appendChild(a);window.Recaptcha={challenge_callback:pokerpg.RegisterScreen.gotChallenge}};
pokerpg.RegisterScreen.gotChallenge=function(){pokerpg.RegisterScreen.captchaChallenge=RecaptchaState.challenge;pokerpg.RegisterScreen.captchaImage=new pokerpg.ImageResource("http://www.google.com/recaptcha/api/image?c="+pokerpg.RegisterScreen.captchaChallenge)};
pokerpg.RegisterScreen.onCancel=function(){pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=function(){pokerpg.RegisterScreen.destroy();pokerpg.Game.state=pokerpg.GameState.ST_TITLE;pokerpg.TitleScreen.init();pokerpg.Renderer.startTransition(new pokerpg.transitions.BlackScreen(5)).onComplete=function(){pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeIn(10))}}};
pokerpg.RegisterScreen.render=function(a){var b=Date.now().getTime(),c=Math.floor(255*((b-pokerpg.RegisterScreen.requestInitTime)/2E3)),c="#"+(16711680|c<<8|c).toString(16);a.drawImage(pokerpg.TitleScreen.titleLogo.obj,117,80);pokerpg.Util.drawRoundedRect(145,275,250,150,15,"#FFFFFF",0.7);(pokerpg.RegisterScreen.requestError=="short_username"||pokerpg.RegisterScreen.requestError=="long_username"||pokerpg.RegisterScreen.requestError=="invalid_username"||pokerpg.RegisterScreen.requestError=="username_already_exists")&&
b-pokerpg.RegisterScreen.requestInitTime<2E3?pokerpg.Util.drawRoundedRect(245,321,135,18,5,c,1):pokerpg.Util.drawRoundedRect(245,321,135,18,5,"#FFFFFF",1);(pokerpg.RegisterScreen.requestError=="short_password"||pokerpg.RegisterScreen.requestError=="long_password"||pokerpg.RegisterScreen.requestError=="invalid_password"||pokerpg.RegisterScreen.requestError=="mismatch_password")&&b-pokerpg.RegisterScreen.requestInitTime<2E3?pokerpg.Util.drawRoundedRect(245,346,135,18,5,c,1):pokerpg.Util.drawRoundedRect(245,
346,135,18,5,"#FFFFFF",1);pokerpg.RegisterScreen.requestError=="mismatch_password"&&b-pokerpg.RegisterScreen.requestInitTime<2E3?pokerpg.Util.drawRoundedRect(245,371,135,18,5,c,1):pokerpg.Util.drawRoundedRect(245,371,135,18,5,"#FFFFFF",1);pokerpg.RegisterScreen.requestError=="invalid_email"&&b-pokerpg.RegisterScreen.requestInitTime<2E3?pokerpg.Util.drawRoundedRect(245,396,135,18,5,c,1):pokerpg.Util.drawRoundedRect(245,396,135,18,5,"#FFFFFF",1);pokerpg.RegisterScreen.confirmBtn.disabled=pokerpg.RegisterScreen.captchaImage==
null||!pokerpg.RegisterScreen.captchaImage.loaded||pokerpg.RegisterScreen.sentRequest;pokerpg.RegisterScreen.usernameTxt.disabled=pokerpg.RegisterScreen.passwordTxt.disabled=pokerpg.RegisterScreen.password2Txt.disabled=pokerpg.RegisterScreen.emailTxt.disabled=pokerpg.RegisterScreen.captchaTxt.disabled=pokerpg.RegisterScreen.sentRequest;a.save();a.fillStyle="#000000";a.font="21px Font3";a.fillText("Register",270-Math.round(a.measureText("Register").width/2),300);a.font="12px Font3";a.fillText("ID:",
155,335);a.fillText("PW:",155,360);a.fillText("PW (Again):",155,385);a.fillText("Email:",155,410);a.restore();pokerpg.RegisterScreen.requestError=="invalid_captcha"&&b-pokerpg.RegisterScreen.requestInitTime<2E3?pokerpg.Util.drawRoundedRect(410,275,250,115,15,c,0.7):pokerpg.Util.drawRoundedRect(410,275,250,115,15,"#FFFFFF",0.7);pokerpg.RegisterScreen.sentRequest?pokerpg.RegisterScreen.oldCaptchaImage!=null&&pokerpg.RegisterScreen.oldCaptchaImage.loaded&&a.drawImage(pokerpg.RegisterScreen.oldCaptchaImage.obj,
423,285,225,42):pokerpg.RegisterScreen.captchaImage!=null&&pokerpg.RegisterScreen.captchaImage.loaded&&a.drawImage(pokerpg.RegisterScreen.captchaImage.obj,423,285,225,42);pokerpg.Util.drawRoundedRect(423,360,225,18,5,"#FFFFFF",1);a.fillStyle="#000000";a.font="12px Font3";a.fillText("Type the words above:",535.5-a.measureText("Type the words above:").width/2,350);pokerpg.RegisterScreen.sentRequest&&a.drawImage(pokerpg.TitleScreen.loadingImg.obj,0,32*(Math.floor((b-pokerpg.RegisterScreen.requestInitTime)/
100)%12),32,32,384,440,32,32);if(b-pokerpg.RegisterScreen.requestInitTime<4E3){c=null;switch(pokerpg.RegisterScreen.requestError){case "short_username":c="Username is too short (min. 4 characters)";break;case "long_username":c="Username is too long (max. 10 characters)";break;case "invalid_username":c="Invalid username (alphanumeric and underscore only)";break;case "username_already_exists":c="Username already exists";break;case "email_already_registered":c="Email is already registered";break;case "short_password":c=
"Password is too short (min. 8 characters)";break;case "long_password":c="Password is too long (max. 32 characters)";break;case "invalid_password":c="Invalid password characters (alphanumeric and _!@#$%&*()[]{}.,:;- only)";break;case "invalid_email":c="Invalid email";break;case "internal_error":c="Internal Server Error";break;case "registration_disabled":c="Registration disabled";break;case "invalid_captcha":c="Invalid captcha";break;case "mismatch_password":c="Passwords mismatch";break;case "registered_recently":c=
"You already registered an account recently"}if(c!=null){a.save();a.fillStyle="rgba(200,0,0,"+pokerpg.Util.clamp(4-(b-pokerpg.RegisterScreen.requestInitTime)/1E3,0,1)+")";a.textAlign="center";a.fillText(c,400,465);a.restore()}}};pokerpg.RegisterScreen.prototype.__class__=pokerpg.RegisterScreen;pokerpg.TitleScreen=function(){};pokerpg.TitleScreen.__name__=["pokerpg","TitleScreen"];pokerpg.TitleScreen.usernameTxt=null;pokerpg.TitleScreen.passwordTxt=null;pokerpg.TitleScreen.loginButton=null;
pokerpg.TitleScreen.registerButton=null;pokerpg.TitleScreen.titleScreen=null;pokerpg.TitleScreen.titleLogo=null;pokerpg.TitleScreen.titleButtons=null;pokerpg.TitleScreen.loadingImg=null;pokerpg.TitleScreen.boyIntroImg=null;pokerpg.TitleScreen.IntroBGImg=null;pokerpg.TitleScreen.IntroBG2Img=null;pokerpg.TitleScreen.IntroBG3Img=null;pokerpg.TitleScreen.sentLogin=null;pokerpg.TitleScreen.loginInitTime=null;pokerpg.TitleScreen.birdImg=null;pokerpg.TitleScreen.birdX=null;pokerpg.TitleScreen.birdY=null;
pokerpg.TitleScreen.setup=function(){pokerpg.TitleScreen.titleScreen=pokerpg.Game.loadImageResource("titleScreen","resources/ui/title.png");pokerpg.TitleScreen.titleLogo=pokerpg.Game.loadImageResource("titleLogo","resources/ui/intro_title.png");pokerpg.TitleScreen.titleButtons=pokerpg.Game.loadImageResource("titleButtons","resources/ui/title_buttons.png");pokerpg.TitleScreen.loadingImg=pokerpg.Game.loadImageResource("loading","resources/ui/loading.png");pokerpg.TitleScreen.boyIntroImg=pokerpg.Game.loadImageResource("boyIntroImg",
"resources/ui/intro_boy.png");pokerpg.TitleScreen.IntroBGImg=pokerpg.Game.loadImageResource("boyIntroImg","resources/ui/intro_bg.png");pokerpg.TitleScreen.IntroBG2Img=pokerpg.Game.loadImageResource("boyIntroImg","resources/ui/intro_bg2.png");pokerpg.TitleScreen.IntroBG3Img=pokerpg.Game.loadImageResource("boyIntroImg","resources/ui/intro_bg3.png");pokerpg.TitleScreen.birdImg=pokerpg.Game.loadImageResource("birdImg","resources/ui/birds.png");pokerpg.TitleScreen.birdX=800;pokerpg.TitleScreen.birdY=450};
pokerpg.TitleScreen.init=function(){pokerpg.TitleScreen.usernameTxt=pokerpg.UI.createTextInput(350,321,130);pokerpg.TitleScreen.usernameTxt.maxLength=10;pokerpg.TitleScreen.passwordTxt=pokerpg.UI.createTextInput(350,346,130);pokerpg.TitleScreen.passwordTxt.maxLength=64;pokerpg.TitleScreen.passwordTxt.isPassword=true;pokerpg.TitleScreen.loginButton=new pokerpg.ui.UIButton(455,375,30,30);pokerpg.TitleScreen.loginButton.drawIdle=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,0,0,50,50,
445,365,50,50)};pokerpg.TitleScreen.loginButton.drawHover=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,0,50,50,50,445,365,50,50)};pokerpg.TitleScreen.loginButton.drawDown=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,0,100,50,50,445,365,50,50)};pokerpg.TitleScreen.loginButton.drawDisabled=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,0,150,50,50,445,365,50,50)};pokerpg.TitleScreen.loginButton.onSubmit=pokerpg.TitleScreen.onLoginSubmit;pokerpg.UI.inputs.push(pokerpg.TitleScreen.loginButton);
pokerpg.TitleScreen.registerButton=new pokerpg.ui.UIButton(310,375,130,30);pokerpg.TitleScreen.registerButton.drawIdle=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,50,0,150,50,300,365,150,50)};pokerpg.TitleScreen.registerButton.drawHover=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,50,50,150,50,300,365,150,50)};pokerpg.TitleScreen.registerButton.drawDown=function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,50,100,150,50,300,365,150,50)};pokerpg.TitleScreen.registerButton.drawDisabled=
function(a){a.drawImage(pokerpg.TitleScreen.titleButtons.obj,50,150,150,50,300,365,150,50)};pokerpg.TitleScreen.registerButton.onSubmit=pokerpg.TitleScreen.onRegisterSubmit;pokerpg.UI.inputs.push(pokerpg.TitleScreen.registerButton);pokerpg.TitleScreen.usernameTxt.select();pokerpg.UI.enterButtonHooks.push(pokerpg.TitleScreen.onEnterButton)};
pokerpg.TitleScreen.destroy=function(){pokerpg.UI.removeInput(pokerpg.TitleScreen.usernameTxt);pokerpg.UI.removeInput(pokerpg.TitleScreen.passwordTxt);pokerpg.UI.removeInput(pokerpg.TitleScreen.loginButton);pokerpg.UI.removeInput(pokerpg.TitleScreen.registerButton)};
pokerpg.TitleScreen.onLoginSubmit=function(){if(!pokerpg.TitleScreen.sentLogin&&!(pokerpg.TitleScreen.usernameTxt.value.length<4||pokerpg.TitleScreen.passwordTxt.value.length<8)){pokerpg.TitleScreen.sentLogin=true;pokerpg.TitleScreen.loginInitTime=Date.now().getTime();pokerpg.Connection.socket.emit("login",{username:pokerpg.TitleScreen.usernameTxt.value,password:pokerpg.TitleScreen.passwordTxt.value})}};
pokerpg.TitleScreen.onRegisterSubmit=function(){if(!pokerpg.TitleScreen.sentLogin)pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeOut(10)).onComplete=function(){pokerpg.TitleScreen.destroy();pokerpg.Game.state=pokerpg.GameState.ST_REGISTER;pokerpg.RegisterScreen.init();pokerpg.RegisterScreen.usernameTxt.value=pokerpg.TitleScreen.usernameTxt.value;pokerpg.RegisterScreen.passwordTxt.value=pokerpg.TitleScreen.passwordTxt.value;pokerpg.Renderer.startTransition(new pokerpg.transitions.BlackScreen(5)).onComplete=
function(){pokerpg.Renderer.startTransition(new pokerpg.transitions.FadeIn(10))}}};pokerpg.TitleScreen.loginFailed=function(){pokerpg.TitleScreen.sentLogin=false;pokerpg.TitleScreen.loginInitTime=Date.now().getTime();pokerpg.TitleScreen.passwordTxt.value=""};pokerpg.TitleScreen.onEnterButton=function(){if(pokerpg.UI.selectedInput==pokerpg.TitleScreen.usernameTxt||pokerpg.UI.selectedInput==pokerpg.TitleScreen.passwordTxt)pokerpg.TitleScreen.onLoginSubmit();pokerpg.UI.enterButtonHooks.push(pokerpg.TitleScreen.onEnterButton)};
pokerpg.TitleScreen.render=function(a){var b=a.canvas;if(!pokerpg.TitleScreen.titleScreen.loaded||!pokerpg.TitleScreen.titleButtons.loaded||!pokerpg.TitleScreen.titleLogo.loaded||!pokerpg.TitleScreen.loadingImg.loaded||!pokerpg.TitleScreen.boyIntroImg.loaded){a.fillStyle="#000000";a.fillRect(0,0,b.width,b.height)}else{var c=Date.now().getTime();a.drawImage(pokerpg.TitleScreen.titleScreen.obj,0,0);a.fillStyle="#319CFF";a.fillRect(0,0,b.width,b.height);a.drawImage(pokerpg.TitleScreen.IntroBGImg.obj,
0,216);pokerpg.Util.drawRoundedRect(0,70,800,150,0,"#FFFFFF",0.35);a.drawImage(pokerpg.TitleScreen.titleLogo.obj,117,80);if(pokerpg.TitleScreen.birdX<-100){pokerpg.TitleScreen.birdX=1E3;pokerpg.TitleScreen.birdY=430+Math.floor(121*Math.random())}a.drawImage(pokerpg.TitleScreen.birdImg.obj,45*(Math.floor((c-pokerpg.TitleScreen.loginInitTime)/700)%2),0,45,46,pokerpg.TitleScreen.birdX,pokerpg.TitleScreen.birdY,45,46);a.drawImage(pokerpg.TitleScreen.birdImg.obj,45*(Math.floor((c-pokerpg.TitleScreen.loginInitTime)/
700)%2),0,45,46,pokerpg.TitleScreen.birdX+50,pokerpg.TitleScreen.birdY+40,45,46);pokerpg.TitleScreen.birdX--;pokerpg.TitleScreen.birdX--;a.save();a.shadowOffsetX=4;a.shadowOffsetY=4;a.shadowBlur=0;a.shadowColor="#63b5ff";pokerpg.Util.drawRoundedRect(300,275,200,140,5,"#FFFFFF",0.35);if(pokerpg.TitleScreen.sentLogin){pokerpg.TitleScreen.usernameTxt.disabled=true;pokerpg.TitleScreen.passwordTxt.disabled=true;pokerpg.TitleScreen.loginButton.disabled=true;pokerpg.TitleScreen.registerButton.disabled=true;
pokerpg.Util.drawRoundedRect(350,321,135,18,5,"#FFFFFF",0.5);pokerpg.Util.drawRoundedRect(350,346,135,18,5,"#FFFFFF",0.5);a.drawImage(pokerpg.TitleScreen.loadingImg.obj,0,32*(Math.floor((c-pokerpg.TitleScreen.loginInitTime)/100)%12),32,32,384,425,32,32)}else{pokerpg.TitleScreen.usernameTxt.disabled=false;pokerpg.TitleScreen.passwordTxt.disabled=false;pokerpg.TitleScreen.loginButton.disabled=pokerpg.TitleScreen.usernameTxt.value.length<4||pokerpg.TitleScreen.passwordTxt.value.length<8;pokerpg.TitleScreen.registerButton.disabled=
false;pokerpg.Util.drawRoundedRect(350,321,135,18,5,"#FFFFFF",1);pokerpg.Util.drawRoundedRect(350,346,135,18,5,"#FFFFFF",1)}a.restore();a.save();a.fillStyle="#000000";a.font="21px Dosis";a.fillText("Login",400-Math.round(a.measureText("Login").width/2),300);a.font="12px Dosis";a.fillText("ID:",310,335);a.fillText("PW:",310,360);if(!pokerpg.TitleScreen.sentLogin&&c-pokerpg.TitleScreen.loginInitTime<4E3){a.fillStyle="rgba(200,0,0,"+pokerpg.Util.clamp(4-(c-pokerpg.TitleScreen.loginInitTime)/1E3,0,1)+
")";a.textAlign="center";a.fillText("Invalid username or password",400,430)}a.textAlign="center";a.font="12px Font2";a.fillStyle="#FFFFFF";a.fillText("\u00a9 PokeRPG 2013 - All Rights Reserved",400,580);a.fillStyle="#000000";a.globalAlpha=0.5;a.fillText("\u00a9 PokeRPG 2013 - All Rights Reserved",401,581);a.globalAlpha=1;a.restore()}};pokerpg.TitleScreen.prototype.__class__=pokerpg.TitleScreen;js.Lib=function(){};js.Lib.__name__=["js","Lib"];js.Lib.isIE=null;js.Lib.isOpera=null;js.Lib.document=null;
js.Lib.window=null;js.Lib.alert=function(a){alert(js.Boot.__string_rec(a,""))};js.Lib.eval=function(a){return eval(a)};js.Lib.setErrorHandler=function(a){js.Lib.onerror=a};js.Lib.prototype.__class__=js.Lib;pokerpg.PokemonConst=function(){};pokerpg.PokemonConst.__name__=["pokerpg","PokemonConst"];
pokerpg.PokemonConst.typeNameToInt=function(a){switch(a.toLowerCase()){case "normal":return 0;case "fire":return 1;case "water":return 2;case "ice":return 3;case "electric":return 4;case "grass":return 5;case "ground":return 6;case "rock":return 7;case "fight":return 8;case "fighting":return 8;case "steel":return 9;case "dark":return 10;case "psychic":return 11;case "flying":return 12;case "bug":return 13;case "poison":return 14;case "ghost":return 15;case "dragon":return 16;case "unknown":return 17}throw"Unknown move type: "+
a;};pokerpg.PokemonConst.getStatusName=function(a){switch(a){case 0:return"None";case 1:return"Sleep";case 2:return"Freeze";case 3:return"Paralyze";case 4:return"Poison";case 5:return"Burn"}throw"Unknown status type: "+a;};pokerpg.PokemonConst.getStatusApplyPhrase=function(a,b){switch(a){case 1:return b+" fell asleep!";case 2:return b+" is frozen solid!";case 3:return b+" is paralyzed";case 4:return b+" is poisoned!";case 5:return b+" is burned!"}throw"Unknown status type: "+a;};
pokerpg.PokemonConst.getNatureName=function(a){switch(a){case 1:return"Lonely";case 2:return"Adamant";case 3:return"Naughty";case 4:return"Brave";case 5:return"Bold";case 6:return"Impish";case 7:return"Lax";case 8:return"Relaxed";case 9:return"Modest";case 10:return"Mild";case 11:return"Rash";case 12:return"Quiet";case 13:return"Calm";case 14:return"Gentle";case 15:return"Careful";case 16:return"Sassy";case 17:return"Timid";case 18:return"Haste";case 19:return"Jolly";case 20:return"Naive";case 21:return"Hardy";
case 22:return"Docile";case 23:return"Serious";case 24:return"Bashful";case 25:return"Quirky"}throw"Unknown nature id: "+a;};
pokerpg.PokemonConst.getNatureDescription=function(a){switch(a){case 1:return"Lonely";case 2:return"Adamant";case 3:return"Naughty";case 4:return"Brave";case 5:return"Bold";case 6:return"Impish";case 7:return"Lax";case 8:return"Relaxed";case 9:return"Modest";case 10:return"Mild";case 11:return"Rash";case 12:return"Quiet";case 13:return"Calm";case 14:return"Gentle";case 15:return"Careful";case 16:return"Sassy";case 17:return"Timid";case 18:return"Haste";case 19:return"Jolly";case 20:return"Naive";
case 21:return"Hardy";case 22:return"Docile";case 23:return"Serious";case 24:return"Bashful";case 25:return"Quirky"}throw"Unknown nature id: "+a;};pokerpg.PokemonConst.prototype.__class__=pokerpg.PokemonConst;$_={};js.Boot.__res={};js.Boot.__init();Object.prototype.iterator=function(){var a=this;return{cur:0,arr:this.instanceKeys(),hasNext:function(){return this.cur<this.arr.length},next:function(){return a[this.arr[this.cur++]]}}};
Object.prototype.instanceKeys=function(a){var b=[],a=!a,c;for(c in this)(!a||!Object.prototype[c])&&b.push(c);return b};Math.__name__=["Math"];Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;Math.isFinite=function(a){return isFinite(a)};Math.isNaN=function(a){return isNaN(a)};String.prototype.__class__=String;String.__name__=["String"];Array.prototype.__class__=Array;Array.__name__=["Array"];Int={__name__:["Int"]};Dynamic={__name__:["Dynamic"]};
Float=Number;Float.__name__=["Float"];Bool={__ename__:["Bool"]};Class={__name__:["Class"]};Enum={};Void={__ename__:["Void"]};js.Lib.document=document;js.Lib.window=window;onerror=function(a,b,c){var e=js.Lib.onerror;return e==null?false:e(a,[b+":"+c])};var d=Date;d.now=function(){return new Date};d.fromTime=function(a){var b=new Date;b.setTime(a);return b};
d.fromString=function(a){switch(a.length){case 8:var a=a.split(":"),b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:a=a.split("-");return new Date(a[0],a[1]-1,a[2],0,0,0);case 19:a=a.split(" ");b=a[0].split("-");a=a[1].split(":");return new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw"Invalid date format : "+a;}};
d.prototype.toString=function(){var a=this.getMonth()+1,b=this.getDate(),c=this.getHours(),e=this.getMinutes(),f=this.getSeconds();return this.getFullYear()+"-"+(a<10?"0"+a:""+a)+"-"+(b<10?"0"+b:""+b)+" "+(c<10?"0"+c:""+c)+":"+(e<10?"0"+e:""+e)+":"+(f<10?"0"+f:""+f)};d.prototype.__class__=d;d.__name__=["Date"];pokerpg.transitions.BattleTransition001.BAR_HEIGHT=80;pokerpg.Battle.BATTLE_WILD=0;pokerpg.Battle.BATTLE_TRAINER=1;pokerpg.Battle.BATTLE_VERSUS=2;pokerpg.CCharacter.CHAR_WIDTH=32;
pokerpg.CCharacter.CHAR_HEIGHT=64;pokerpg.CCharacter.CHAR_MOVE_WAIT=0.3;pokerpg.Game.DIR_DOWN=0;pokerpg.Game.DIR_LEFT=1;pokerpg.Game.DIR_UP=2;pokerpg.Game.DIR_RIGHT=3;pokerpg.Game.pendingLoad=0;pokerpg.Connection.SERVER_HOST="http://pkpadv.zapto.org:2828";pokerpg.Connection.REGSERVER_HOST="http://pkpadv.zapto.org:2827";pokerpg.Connection.lastAckMove=0;pokerpg.Main.window=window;pokerpg.Main.document=document;pokerpg.Main.jq=jQuery;pokerpg.entities.CPokemon.POKEMON_WIDTH=64;
pokerpg.entities.CPokemon.POKEMON_HEIGHT=64;pokerpg.entities.CPokemon.POKEMON_WIDTH_BIG=128;pokerpg.entities.CPokemon.POKEMON_HEIGHT_BIG=128;pokerpg.Chat.BUBBLE_BORDER_SIZE=5;pokerpg.Chat.BUBBLE_MAX_WIDTH=150;pokerpg.Chat.inChat=!1;pokerpg.Chat.chatLog=[];pokerpg.Chat.justSentMessage=!1;pokerpg.UI.keysDown=[];pokerpg.UI.uiAButtonDown=!1;pokerpg.UI.uiBButtonDown=!1;pokerpg.UI.mouseDown=!1;pokerpg.UI.mouseWasDown=!1;pokerpg.UI.mouseDownFuture=!1;pokerpg.UI.fireAHooks=!1;pokerpg.UI.fireBHooks=!1;
pokerpg.UI.fireEnterHooks=!1;pokerpg.UI.arrowKeysPressed=[];pokerpg.particles.ShinyOverworld.PARTICLE_STRUCT_SIZE=5;pokerpg.particles.ShinyOverworld.NUM_PARTICLES=100;pokerpg.Renderer.numRTicks=0;pokerpg.NewGameScreen.pendingLoad=0;Version.Major=0;Version.Minor=1;Version.Build=1;Version.Revision=0;js.Lib.onerror=null;pokerpg.PokemonConst.GENDER_UNKNOWN=0;pokerpg.PokemonConst.GENDER_MALE=1;pokerpg.PokemonConst.GENDER_FEMALE=2;pokerpg.PokemonConst.STATUS_NONE=0;pokerpg.PokemonConst.STATUS_SLEEP=1;
pokerpg.PokemonConst.STATUS_FREEZE=2;pokerpg.PokemonConst.STATUS_PARALYZE=3;pokerpg.PokemonConst.STATUS_POISON=4;pokerpg.PokemonConst.STATUS_BURN=5;pokerpg.PokemonConst.TYPE_NORMAL=0;pokerpg.PokemonConst.TYPE_FIRE=1;pokerpg.PokemonConst.TYPE_WATER=2;pokerpg.PokemonConst.TYPE_ICE=3;pokerpg.PokemonConst.TYPE_ELECTRIC=4;pokerpg.PokemonConst.TYPE_GRASS=5;pokerpg.PokemonConst.TYPE_GROUND=6;pokerpg.PokemonConst.TYPE_ROCK=7;pokerpg.PokemonConst.TYPE_FIGHT=8;pokerpg.PokemonConst.TYPE_STEEL=9;
pokerpg.PokemonConst.TYPE_DARK=10;pokerpg.PokemonConst.TYPE_PSYCHIC=11;pokerpg.PokemonConst.TYPE_FLYING=12;pokerpg.PokemonConst.TYPE_BUG=13;pokerpg.PokemonConst.TYPE_POISON=14;pokerpg.PokemonConst.TYPE_GHOST=15;pokerpg.PokemonConst.TYPE_DRAGON=16;pokerpg.PokemonConst.TYPE_UNKNOWN=17;pokerpg.Main.main();
